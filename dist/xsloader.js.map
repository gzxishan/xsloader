{"version":3,"file":"xsloader.js","sources":["../src/util/global.js","../src/core/loader.js","../src/util/urls.js","../src/util/base.js","../src/util/index.js","../src/public/global-deprecated.js","../src/polyfill/json.js","../src/public/global-base.js","../src/public/is.js","../src/public/funs.js","../src/public/browser.js","../src/public/index.js","../src/core/module.js","../src/core/script.js","../src/core/index.js","../src/define.js","../src/core/plugins/inner-dep.js","../src/core/plugins/ready.js","../src/core/plugins/nodeps.js","../src/core/plugins/exists.js","../src/core/plugins/name.js","../src/core/plugins/css.js","../src/core/plugins/text.js","../src/core/plugins/window.js","../src/core/plugins/withdeps.js","../src/core/plugins/json.js","../src/core/plugins/xshttp.js","../src/core/plugins/xsrequest.js","../src/core/plugins/xsmsg.js","../src/service.js"],"sourcesContent":["let g;\nif(typeof window !== undefined) {\n\tg = window;\n} else if(typeof self !== undefined) {\n\tg = self;\n} else if(typeof global !== undefined) {\n\tg = global;\n} else {\n\tthrow new Error(\"not found global var!\");\n}\n\nexport default g;","import global from '../util/global.js';\nlet loaderFun;\nlet xsloader = global.xsloader = function() {\n\treturn loaderFun.apply(this, arguments);\n};\n\nexport default {\n\tloaderFun: (fun) => {\n\t\tloaderFun = fun;\n\t}\n};","const ABSOLUTE_PROTOCOL_REG = /^(([a-zA-Z0-9_]*:\\/\\/)|(\\/)|(\\/\\/))/;\nconst ABSOLUTE_PROTOCOL_REG2 = /^([a-zA-Z0-9_]+:)\\/\\/([^/\\s]+)/;\nconst defaultJsExts = [\".js\", \".js+\", \".js++\", \".es\", \"es6\", \".jsx\", \".vue\"];\n\nimport global from './global.js';\nconst xsloader = global.xsloader;\n\nfunction isJsFile(path) {\n\tif(!xsloader.isString(path)) {\n\t\treturn false;\n\t}\n\tvar pluginIndex = path.indexOf(\"!\");\n\tif(pluginIndex > 0) {\n\t\tpath = path.substring(0, pluginIndex);\n\t}\n\tvar index = path.indexOf(\"?\");\n\tif(index > 0) {\n\t\tpath = path.substring(0, index);\n\t}\n\tindex = path.indexOf(\"#\");\n\tif(index > 0) {\n\t\tpath = path.substring(0, index);\n\t}\n\tlet theConfig = xsloader.config();\n\n\tvar jsExts = theConfig && theConfig.jsExts || defaultJsExts;\n\tfor(var i = 0; i < jsExts.length; i++) {\n\t\tif(xsloader.endsWith(path, jsExts[i])) {\n\t\t\treturn {\n\t\t\t\text: jsExts[i],\n\t\t\t\tpath: path\n\t\t\t};\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction dealPathMayAbsolute(path, currentUrl) {\n\tcurrentUrl = currentUrl || location.href;\n\tlet rs = ABSOLUTE_PROTOCOL_REG.exec(path);\n\n\tlet finalPath;\n\tlet absolute;\n\tif(rs) {\n\t\tlet protocol = rs[1];\n\t\tabsolute = true;\n\n\t\trs = ABSOLUTE_PROTOCOL_REG2.exec(currentUrl);\n\t\tlet _protocol = rs && rs[1] || location.protocol;\n\t\tlet _host = rs && rs[2] || location.host;\n\n\t\tif(protocol == \"//\") {\n\t\t\tfinalPath = _protocol + \"//\" + path;\n\t\t} else if(protocol == \"/\") {\n\t\t\tfinalPath = _protocol + \"//\" + _host + path;\n\t\t} else {\n\t\t\tfinalPath = path;\n\t\t}\n\n\t} else {\n\t\tabsolute = false;\n\t\tfinalPath = path;\n\t}\n\treturn {\n\t\tabsolute: absolute,\n\t\tpath: finalPath\n\t};\n}\n\nfunction getPathWithRelative(path, relative, isPathDir) {\n\n\tlet relativeQuery = \"\";\n\tlet qIndex = path.lastIndexOf(\"?\");\n\tif(qIndex >= 0) {\n\t\tpath = path.substring(0, qIndex);\n\t} else {\n\t\tqIndex = path.lastIndexOf(\"#\");\n\t\tif(qIndex >= 0) {\n\t\t\tpath = path.substring(0, qIndex);\n\t\t}\n\t}\n\n\tqIndex = relative.lastIndexOf(\"?\");\n\tif(qIndex >= 0) {\n\t\trelativeQuery = relative.substring(qIndex);\n\t\trelative = relative.substring(0, qIndex);\n\t} else {\n\t\tqIndex = relative.lastIndexOf(\"#\");\n\t\tif(qIndex >= 0) {\n\t\t\trelativeQuery = relative.substring(qIndex);\n\t\t\trelative = relative.substring(0, qIndex);\n\t\t}\n\t}\n\n\tlet absolute = dealPathMayAbsolute(relative);\n\tif(absolute.absolute) {\n\t\treturn absolute.path + relativeQuery;\n\t}\n\n\tif(isPathDir === undefined) {\n\t\tlet index = path.lastIndexOf(\"/\");\n\t\tif(index == path.length - 1) {\n\t\t\tisPathDir = true;\n\t\t} else {\n\t\t\tif(index == -1) {\n\t\t\t\tindex = 0;\n\t\t\t} else {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tisPathDir = path.indexOf(\".\", index) == -1;\n\t\t}\n\t}\n\n\tif(xsloader.endsWith(path, \"/\")) {\n\t\tpath = path.substring(0, path.length - 1);\n\t}\n\n\tlet isRelativeDir = false;\n\tif(relative == \".\" || xsloader.endsWith(relative, \"/\")) {\n\t\trelative = relative.substring(0, relative.length - 1);\n\t\tisRelativeDir = true;\n\t} else if(relative == \".\" || relative == \"..\" || xsloader.endsWith(\"/.\") || xsloader.endsWith(\"/..\")) {\n\t\tisRelativeDir = true;\n\t}\n\n\tlet prefix = \"\";\n\tlet index = -1;\n\tlet absolute2 = dealPathMayAbsolute(path);\n\tif(absolute2.absolute) {\n\t\tpath = absolute2.path;\n\t\tlet index2 = path.indexOf(\"//\");\n\t\tindex = path.indexOf(\"/\", index2 + 2);\n\t\tif(index == -1) {\n\t\t\tindex = path.length;\n\t\t}\n\t}\n\n\tprefix = path.substring(0, index + 1);\n\tpath = path.substring(index + 1);\n\n\tlet stack = path.split(\"/\");\n\tif(!isPathDir && stack.length > 0) {\n\t\tstack.pop();\n\t}\n\tlet relatives = relative.split(\"/\");\n\tfor(let i = 0; i < relatives.length; i++) {\n\t\tlet str = relatives[i];\n\t\tif(\"..\" == str) {\n\t\t\tif(stack.length == 0) {\n\t\t\t\tthrow new Error(\"no more upper path!\");\n\t\t\t}\n\t\t\tstack.pop();\n\t\t} else if(\".\" != str) {\n\t\t\tstack.push(str);\n\t\t}\n\t}\n\tif(stack.length == 0) {\n\t\treturn \"\";\n\t}\n\tlet result = prefix + stack.join(\"/\");\n\tif(isRelativeDir && !xsloader.endsWith(result, \"/\")) {\n\t\tresult += \"/\";\n\t}\n\tresult = xsloader.appendArgs2Url(result, relativeQuery);\n\treturn result;\n}\n\nfunction getNodeAbsolutePath(node) {\n\tlet src = node.src || node.getAttribute(\"src\");\n\treturn getPathWithRelative(location.href, src);\n}\n\n//去掉url的query参数和#参数\nfunction removeQueryHash(url) {\n\tif(url) {\n\t\tlet index = url.indexOf(\"?\");\n\t\tif(index >= 0) {\n\t\t\turl = url.substring(0, index);\n\t\t}\n\n\t\tindex = url.indexOf(\"#\");\n\t\tif(index >= 0) {\n\t\t\turl = url.substring(0, index);\n\t\t}\n\t}\n\treturn url;\n}\n\nconst REPLACE_STRING_PROPERTIES_EXP = new RegExp(\"\\\\$\\\\{([^\\\\{]+)\\\\}\");\nconst ALL_TYPE_PROPERTIES_EXP = new RegExp(\"^\\\\$\\\\[([^\\\\[\\\\]]+)\\\\]$\");\n\nfunction propertiesDeal(configObject, properties) {\n\tif(!properties) {\n\t\treturn configObject;\n\t}\n\n\tfunction replaceStringProperties(string, properties, property) {\n\t\tlet rs;\n\t\tlet str = string;\n\t\trs = ALL_TYPE_PROPERTIES_EXP.exec(str);\n\t\tif(rs) {\n\t\t\tlet propKey = rs[1];\n\t\t\tlet propValue = xsloader.getObjectAttr(properties, propKey);\n\t\t\tif(propValue === undefined) {\n\t\t\t\treturn str;\n\t\t\t} else {\n\t\t\t\treturn propValue;\n\t\t\t}\n\t\t}\n\n\t\tlet result = \"\";\n\t\twhile(true) {\n\t\t\trs = REPLACE_STRING_PROPERTIES_EXP.exec(str);\n\t\t\tif(!rs) {\n\t\t\t\tresult += str;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlet propKey = rs[1];\n\t\t\t\tif(property !== undefined && property.propertyKey == propKey) {\n\t\t\t\t\tthrow new Error(\"replace property error:propertyKey=\" + propKey);\n\t\t\t\t} else if(property) {\n\t\t\t\t\tproperty.has = true;\n\t\t\t\t}\n\t\t\t\tresult += str.substring(0, rs.index);\n\t\t\t\tresult += xsloader.getObjectAttr(properties, propKey);\n\t\t\t\tstr = str.substring(rs.index + rs[0].length);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\t//处理属性引用\n\tfunction replaceProperties(obj, property, enableKeyAttr) {\n\t\tif(!obj) {\n\t\t\treturn obj;\n\t\t}\n\t\tif(xsloader.isFunction(obj)) {\n\t\t\treturn obj;\n\t\t} else if(xsloader.isArray(obj)) {\n\t\t\tfor(let i = 0; i < obj.length; i++) {\n\t\t\t\tobj[i] = replaceProperties(obj[i], property, enableKeyAttr);\n\t\t\t}\n\t\t} else if(xsloader.isString(obj)) {\n\t\t\tobj = replaceStringProperties(obj, properties, property);\n\t\t} else if(xsloader.isObject(obj)) {\n\t\t\tif(property) {\n\t\t\t\tproperty.has = false;\n\t\t\t}\n\t\t\tlet replaceKeyMap = {};\n\t\t\tfor(let x in obj) {\n\t\t\t\tif(property) {\n\t\t\t\t\tproperty.propertyKey = x;\n\t\t\t\t}\n\t\t\t\tobj[x] = replaceProperties(obj[x], property, enableKeyAttr);\n\t\t\t\tif(enableKeyAttr) {\n\t\t\t\t\tlet _x = replaceStringProperties(x, properties, property);\n\t\t\t\t\tif(_x !== x) {\n\t\t\t\t\t\treplaceKeyMap[x] = _x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(let x in replaceKeyMap) {\n\t\t\t\tlet objx = obj[x];\n\t\t\t\tdelete obj[x];\n\t\t\t\tobj[replaceKeyMap[x]] = objx;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\n\t}\n\n\tif(!properties.__dealt__) {\n\t\tlet property = {\n\t\t\thas: false\n\t\t};\n\n\t\tfor(let x in properties) {\n\t\t\tlet fun = properties[x];\n\t\t\tif(xsloader.isFunction(fun)) {\n\t\t\t\tproperties[x] = fun.call(properties);\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\treplaceProperties(properties, property);\n\t\t} while (property.has);\n\t\tproperties.__dealt__ = true;\n\t}\n\n\treturn replaceProperties(configObject, undefined, true);\n}\n\nfunction replaceModulePrefix(config, deps) {\n\n\tif(!deps) {\n\t\treturn;\n\t}\n\n\tfor(let i = 0; i < deps.length; i++) {\n\t\tlet m = deps[i];\n\t\tlet index = m.indexOf(\"!\");\n\t\tlet pluginParam = index > 0 ? m.substring(index) : \"\";\n\t\tm = index > 0 ? m.substring(0, index) : m;\n\n\t\tindex = m.indexOf(\"?\");\n\t\tlet query = index > 0 ? m.substring(index) : \"\";\n\t\tm = index > 0 ? m.substring(0, index) : m;\n\n\t\tlet is = isJsFile(m);\n\t\tif(!is && (xsloader.startsWith(m, \".\") || dealPathMayAbsolute(m).absolute)) {\n\t\t\tdeps[i] = m + \".js\" + query + pluginParam;\n\t\t}\n\t}\n\n\tif(config.modulePrefixCount) {\n\t\t//模块地址的前缀替换\n\t\tfor(let prefix in config.modulePrefix) {\n\t\t\tlet replaceStr = config.modulePrefix[prefix].replace;\n\t\t\tlet len = prefix.length;\n\t\t\tfor(let i = 0; i < deps.length; i++) {\n\t\t\t\tlet m = deps[i];\n\t\t\t\tlet pluginIndex = m.indexOf(\"!\");\n\t\t\t\tlet pluginName = null;\n\t\t\t\tif(pluginIndex >= 0) {\n\t\t\t\t\tpluginName = m.substring(0, pluginIndex + 1);\n\t\t\t\t\tm = m.substring(pluginIndex + 1);\n\t\t\t\t}\n\t\t\t\tif(xsloader.startsWith(m, prefix)) {\n\t\t\t\t\tlet dep = replaceStr + m.substring(len);\n\t\t\t\t\tdeps[i] = pluginName ? pluginName + dep : dep;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getScriptBySubname(subname) {\n\tlet ss = document.getElementsByTagName('script');\n\tif(subname) {\n\t\tfor(let i = 0; i < ss.length; i++) {\n\t\t\tlet script = ss[i];\n\t\t\tlet src = script.src;\n\t\t\tsrc = src.substring(src.lastIndexOf(\"/\"));\n\t\t\tif(src.indexOf(subname) >= 0) {\n\t\t\t\treturn script;\n\t\t\t}\n\t\t}\n\t} else {\n\t\treturn ss;\n\t}\n}\n\nexport default {\n\tgetPathWithRelative,\n\tgetNodeAbsolutePath,\n\tdealPathMayAbsolute,\n\tremoveQueryHash,\n\tpropertiesDeal,\n\treplaceModulePrefix,\n\tisJsFile,\n\tgetScriptBySubname,\n};","import global from './global.js';\nconst xsloader = global.xsloader;\nconst commentRegExp = /\\/\\*[\\s\\S]*?\\*\\/|([^:\"'=]|^)\\/\\/.*$/mg;\nconst cjsRequireRegExp = /[^.]require\\s*\\(\\s*[\"']([^'\"\\r\\n]+)[\"']\\s*\\)/g;\n\n//基于有向图进行循环依赖检测\nfunction GraphPath() {\n\tlet pathEdges = {};\n\tlet vertexMap = {};\n\tlet depMap = {};\n\tthis.addEdge = function(begin, end) {\n\t\tdepMap[begin + \"|\" + end] = true;\n\t\tif(!pathEdges[begin]) {\n\t\t\tpathEdges[begin] = [];\n\t\t}\n\t\tif(!vertexMap[begin]) {\n\t\t\tvertexMap[begin] = true;\n\t\t}\n\t\tif(!vertexMap[end]) {\n\t\t\tvertexMap[end] = true;\n\t\t}\n\t\tpathEdges[begin].push({\n\t\t\tbegin: begin,\n\t\t\tend: end\n\t\t});\n\t};\n\n\tthis.hasDep = function(name, dep) {\n\t\treturn depMap[name + \"|\" + dep];\n\t};\n\n\tthis.tryAddEdge = function(begin, end) {\n\t\tthis.addEdge(begin, end);\n\t\tlet paths = this.hasLoop();\n\t\tif(paths.length > 0) {\n\t\t\tpathEdges[begin].pop();\n\t\t}\n\t\treturn paths;\n\t};\n\n\tthis.hasLoop = function() {\n\t\tlet visited = {};\n\t\tlet recursionStack = {};\n\n\t\tfor(let x in vertexMap) {\n\t\t\tvisited[x] = false;\n\t\t\trecursionStack[x] = false;\n\t\t}\n\n\t\tlet has = false;\n\t\tlet paths = [];\n\t\tfor(let name in vertexMap) {\n\t\t\tpaths = [];\n\t\t\tif(checkLoop(name, visited, recursionStack, paths)) {\n\t\t\t\thas = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn has ? paths : [];\n\t};\n\n\tfunction checkLoop(v, visited, recursionStack, paths) {\n\t\tif(!visited[v]) {\n\t\t\tvisited[v] = true;\n\t\t\trecursionStack[v] = true;\n\t\t\tpaths.push(v);\n\n\t\t\tif(pathEdges[v]) {\n\t\t\t\tlet edges = pathEdges[v];\n\t\t\t\tfor(let i = 0; i < edges.length; i++) {\n\t\t\t\t\tlet edge = edges[i];\n\t\t\t\t\tif(!visited[edge.end] && checkLoop(edge.end, visited, recursionStack, paths)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if(recursionStack[edge.end]) {\n\t\t\t\t\t\tpaths.push(edge.end);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trecursionStack[v] = false;\n\t\treturn false;\n\t}\n}\n\n//使得内部的字符串变成数组\nfunction strValue2Arr(obj) {\n\tif(!obj || xsloader.isArray(obj)) {\n\t\treturn;\n\t}\n\tfor(let x in obj) {\n\t\tif(xsloader.isString(obj[x])) {\n\t\t\tobj[x] = [obj[x]];\n\t\t}\n\t}\n}\n\n/**\n * 同步模式下，返回false表示终止循环。\n * @param {Object} ary\n * @param {Object} func\n * @param {Object} isSync\n * @param {Object} fromEnd\n */\nfunction each(ary, func, isSync, fromEnd) {\n\tif(ary) {\n\t\tif(isSync) {\n\t\t\tfunction fun(index) {\n\t\t\t\tif(fromEnd ? index < 0 : index >= ary.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet handle = function(rs) {\n\t\t\t\t\tif(rs) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfun(fromEnd ? index - 1 : index + 1);\n\t\t\t\t};\n\t\t\t\tfunc(ary[index], index, ary, handle);\n\t\t\t}\n\t\t\tfun(fromEnd ? ary.length - 1 : 0);\n\t\t} else {\n\t\t\tif(fromEnd) {\n\t\t\t\tfor(let i = ary.length - 1; i >= 0; i--) {\n\t\t\t\t\tif(func(ary[i], i, ary) === false) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor(let i = 0; i < ary.length; i++) {\n\t\t\t\t\tif(func(ary[i], i, ary) === false) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nfunction __commentReplace(match, singlePrefix) {\n\treturn singlePrefix || '';\n}\n//添加内部直接require('...')的模块\nfunction appendInnerDeps(deps, callback) {\n\tif(xsloader.isFunction(callback)) {\n\t\tcallback\n\t\t\t.toString()\n\t\t\t.replace(commentRegExp, __commentReplace)\n\t\t\t.replace(cjsRequireRegExp, function(match, dep) {\n\t\t\t\tdeps.push(dep);\n\t\t\t});\n\t}\n}\n\nlet idCount = 2019;\n\nfunction getAndIncIdCount() {\n\treturn idCount++;\n}\n\nclass PluginError {\n\tconstructor(err) {\n\t\tthis.err = err;\n\t}\n}\n\nexport default {\n\tgraphPath: new GraphPath(),\n\tstrValue2Arr,\n\teach,\n\tappendInnerDeps,\n\tgetAndIncIdCount,\n\tPluginError\n};","import urls from './urls.js';\nimport global from './global.js';\nimport base from './base.js';\n\nexport default {\n\t...urls,\n\tglobal,\n\t...base\n};","import utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n//ie9\ntry {\n\tif(Function.prototype.bind && console && (typeof console['log'] == \"object\")) {\n\t\tutils.each([\"log\", \"info\", \"warn\", \"error\", \"assert\", \"dir\", \"clear\", \"profile\", \"profileEnd\"], (method) => {\n\t\t\tvar thiz = Function.prototype.bind;\n\t\t\tconsole[method] = thiz.call(console[method], console);\n\t\t});\n\t}\n} catch(e) {\n\tglobal.console = {\n\t\tlog: function() {},\n\t\terror: function() {},\n\t\twarn: function() {}\n\t};\n}\n\ntry {\n\n\tif(!Array.prototype.indexOf) {\n\t\tArray.prototype.indexOf = function(elem, offset) {\n\t\t\tfor(let i = offset === undefined ? 0 : offset; i < this.length; i++) {\n\t\t\t\tif(this[i] == elem) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\t}\n\n\tif(!Array.pushAll) {\n\t\tArray.pushAll = function(thiz, arr) {\n\t\t\tif(!xsloader.isArray(arr)) {\n\t\t\t\tthrow new Error(\"not array:\" + arr);\n\t\t\t}\n\t\t\tfor(let i = 0; i < arr.length; i++) {\n\t\t\t\tthiz.push(arr[i]);\n\t\t\t}\n\t\t\treturn thiz;\n\t\t};\n\t}\n} catch(e) {\n\tconsole.error(e);\n}\n\nfunction startsWith(str, starts) {\n\tif(!(typeof str == \"string\")) {\n\t\treturn false;\n\t}\n\treturn str.indexOf(starts) == 0;\n}\n\nfunction endsWith(str, ends) {\n\tif(!(typeof str == \"string\")) {\n\t\treturn false;\n\t}\n\tlet index = str.lastIndexOf(ends);\n\tif(index >= 0 && (str.length - ends.length == index)) {\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction _indexInArray(array, ele, offset = 0, compare) {\n\tlet index = -1;\n\tif(array) {\n\t\tfor(let i = offset || 0; i < array.length; i++) {\n\t\t\tif(compare) {\n\t\t\t\tif(compare(array[i], ele, i, array)) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(array[i] == ele) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\treturn index;\n}\n\nfunction indexInArray(array, ele, compare) {\n\treturn _indexInArray(array, ele, 0, compare);\n}\n\nfunction indexInArrayFrom(array, ele, offset, compare) {\n\treturn _indexInArray(array, ele, offset, compare);\n}\n\nexport default {\n\tstartsWith,\n\tendsWith,\n\tindexInArray,\n\tindexInArrayFrom\n};","//https://github.com/douglascrockford/JSON-js\n//  json2.js\n//  2017-06-12\n//  Public Domain.\n//  NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n//  USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n//  NOT CONTROL.\nconst JSON = {};\n\nexport default JSON;\n\nlet rx_one = /^[\\],:{}\\s]*$/;\nlet rx_two = /\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g;\nlet rx_three = /\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g;\nlet rx_four = /(?:^|:|,)(?:\\s*\\[)+/g;\nlet rx_escapable = /[\\\\\"\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\nlet rx_dangerous = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\n\nfunction f(n) {\n\t// Format integers to have at least two digits.\n\treturn(n < 10) ?\n\t\t\"0\" + n :\n\t\tn;\n}\n\nfunction this_value() {\n\treturn this.valueOf();\n}\n\nif(typeof Date.prototype.toJSON !== \"function\") {\n\n\tDate.prototype.toJSON = function() {\n\t\treturn isFinite(this.valueOf()) ?\n\t\t\t(\n\t\t\t\tthis.getUTCFullYear() +\n\t\t\t\t\"-\" +\n\t\t\t\tf(this.getUTCMonth() + 1) +\n\t\t\t\t\"-\" +\n\t\t\t\tf(this.getUTCDate()) +\n\t\t\t\t\"T\" +\n\t\t\t\tf(this.getUTCHours()) +\n\t\t\t\t\":\" +\n\t\t\t\tf(this.getUTCMinutes()) +\n\t\t\t\t\":\" +\n\t\t\t\tf(this.getUTCSeconds()) +\n\t\t\t\t\"Z\"\n\t\t\t) :\n\t\t\tnull;\n\t};\n\n\tBoolean.prototype.toJSON = this_value;\n\tNumber.prototype.toJSON = this_value;\n\tString.prototype.toJSON = this_value;\n}\n\nlet gap;\nlet indent;\nlet meta;\nlet rep;\n\nfunction quote(string) {\n\n\t// If the string contains no control characters, no quote characters, and no\n\t// backslash characters, then we can safely slap some quotes around it.\n\t// Otherwise we must also replace the offending characters with safe escape\n\t// sequences.\n\n\trx_escapable.lastIndex = 0;\n\treturn rx_escapable.test(string) ?\n\t\t\"\\\"\" + string.replace(rx_escapable, function(a) {\n\t\t\tlet c = meta[a];\n\t\t\treturn typeof c === \"string\" ?\n\t\t\t\tc :\n\t\t\t\t\"\\\\u\" + (\"0000\" + a.charCodeAt(0).toString(16)).slice(-4);\n\t\t}) + \"\\\"\" :\n\t\t\"\\\"\" + string + \"\\\"\";\n}\n\nfunction str(key, holder) {\n\t// Produce a string from holder[key].\n\tlet i; // The loop counter.\n\tlet k; // The member key.\n\tlet v; // The member value.\n\tlet length;\n\tlet mind = gap;\n\tlet partial;\n\tlet value = holder[key];\n\n\t// If the value has a toJSON method, call it to obtain a replacement value.\n\tif(\n\t\tvalue &&\n\t\ttypeof value === \"object\" &&\n\t\ttypeof value.toJSON === \"function\"\n\t) {\n\t\tvalue = value.toJSON(key);\n\t}\n\n\t// If we were called with a replacer function, then call the replacer to\n\t// obtain a replacement value.\n\n\tif(typeof rep === \"function\") {\n\t\tvalue = rep.call(holder, key, value);\n\t}\n\n\t// What happens next depends on the value's type.\n\n\tswitch(typeof value) {\n\t\tcase \"string\":\n\t\t\treturn quote(value);\n\t\tcase \"number\":\n\t\t\t// JSON numbers must be finite. Encode non-finite numbers as null.\n\t\t\treturn(isFinite(value)) ?\n\t\t\t\tString(value) :\n\t\t\t\t\"null\";\n\n\t\tcase \"boolean\":\n\t\tcase \"null\":\n\t\t\t// If the value is a boolean or null, convert it to a string. Note:\n\t\t\t// typeof null does not produce \"null\". The case is included here in\n\t\t\t// the remote chance that this gets fixed someday.\n\t\t\treturn String(value);\n\n\t\t\t// If the type is \"object\", we might be dealing with an object or an array or\n\t\t\t// null.\n\t\tcase \"object\":\n\t\t\t// Due to a specification blunder in ECMAScript, typeof null is \"object\",\n\t\t\t// so watch out for that case.\n\t\t\tif(!value) {\n\t\t\t\treturn \"null\";\n\t\t\t}\n\n\t\t\t// Make an array to hold the partial results of stringifying this object value.\n\n\t\t\tgap += indent;\n\t\t\tpartial = [];\n\t\t\t// Is the value an array?\n\t\t\tif(Object.prototype.toString.apply(value) === \"[object Array]\") {\n\n\t\t\t\t// The value is an array. Stringify every element. Use null as a placeholder\n\t\t\t\t// for non-JSON values.\n\t\t\t\tlength = value.length;\n\t\t\t\tfor(i = 0; i < length; i += 1) {\n\t\t\t\t\tpartial[i] = str(i, value) || \"null\";\n\t\t\t\t}\n\t\t\t\t// Join all of the elements together, separated with commas, and wrap them in\n\t\t\t\t// brackets.\n\n\t\t\t\tv = partial.length === 0 ?\n\t\t\t\t\t\"[]\" :\n\t\t\t\t\tgap ?\n\t\t\t\t\t(\n\t\t\t\t\t\t\"[\\n\" +\n\t\t\t\t\t\tgap +\n\t\t\t\t\t\tpartial.join(\",\\n\" + gap) +\n\t\t\t\t\t\t\"\\n\" +\n\t\t\t\t\t\tmind +\n\t\t\t\t\t\t\"]\"\n\t\t\t\t\t) :\n\t\t\t\t\t\"[\" + partial.join(\",\") + \"]\";\n\t\t\t\tgap = mind;\n\t\t\t\treturn v;\n\t\t\t}\n\n\t\t\t// If the replacer is an array, use it to select the members to be stringified.\n\t\t\tif(rep && typeof rep === \"object\") {\n\t\t\t\tlength = rep.length;\n\t\t\t\tfor(i = 0; i < length; i += 1) {\n\t\t\t\t\tif(typeof rep[i] === \"string\") {\n\t\t\t\t\t\tk = rep[i];\n\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\tif(v) {\n\t\t\t\t\t\t\tpartial.push(quote(k) + (\n\t\t\t\t\t\t\t\t(gap) ?\n\t\t\t\t\t\t\t\t\": \" : \":\"\n\t\t\t\t\t\t\t) + v);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Otherwise, iterate through all of the keys in the object.\n\t\t\t\tfor(k in value) {\n\t\t\t\t\tif(Object.prototype.hasOwnProperty.call(value, k)) {\n\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\tif(v) {\n\t\t\t\t\t\t\tpartial.push(quote(k) + (\n\t\t\t\t\t\t\t\t(gap) ?\n\t\t\t\t\t\t\t\t\": \" :\n\t\t\t\t\t\t\t\t\":\"\n\t\t\t\t\t\t\t) + v);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Join all of the member texts together, separated with commas,\n\t\t\t// and wrap them in braces.\n\n\t\t\tv = partial.length === 0 ?\n\t\t\t\t\"{}\" : gap ?\n\t\t\t\t\"{\\n\" + gap + partial.join(\",\\n\" + gap) + \"\\n\" + mind + \"}\" :\n\t\t\t\t\"{\" + partial.join(\",\") + \"}\";\n\t\t\tgap = mind;\n\t\t\treturn v;\n\t}\n}\n\n// If the JSON object does not yet have a stringify method, give it one.\nif(typeof JSON.stringify !== \"function\") {\n\tmeta = { // table of character substitutions\n\t\t\"\\b\": \"\\\\b\",\n\t\t\"\\t\": \"\\\\t\",\n\t\t\"\\n\": \"\\\\n\",\n\t\t\"\\f\": \"\\\\f\",\n\t\t\"\\r\": \"\\\\r\",\n\t\t\"\\\"\": \"\\\\\\\"\",\n\t\t\"\\\\\": \"\\\\\\\\\"\n\t};\n\tJSON.stringify = function(value, replacer, space) {\n\n\t\t// The stringify method takes a value and an optional replacer, and an optional\n\t\t// space parameter, and returns a JSON text. The replacer can be a function\n\t\t// that can replace values, or an array of strings that will select the keys.\n\t\t// A default replacer method can be provided. Use of the space parameter can\n\t\t// produce text that is more easily readable.\n\n\t\tlet i;\n\t\tgap = \"\";\n\t\tindent = \"\";\n\t\t// If the space parameter is a number, make an indent string containing that\n\t\t// many spaces.\n\t\tif(typeof space === \"number\") {\n\t\t\tfor(i = 0; i < space; i += 1) {\n\t\t\t\tindent += \" \";\n\t\t\t}\n\n\t\t\t// If the space parameter is a string, it will be used as the indent string.\n\n\t\t} else if(typeof space === \"string\") {\n\t\t\tindent = space;\n\t\t}\n\n\t\t// If there is a replacer, it must be a function or an array.\n\t\t// Otherwise, throw an error.\n\n\t\trep = replacer;\n\t\tif(replacer && typeof replacer !== \"function\" && (\n\t\t\t\ttypeof replacer !== \"object\" ||\n\t\t\t\ttypeof replacer.length !== \"number\"\n\t\t\t)) {\n\t\t\tthrow new Error(\"JSON.stringify\");\n\t\t}\n\n\t\t// Make a fake root object containing our value under the key of \"\".\n\t\t// Return the result of stringifying the value.\n\n\t\treturn str(\"\", {\n\t\t\t\"\": value\n\t\t});\n\t};\n}\n\n// If the JSON object does not yet have a parse method, give it one.\n\nif(typeof JSON.parse !== \"function\") {\n\tJSON.parse = function(text, reviver) {\n\t\t// The parse method takes a text and an optional reviver function, and returns\n\t\t// a JavaScript value if the text is a valid JSON text.\n\t\tlet j;\n\n\t\tfunction walk(holder, key) {\n\t\t\t// The walk method is used to recursively walk the resulting structure so\n\t\t\t// that modifications can be made.\n\t\t\tlet k;\n\t\t\tlet v;\n\t\t\tlet value = holder[key];\n\t\t\tif(value && typeof value === \"object\") {\n\t\t\t\tfor(k in value) {\n\t\t\t\t\tif(Object.prototype.hasOwnProperty.call(value, k)) {\n\t\t\t\t\t\tv = walk(value, k);\n\t\t\t\t\t\tif(v !== undefined) {\n\t\t\t\t\t\t\tvalue[k] = v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete value[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn reviver.call(holder, key, value);\n\t\t}\n\n\t\t// Parsing happens in four stages. In the first stage, we replace certain\n\t\t// Unicode characters with escape sequences. JavaScript handles many characters\n\t\t// incorrectly, either silently deleting them, or treating them as line endings.\n\t\ttext = String(text);\n\t\trx_dangerous.lastIndex = 0;\n\t\tif(rx_dangerous.test(text)) {\n\t\t\ttext = text.replace(rx_dangerous, function(a) {\n\t\t\t\treturn(\n\t\t\t\t\t\"\\\\u\" +\n\t\t\t\t\t(\"0000\" + a.charCodeAt(0).toString(16)).slice(-4)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\t// In the second stage, we run the text against regular expressions that look\n\t\t// for non-JSON patterns. We are especially concerned with \"()\" and \"new\"\n\t\t// because they can cause invocation, and \"=\" because it can cause mutation.\n\t\t// But just to be safe, we want to reject all unexpected forms.\n\n\t\t// We split the second stage into 4 regexp operations in order to work around\n\t\t// crippling inefficiencies in IE's and Safari's regexp engines. First we\n\t\t// replace the JSON backslash pairs with \"@\" (a non-JSON character). Second, we\n\t\t// replace all simple value tokens with \"]\" characters. Third, we delete all\n\t\t// open brackets that follow a colon or comma or that begin the text. Finally,\n\t\t// we look to see that the remaining characters are only whitespace or \"]\" or\n\t\t// \",\" or \":\" or \"{\" or \"}\". If that is so, then the text is safe for eval.\n\n\t\tif(\n\t\t\trx_one.test(\n\t\t\t\ttext\n\t\t\t\t.replace(rx_two, \"@\")\n\t\t\t\t.replace(rx_three, \"]\")\n\t\t\t\t.replace(rx_four, \"\")\n\t\t\t)\n\t\t) {\n\n\t\t\t// In the third stage we use the eval function to compile the text into a\n\t\t\t// JavaScript structure. The \"{\" operator is subject to a syntactic ambiguity\n\t\t\t// in JavaScript: it can begin a block or an object literal. We wrap the text\n\t\t\t// in parens to eliminate the ambiguity.\n\t\t\tj = eval(\"(\" + text + \")\");\n\t\t\t// In the optional fourth stage, we recursively walk the new structure, passing\n\t\t\t// each name/value pair to a reviver function for possible transformation.\n\n\t\t\treturn(typeof reviver === \"function\") ?\n\t\t\t\twalk({\n\t\t\t\t\t\"\": j\n\t\t\t\t}, \"\") : j;\n\t\t}\n\t\t// If the text is not JSON parseable, then a SyntaxError is thrown.\n\t\tthrow new SyntaxError(\"JSON.parse\");\n\t};\n}","import {\n\tJSON as xsJSON\n} from \"../polyfill/index.js\";\nimport utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nif(!String.prototype.trim) {\n\tString.prototype.trim = function() {\n\t\treturn this.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\t};\n}\n\n//生成一个随机的id，只保证在本页面是唯一的\nfunction randId(suffix) {\n\tlet id = \"r\" + parseInt(new Date().getTime() / 1000) + \"_\" + parseInt(Math.random() * 1000) + \"_\" + utils.getAndIncIdCount();\n\tif(suffix !== undefined) {\n\t\tid += suffix;\n\t}\n\treturn id;\n}\n\nfunction xsEval(scriptString) {\n\ttry {\n\t\tlet rs = xsloader.IE_VERSION > 0 && xsloader.IE_VERSION < 9 ? eval(\"[\" + scriptString + \"][0]\") : eval(\"(\" + scriptString + \")\");\n\t\treturn rs;\n\t} catch(e) {\n\t\tthrow e;\n\t}\n}\n\n/**\n * 注意key需要用引号包裹\n * @param {Object} str\n * @param {Object} option\n */\nfunction xsParseJson(str, option) {\n\tif(str === \"\" || str === null || str === undefined || !xsloader.isString(str)) {\n\t\treturn str;\n\t}\n\n\toption = xsloader.extend({\n\t\tfnStart: \"\", //\"/*{f}*/\",\n\t\tfnEnd: \"\", //\"/*{f}*/\",\n\t\trcomment: \"\\\\/\\\\/#\\\\/\\\\/\"\n\t}, option);\n\n\tlet fnMap = {};\n\tlet fnOffset = 0;\n\tlet replacer = undefined;\n\tif(option.fnStart && option.fnEnd) {\n\t\twhile(true) {\n\t\t\tlet indexStart = str.indexOf(option.fnStart, fnOffset);\n\t\t\tlet indexEnd = str.indexOf(option.fnEnd, indexStart == -1 ? fnOffset : indexStart + option.fnStart.length);\n\t\t\tif(indexStart == -1 && indexEnd == -1) {\n\t\t\t\tbreak;\n\t\t\t} else if(indexStart == -1) {\n\t\t\t\tconsole.warn(\"found end:\" + option.fnEnd + \",may lack start:\" + option.fnStart);\n\t\t\t\tbreak;\n\t\t\t} else if(indexEnd == -1) {\n\t\t\t\tconsole.warn(\"found start:\" + option.fnStart + \",may lack end:\" + option.fnEnd);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlet fnId = \"_[_\" + randId() + \"_]_\";\n\t\t\tlet fnStr = str.substring(indexStart + option.fnStart.length, indexEnd).trim();\n\t\t\tif(!xsloader.startsWith(fnStr, \"function(\")) {\n\t\t\t\tthrow \"not a function:\" + fnStr;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tstr = str.substring(0, indexStart) + '\"' + fnId + '\"' + str.substring(indexEnd + option.fnEnd.length);\n\t\t\t\tlet fn = xsloader.xsEval(fnStr);\n\t\t\t\tfnMap[fnId] = fn;\n\t\t\t} catch(e) {\n\t\t\t\tconsole.error(fnStr);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\tfnOffset = indexStart + fnId.length;\n\t\t}\n\t\treplacer = function(key, val) {\n\t\t\tif(xsloader.isString(val) && fnMap[val]) {\n\t\t\t\treturn fnMap[val];\n\t\t\t} else {\n\t\t\t\treturn val;\n\t\t\t}\n\t\t};\n\t}\n\n\tif(option.rcomment) {\n\t\tstr = str.replace(/(\\r\\n)|\\r/g, \"\\n\"); //统一换行符号\n\t\tstr = str.replace(new RegExp(option.rcomment + \"[^\\\\n]*(\\\\n|$)\", \"g\"), \"\"); //去除行注释\n\t}\n\n\ttry {\n\t\tlet jsonObj = xsJSON;\n\t\treturn jsonObj.parse(str, replacer);\n\t} catch(e) {\n\t\ttry {\n\t\t\tlet reg = new RegExp('position[\\\\s]*([0-9]+)[\\\\s]*$');\n\t\t\tif(e.message && reg.test(e.message)) {\n\t\t\t\tlet posStr = e.message.substring(e.message.lastIndexOf(\"position\") + 8);\n\t\t\t\tlet pos = parseInt(posStr.trim());\n\t\t\t\tlet _str = str.substring(pos);\n\t\t\t\tconsole.error(e.message + \":\" + _str.substring(0, _str.length > 100 ? 100 : _str.length));\n\t\t\t}\n\t\t} catch(e2) {\n\t\t\tconsole.warn(e2);\n\t\t}\n\t\tthrow e;\n\t}\n}\n\nfunction xsJson2String(obj) {\n\tlet jsonObj = xsJSON;\n\treturn jsonObj.stringify(obj);\n}\n\nconst getPathWithRelative = utils.getPathWithRelative;\n\nfunction _toParamsMap(argsStr, decode = true) {\n\tif(xsloader.isObject(argsStr)) {\n\t\treturn argsStr;\n\t}\n\tif(!argsStr) {\n\t\targsStr = location.search;\n\t}\n\n\tlet index = argsStr.indexOf(\"?\");\n\tif(index >= 0) {\n\t\targsStr = argsStr.substring(index + 1);\n\t} else {\n\t\tif(utils.dealPathMayAbsolute(argsStr).absolute) {\n\t\t\treturn {};\n\t\t}\n\t}\n\tindex = argsStr.lastIndexOf(\"#\");\n\tif(index >= 0) {\n\t\targsStr = argsStr.substring(0, index);\n\t}\n\n\tlet ret = {},\n\t\tseg = argsStr.split('&'),\n\t\ts;\n\tfor(let i = 0; i < seg.length; i++) {\n\t\tif(!seg[i]) {\n\t\t\tcontinue;\n\t\t}\n\t\ts = seg[i].split('=');\n\t\tlet name = decode ? decodeURIComponent(s[0]) : s[0];\n\t\tret[name] = decode ? decodeURIComponent(s[1]) : s[1];\n\t}\n\treturn ret;\n}\n\nfunction appendArgs2Url(url, urlArgs) {\n\tif(url === undefined || url === null || !urlArgs) {\n\t\treturn url;\n\t}\n\n\tlet index = url.lastIndexOf(\"?\");\n\tlet hashIndex = url.lastIndexOf(\"#\");\n\tif(hashIndex < 0) {\n\t\thashIndex = url.length;\n\t}\n\tlet oldParams = index < 0 ? {} : _toParamsMap(url.substring(index + 1, hashIndex), false);\n\tlet newParams = _toParamsMap(urlArgs, false);\n\tlet has = false;\n\tfor(let k in newParams) {\n\t\tif(oldParams[k] != newParams[k]) {\n\t\t\toldParams[k] = newParams[k];\n\t\t\thas = true;\n\t\t}\n\t}\n\tif(!has) {\n\t\treturn url; //参数没有变化直接返回\n\t}\n\n\tlet paramKeys = [];\n\tfor(let k in oldParams) {\n\t\tparamKeys.push(k);\n\t}\n\tparamKeys.sort();\n\n\tlet path = index < 0 ? url.substring(0, hashIndex) : url.substring(0, index);\n\tlet params = [];\n\n\tfor(let i = 0; i < paramKeys.length; i++) { //保证参数按照顺序\n\t\tlet k = paramKeys[i];\n\t\tparams.push(k + \"=\" + oldParams[k]);\n\t}\n\tparams = params.join(\"&\");\n\tlet hash = \"\";\n\tif(hashIndex >= 0 && hashIndex < url.length) {\n\t\thash = url.substring(hashIndex);\n\t}\n\treturn path + (params ? \"?\" + params : \"\") + (hash ? hash : \"\");\n\n}\n\nfunction queryString2ParamsMap(argsStr, decode) {\n\treturn _toParamsMap(argsStr, decode);\n}\n\nexport default {\n\trandId,\n\txsEval,\n\txsParseJson,\n\txsJson2String,\n\tgetPathWithRelative,\n\tappendArgs2Url,\n\tqueryString2ParamsMap\n};","const ostring = Object.prototype.toString;\n\nfunction isArray(it) {\n\treturn it && (it instanceof Array) || ostring.call(it) === '[object Array]';\n}\n\nfunction isFunction(it) {\n\treturn it && (typeof it == \"function\") || ostring.call(it) === '[object Function]';\n}\n\nfunction isObject(it) {\n\tif(it === null || it === undefined) {\n\t\treturn false;\n\t}\n\treturn(typeof it == \"object\") || ostring.call(it) === '[object Object]';\n}\n\nfunction isString(it) {\n\treturn it && (typeof it == \"string\") || ostring.call(it) === '[object String]';\n}\n\nfunction isDate(it) {\n\treturn it && (it instanceof Date) || ostring.call(it) === '[object Date]';\n}\n\nfunction isRegExp(it) {\n\treturn it && (it instanceof RegExp) || ostring.call(it) === '[object RegExp]';\n}\n\nexport default {\n\tisArray,\n\tisFunction,\n\tisObject,\n\tisString,\n\tisDate,\n\tisRegExp,\n};","import utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nfunction queryParam(name, otherValue, optionUrl) {\n\tlet search;\n\tif(optionUrl) {\n\t\tlet index = optionUrl.indexOf('?');\n\t\tif(index < 0) {\n\t\t\tindex = 0;\n\t\t} else {\n\t\t\tindex += 1;\n\t\t}\n\t\tsearch = optionUrl.substr(index);\n\t} else {\n\t\tsearch = window.location.search.substr(1);\n\t}\n\n\tlet reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\n\tlet r = search.match(reg);\n\tif(r != null) return decodeURIComponent(r[2]);\n\treturn otherValue !== undefined ? otherValue : null;\n}\n\nfunction getUrl(relativeUrl, appendArgs, optionalAbsUrl) {\n\tif(optionalAbsUrl && !utils.dealPathMayAbsolute(optionalAbsUrl).absolute) {\n\t\tthrow new Error(\"expected absolute url:\" + optionalAbsUrl);\n\t}\n\tif(appendArgs === undefined) {\n\t\tappendArgs = true;\n\t}\n\tlet theConfig = xsloader.config();\n\tlet thePageUrl = xsloader.pageUrl();\n\tlet url;\n\tif(relativeUrl === undefined) {\n\t\turl = thePageUrl;\n\t} else if(xsloader.startsWith(relativeUrl, \".\") || utils.dealPathMayAbsolute(relativeUrl).absolute) {\n\t\turl = utils.getPathWithRelative(optionalAbsUrl || thePageUrl, relativeUrl);\n\t} else {\n\t\turl = theConfig.baseUrl + relativeUrl;\n\t}\n\tif(appendArgs) {\n\t\tif(url == thePageUrl) {\n\t\t\turl += location.search + location.hash;\n\t\t}\n\t\treturn theConfig.dealUrl({}, url);\n\t} else {\n\t\treturn url;\n\t}\n}\n\nfunction tryCall(fun, defaultReturn, thiz, exCallback) {\n\tlet rs;\n\ttry {\n\t\tthiz = thiz === undefined ? this : thiz;\n\t\trs = fun.call(thiz);\n\t} catch(e) {\n\t\tif(xsloader.isFunction(exCallback)) {\n\t\t\texCallback(e);\n\t\t} else {\n\t\t\tconsole.warn(e);\n\t\t}\n\t}\n\tif(rs === undefined || rs === null) {\n\t\trs = defaultReturn;\n\t}\n\treturn rs;\n}\n\nfunction dealProperties(obj, properties) {\n\treturn utils.propertiesDeal(obj, properties);\n}\n\nfunction extend(target) {\n\tfor(let i = 1; i < arguments.length; i++) {\n\t\tlet obj = arguments[i];\n\t\tif(!obj) {\n\t\t\tcontinue;\n\t\t}\n\t\tfor(let x in obj) {\n\t\t\tlet value = obj[x];\n\t\t\tif(value === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttarget[x] = obj[x];\n\t\t}\n\t}\n\treturn target;\n}\n\nfunction extendDeep(target) {\n\tif(!target) {\n\t\treturn target;\n\t}\n\tfor(let i = 1; i < arguments.length; i++) {\n\t\tlet obj = arguments[i];\n\t\tif(!obj) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor(let x in obj) {\n\t\t\tlet value = obj[x];\n\t\t\tif(value === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(xsloader.isObject(value) && xsloader.isObject(target[x])) {\n\t\t\t\ttarget[x] = xsloader.extendDeep(target[x], value);\n\t\t\t} else {\n\t\t\t\ttarget[x] = obj[x];\n\t\t\t}\n\t\t}\n\t}\n\treturn target;\n}\n\nfunction _AsyncCall(useTimer) {\n\tlet thiz = this;\n\tlet count = 0;\n\tlet ctrlCallbackMap = {};\n\n\tfunction initCtrlCallback(callbackObj) {\n\t\tlet mineCount = count + \"\";\n\t\tif(!ctrlCallbackMap[mineCount]) {\n\t\t\tlet ctrlCallback = function() {\n\t\t\t\tcount++;\n\t\t\t\tlet asyncCallQueue = ctrlCallbackMap[mineCount];\n\t\t\t\tdelete ctrlCallbackMap[mineCount];\n\t\t\t\twhile(asyncCallQueue.length) {\n\t\t\t\t\tlet callbackObj = asyncCallQueue.shift();\n\t\t\t\t\tlet lastReturn = undefined;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif(callbackObj.callback) {\n\t\t\t\t\t\t\tlastReturn = callbackObj.callback.call(callbackObj.handle, callbackObj.obj, mineCount);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t\tlet handle;\n\t\t\t\t\twhile(callbackObj.nextCallback.length) {\n\t\t\t\t\t\tlet nextObj = callbackObj.nextCallback.shift();\n\t\t\t\t\t\tif(!handle) {\n\t\t\t\t\t\t\thandle = thiz.pushTask(nextObj.callback, lastReturn);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thandle.next(nextObj.callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tctrlCallbackMap[mineCount] = [];\n\t\t\tif(!useTimer && global.Promise && global.Promise.resolve) {\n\t\t\t\tglobal.Promise.resolve().then(ctrlCallback);\n\t\t\t} else {\n\t\t\t\tsetTimeout(ctrlCallback, 0);\n\t\t\t}\n\t\t}\n\t\tlet queue = ctrlCallbackMap[mineCount];\n\t\tqueue.push(callbackObj);\n\t}\n\n\tthis.pushTask = function(callback, obj) {\n\t\tlet callbackObj;\n\t\tlet handle = {\n\t\t\tnext: function(nextCallback, lastReturn) {\n\t\t\t\tcallbackObj.nextCallback.push({\n\t\t\t\t\tcallback: nextCallback,\n\t\t\t\t\tlastReturn: lastReturn\n\t\t\t\t});\n\t\t\t\treturn this;\n\t\t\t}\n\t\t};\n\t\tcallbackObj = {\n\t\t\tcallback: callback,\n\t\t\tobj: obj,\n\t\t\tnextCallback: [],\n\t\t\thandle: handle\n\t\t};\n\n\t\tinitCtrlCallback(callbackObj);\n\n\t\treturn handle;\n\t};\n}\n\nconst theAsyncCall = new _AsyncCall();\nconst theAsyncCallOfTimer = new _AsyncCall(true);\n\nlet asyncCall = function(callback, useTimer) {\n\tif(useTimer) {\n\t\treturn theAsyncCallOfTimer.pushTask(callback);\n\t} else {\n\t\treturn theAsyncCall.pushTask(callback);\n\t}\n};\n\n/**\n * 得到属性\n * @param {Object} obj\n * @param {Object} attrNames \"rs\"、\"rs.total\"等\n */\nfunction getObjectAttr(obj, attrNames, defaultValue) {\n\tif(!obj || !attrNames) {\n\t\treturn undefined;\n\t}\n\tlet attrs = attrNames.split(\".\");\n\tlet rs = defaultValue;\n\tlet i = 0;\n\tfor(; i < attrs.length && obj; i++) {\n\t\tlet k = attrs[i];\n\t\tobj = obj[k];\n\t}\n\tif(i == attrs.length) {\n\t\trs = obj;\n\t}\n\n\treturn rs;\n}\n\n/**\n * 设置属性\n * @param {Object} obj\n * @param {Object} attrNames \"rs\"、\"rs.total\"等\n */\nfunction setObjectAttr(obj, attrNames, value) {\n\tlet _obj = obj;\n\tlet attrs = attrNames.split(\".\");\n\n\tfor(let i = 0; i < attrs.length; i++) {\n\t\tlet k = attrs[i];\n\n\t\tif(i == attrs.length - 1) {\n\t\t\tobj[k] = value;\n\t\t\tbreak;\n\t\t}\n\t\tlet o = obj[k];\n\t\tif(!o) {\n\t\t\to = {};\n\t\t\tobj[k] = o;\n\t\t}\n\t\tobj = o;\n\t}\n\treturn _obj;\n}\n\nfunction clone(obj, isDeep) {\n\t// Handle the 3 simple types, and null or undefined or function\n\tif(!obj || xsloader.isFunction(obj) || xsloader.isString(obj)) return obj;\n\n\tif(xsloader.isRegExp(obj)) {\n\t\treturn new RegExp(obj.source, obj.flags);\n\t}\n\n\t// Handle Date\n\tif(xsloader.isDate(obj)) {\n\t\tlet copy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\t// Handle Array or Object\n\tif(xsloader.isArray(obj) || xsloader.isObject(obj)) {\n\t\tlet copy = xsloader.isArray(obj) ? [] : {};\n\t\tfor(let attr in obj) {\n\t\t\tif(obj.hasOwnProperty(attr))\n\t\t\t\tcopy[attr] = isDeep ? clone(obj[attr]) : obj[attr];\n\t\t}\n\t\treturn copy;\n\t}\n\treturn obj;\n}\n\nexport default {\n\tqueryParam,\n\tgetUrl,\n\ttryCall,\n\tdealProperties,\n\textend,\n\textendDeep,\n\tasyncCall,\n\tgetObjectAttr,\n\tsetObjectAttr,\n\tclone\n};","import utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nlet isDOM = (typeof HTMLElement === 'object') ?\n\tfunction(obj) {\n\t\treturn obj && (obj instanceof HTMLElement);\n\t} :\n\tfunction(obj) {\n\t\treturn obj && typeof obj === 'object' && obj.nodeType === 1 && typeof obj.nodeName === 'string';\n\t};\n\nlet onReadyFun = (function() {\n\tlet isGlobalReady = false;\n\tlet bindReadyQueue = [];\n\n\tfunction BindReady(callback) {\n\t\tif(isGlobalReady) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\t\tlet isReady = false;\n\n\t\tfunction ready() {\n\t\t\tif(isReady) return;\n\t\t\tisReady = true;\n\t\t\tisGlobalReady = true;\n\t\t\tcallback();\n\t\t}\n\t\t// Mozilla, Opera and webkit nightlies currently support this event\n\t\tif(document.addEventListener) {\n\t\t\tlet fun;\n\t\t\tfun = function() {\n\t\t\t\tdocument.removeEventListener(\"DOMContentLoaded\", fun);\n\t\t\t\tready();\n\t\t\t};\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", fun);\n\n\t\t} else if(document.attachEvent) {\n\t\t\t// ensure firing before onload,\n\t\t\t// maybe late but safe also for iframes\n\t\t\tlet fun;\n\t\t\tfun = function() {\n\t\t\t\tif(document.readyState === \"complete\") {\n\t\t\t\t\tdocument.detachEvent(\"onreadystatechange\", fun);\n\t\t\t\t\tready();\n\t\t\t\t}\n\t\t\t};\n\t\t\tdocument.attachEvent(\"onreadystatechange\", fun);\n\t\t\t// If IE and not an iframe\n\t\t\t// continually check to see if the document is ready\n\n\t\t\tlet fun2;\n\t\t\tfun2 = function() {\n\t\t\t\tif(isReady) return;\n\t\t\t\ttry {\n\t\t\t\t\t// If IE is used, use the trick by Diego Perini\n\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\tdocument.documentElement.doScroll(\"left\");\n\t\t\t\t} catch(error) {\n\t\t\t\t\tsetTimeout(fun2, 0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// and execute any waiting functions\n\t\t\t\tready();\n\t\t\t};\n\n\t\t\tif(document.documentElement.doScroll && typeof global.frameElement === \"undefined\")(fun2)();\n\t\t} else {\n\t\t\txsloader.asyncCall(null, true).next(function() {\n\t\t\t\tready();\n\t\t\t});\n\t\t}\n\t\tthis.readyCall = ready;\n\t}\n\tlet onReady = function(callback) {\n\t\tif(document.readyState === \"complete\") {\n\t\t\tisGlobalReady = true;\n\t\t}\n\t\tlet br = new BindReady(callback);\n\t\tif(!isGlobalReady) {\n\t\t\tbindReadyQueue.push(br);\n\t\t}\n\t};\n\tonReady(function() {\n\t\tisGlobalReady = true;\n\t});\n\n\tif(document.readyState === \"complete\") {\n\t\tisGlobalReady = true;\n\t} else {\n\t\tlet addEventHandle;\n\t\tif(global.addEventListener) {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\tglobal.addEventListener(type, callback, false);\n\t\t\t};\n\t\t} else if(global.attachEvent) {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\tglobal.attachEvent(\"on\" + type, callback);\n\t\t\t};\n\t\t} else {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\txsloader.asyncCall(null, true).next(function() {\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t\taddEventHandle(\"load\", function() {\n\t\t\tisGlobalReady = true;\n\t\t\twhile(bindReadyQueue.length) {\n\t\t\t\tbindReadyQueue.shift().readyCall();\n\t\t\t}\n\t\t});\n\t}\n\treturn onReady;\n})();\n\nexport default {\n\tisDOM,\n\tonReady: onReadyFun\n};","import utils from \"../util/index.js\";\n////////////////////\n\nimport deprecated from './global-deprecated.js';\nimport base from './global-base.js';\n//////////////////\nimport is from './is.js';\nimport funs from './funs.js';\nimport browser from './browser.js';\n\nconst global = utils.global;\nconst xsloader=global.xsloader;\n\nlet toGlobal = {\n\t...deprecated,\n\t...base\n};\nfor(let k in toGlobal) {\n\txsloader[k] = toGlobal[k];\n\tglobal[k] = toGlobal[k];\n}\n\nlet justLoader = {\n\t...is,\n\t...funs,\n\t...browser,\n\t_ignoreAspect_: {\n\n\t}\n};\nfor(let k in justLoader) {\n\txsloader[k] = justLoader[k];\n}","import utils from \"../util/index.js\";\nimport script from \"./script.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\nconst theDefinedMap = {};\nconst INNER_DEPS_PLUGIN = \"__inner_deps__\";\nconst innerDepsMap = {}; //内部依赖加载插件用于保存依赖的临时map\n\nfunction getModule(nameOrUrl) {\n\tnameOrUrl = utils.removeQueryHash(nameOrUrl);\n\tlet m = theDefinedMap[nameOrUrl];\n\treturn m ? m.get() : null;\n}\n\nfunction setModule(nameOrUrl, m) {\n\tnameOrUrl = utils.removeQueryHash(nameOrUrl);\n\tlet last = theDefinedMap[nameOrUrl];\n\ttheDefinedMap[nameOrUrl] = m;\n\treturn last;\n}\n\nfunction buildInvoker(obj) {\n\tlet invoker = obj[\"thiz\"];\n\tlet module = obj.module || obj;\n\tlet id = xsloader.randId();\n\tinvoker.getId = function() {\n\t\treturn id;\n\t};\n\tinvoker.getUrl = function(relativeUrl, appendArgs, optionalAbsUrl) {\n\t\tif(optionalAbsUrl && !utils.dealPathMayAbsolute(optionalAbsUrl).absolute) {\n\t\t\tthrow new Error(-1, \"expected absolute url:\" + optionalAbsUrl);\n\t\t}\n\t\tif(appendArgs === undefined) {\n\t\t\tappendArgs = true;\n\t\t}\n\t\tlet url;\n\t\tif(relativeUrl === undefined) {\n\t\t\turl = this.getAbsoluteUrl();\n\t\t} else if(xsloader.startsWith(relativeUrl, \".\") || utils.dealPathMayAbsolute(relativeUrl).absolute) {\n\t\t\turl = utils.getPathWithRelative(optionalAbsUrl || this.rurl(), relativeUrl);\n\t\t} else {\n\t\t\turl = xsloader.config().baseUrl + relativeUrl;\n\t\t}\n\t\tif(appendArgs) {\n\t\t\tif(url == script.thePageUrl) {\n\t\t\t\turl += location.search + location.hash;\n\t\t\t}\n\t\t\treturn xsloader.config().dealUrl(module, url);\n\t\t} else {\n\t\t\treturn url;\n\t\t}\n\t};\n\tinvoker.require = function() {\n\t\tlet h = xsloader.require.apply(invoker, arguments);\n\t\treturn h;\n\t};\n\tinvoker.define = function() {\n\t\tlet h = xsloader.define.apply(invoker, arguments);\n\t\treturn h;\n\t};\n\tinvoker.rurl = function(defineObject) {\n\t\treturn defineObject && defineObject.absUrl || this.absUrl() || this.getAbsoluteUrl();\n\t};\n\tinvoker.defineAsync = function() {\n\t\tlet h = this.define.apply(this, arguments);\n\t\treturn h;\n\t};\n\tinvoker.withAbsUrl = function(absUrl) {\n\t\tlet moduleMap = {\n\t\t\tmodule: module,\n\t\t\tsrc: absUrl,\n\t\t\tabsUrl: absUrl,\n\t\t\tname: invoker.getName(),\n\t\t\tinvoker: invoker.invoker()\n\t\t};\n\t\tmoduleMap.thiz = new script.Invoker(moduleMap);\n\t\tbuildInvoker(moduleMap);\n\t\treturn moduleMap.thiz;\n\t};\n}\n\n//新建模块实例\n//relyCallback(depModuleThis)\nfunction newModuleInstance(module, thatInvoker, relyCallback, pluginArgs) {\n\tlet instanceModule = {\n\t\trelyCallback: relyCallback,\n\t\t_invoker: thatInvoker,\n\t\t_module_: null,\n\t\tinitInvoker: function() {\n\t\t\t//确保正确的invoker\n\t\t\tif(module.ignoreAspect) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet obj = this._object;\n\t\t\tlet invoker = this._invoker;\n\n\t\t\tlet addTheAttrs = (theObj) => {\n\t\t\t\ttheObj._invoker_ = invoker;\n\t\t\t\tif(theObj._module_) {\n\t\t\t\t\ttheObj._modules_ = theObj._modules_ || [];\n\t\t\t\t\ttheObj._modules_.push(theObj._module_);\n\t\t\t\t}\n\t\t\t\ttheObj._module_ = this._module_;\n\t\t\t\treturn theObj;\n\t\t\t};\n\n\t\t\tlet isSingle = module.instanceType != \"clone\";\n\n\t\t\tif(xsloader.isObject(obj)) {\n\t\t\t\tif(module.loopObject && !isSingle) {\n\t\t\t\t\tthrow new Error(\"loop dependency not support single option:\" + module.name);\n\t\t\t\t}\n\t\t\t\tthis._object = addTheAttrs(isSingle ? obj : xsloader.clone(obj));\n\t\t\t} else if(xsloader.isFunction(obj)) {\n\t\t\t\tthis._object = addTheAttrs(obj);\n\t\t\t}\n\n\t\t},\n\t\t_object: null,\n\t\t_setDepModuleObjectGen: function(obj) {\n\t\t\tthis._object = obj;\n\t\t\tthis.initInvoker();\n\t\t},\n\t\tmodule: module,\n\t\tmoduleObject: function() {\n\t\t\treturn this._object;\n\t\t},\n\t\tgenExports: function() {\n\t\t\tthis._setDepModuleObjectGen({});\n\t\t\treturn this._object;\n\t\t},\n\t\t_getCacheKey: function(pluginArgs) {\n\t\t\tif(this._object.getCacheKey) {\n\t\t\t\treturn this._object.getCacheKey.call(this.thiz, pluginArgs);\n\t\t\t}\n\t\t\tlet id = this._invoker.getUrl();\n\t\t\treturn id;\n\t\t},\n\t\t_willCache: function(pluginArgs, cacheResult) {\n\t\t\tif(this._object.willCache) {\n\t\t\t\treturn this._object.willCache.call(this.thiz, pluginArgs, cacheResult);\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tlastSinglePluginResult: function(pluginArgs) {\n\t\t\tlet id = this._getCacheKey(pluginArgs);\n\t\t\treturn this.module.lastSinglePluginResult(id, pluginArgs);\n\t\t},\n\t\tsetSinglePluginResult: function(pluginArgs, obj) {\n\t\t\tlet id = this._getCacheKey(pluginArgs);\n\t\t\tlet willCache = this._willCache(pluginArgs, obj);\n\t\t\treturn this.module.setSinglePluginResult(willCache, id, pluginArgs, obj);\n\t\t},\n\t\tinit: function(justForSingle) {\n\t\t\tlet relyCallback = this.relyCallback;\n\t\t\tthis._module_ = this.module.dealInstance(this);\n\t\t\tthis._setDepModuleObjectGen(this.module.loopObject || this.module.moduleObject);\n\t\t\tif(pluginArgs !== undefined) {\n\t\t\t\tif(!this._object) {\n\t\t\t\t\tthrow new Error(\"pulgin error:\" + this.module.name);\n\t\t\t\t}\n\t\t\t\tif(this._object.isSingle === undefined) {\n\t\t\t\t\tthis._object.isSingle = true; //同样的参数也需要重新调用\n\t\t\t\t}\n\t\t\t\tif(justForSingle && !this._object.isSingle) {\n\t\t\t\t\tthrow new Error(\"just for single plugin\");\n\t\t\t\t}\n\n\t\t\t\tlet hasFinished = false;\n\t\t\t\tlet onload = (result, ignoreAspect) => {\n\t\t\t\t\tif(result == undefined) {\n\t\t\t\t\t\tresult = {\n\t\t\t\t\t\t\t__default: true\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\thasFinished = true;\n\t\t\t\t\tif(this._object.isSingle) {\n\t\t\t\t\t\tthis.setSinglePluginResult(pluginArgs, {\n\t\t\t\t\t\t\tresult: result,\n\t\t\t\t\t\t\tignoreAspect: ignoreAspect\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tthis.module.ignoreAspect = ignoreAspect === undefined || ignoreAspect;\n\t\t\t\t\tthis._setDepModuleObjectGen(result);\n\t\t\t\t\trelyCallback(this);\n\t\t\t\t};\n\t\t\t\tlet onerror = (err) => {\n\t\t\t\t\thasFinished = true;\n\t\t\t\t\trelyCallback(this, new xsloader.PluginError(err || false));\n\t\t\t\t};\n\t\t\t\tlet args = [pluginArgs, onload, onerror, xsloader.config()].concat(this.module.depModules);\n\t\t\t\ttry {\n\t\t\t\t\tlet cacheResult;\n\t\t\t\t\tif(this._object.isSingle && (cacheResult = this.lastSinglePluginResult(pluginArgs)) !== undefined) {\n\t\t\t\t\t\tlet last = cacheResult;\n\t\t\t\t\t\tonload(last.result, last.ignoreAspect);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._object.pluginMain.apply(this.thiz, args);\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t\tonerror(e);\n\t\t\t\t}\n\t\t\t\tif(!hasFinished) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif(!hasFinished) {\n\t\t\t\t\t\t\tconsole.warn(\"invoke plugin may failed:page=\" + location.href + \",plugin=\" + module.name + \"!\" + pluginArgs);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, xsloader.config().waitSeconds * 1000);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trelyCallback(this);\n\t\t\t}\n\t\t},\n\n\t};\n\n\tlet moduleMap = {\n\t\tmodule: module,\n\t\tsrc: module.thiz.getAbsoluteUrl(),\n\t\tabsUrl: module.thiz.absUrl(),\n\t\tname: module.thiz.getName(),\n\t\tinvoker: instanceModule._invoker\n\t};\n\tinstanceModule.thiz = new script.Invoker(moduleMap);\n\n\tbuildInvoker(instanceModule);\n\treturn instanceModule;\n}\n\nfunction _newModule(name, absUrl, thatInvoker, callback) {\n\tlet defineObject = new script.DefineObject(name,null, null, false);\n\tdefineObject.src = null;\n\tdefineObject.deps = null;\n\tdefineObject.thatInvoker = thatInvoker;\n\tdefineObject.callback = callback;\n\tdefineObject.handle = {\n\t\tabsUrl: absUrl\n\t};\n\treturn newModule(defineObject);\n}\n\n//\n//模块依赖来源：(另见module.js:mayAddDeps,define.js:theRealDefine)\n//1、define里声明的\n//2、define或require里直接require('...')\n//3、config里配置的\n//4、手动通过handle.before或depBefore进行修改的\n/*\n *模块的名字来源：(另见define.js:onModuleLoaded)\n * 1、模块url地址:一定存在\n * 2、模块define时提供的：可选\n * 3、paths或depsPaths提供的：可选\n * 4、name!提供的：可选\n */\nfunction newModule(defineObject) {\n\n\tlet instances = []; //所有模块实例\n\tlet moduleMap = {\n\t\tid: utils.getAndIncIdCount(),\n\t\tname: defineObject.selfname || defineObject.src,\n\t\tdeps: defineObject.deps || [],\n\t\trelys: [],\n\t\totherModule: undefined,\n\t\tdirectDefineIndex: 0, //模块直接声明的依赖开始索引\n\t\tignoreAspect: false,\n\t\tdepModules: null,\n\t\tsrc: null, //绝对路径,可能等于当前页面路径\n\t\tabsUrl: defineObject.getMineAbsUrl(),\n\t\tcallback: defineObject.callback,\n\t\t_loadCallback: null,\n\t\tmoduleObject: undefined, //依赖模块对应的对象\n\t\tloopObject: undefined, //循环依赖对象\n\t\tinvoker: defineObject.thatInvoker,\n\t\tinstanceType: \"single\",\n\t\tsetInstanceType(instanceType) {\n\t\t\tthis.instanceType = instanceType;\n\t\t},\n\t\t_singlePluginResult: {},\n\t\tlastSinglePluginResult(id, pluginArgs) {\n\t\t\tif(this._singlePluginResult[id]) {\n\t\t\t\treturn this._singlePluginResult[id][pluginArgs];\n\t\t\t}\n\t\t},\n\t\tsetSinglePluginResult(willCache, id, pluginArgs, obj) {\n\t\t\tif(willCache) {\n\t\t\t\tif(!this._singlePluginResult[id]) {\n\t\t\t\t\tthis._singlePluginResult[id] = {};\n\t\t\t\t}\n\t\t\t\tthis._singlePluginResult[id][pluginArgs] = obj;\n\t\t\t} else {\n\t\t\t\tif(this._singlePluginResult[id]) {\n\t\t\t\t\tdelete this._singlePluginResult[id][pluginArgs];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfinish(args) {\n\t\t\tif(this.directDefineIndex != 0) {\n\t\t\t\tlet _directArgs = [];\n\t\t\t\tfor(let i = this.directDefineIndex; i < args.length; i++) {\n\t\t\t\t\t_directArgs.push(args[i]);\n\t\t\t\t}\n\t\t\t\targs = _directArgs;\n\t\t\t}\n\t\t\tthis.depModules = args;\n\t\t\tlet obj;\n\t\t\tif(xsloader.isFunction(this.callback)) {\n\t\t\t\ttry {\n\t\t\t\t\tscript.currentDefineModuleQueue.push(this);\n\t\t\t\t\tscript.obj = this.callback.apply(this.thiz, args);\n\t\t\t\t\tscript.currentDefineModuleQueue.pop();\n\t\t\t\t} catch(e) {\n\t\t\t\t\tscript.currentDefineModuleQueue.pop();\n\t\t\t\t\tconsole.error(\"error occured,invoker.url=\", this.invoker ? this.invoker.getUrl() : \"\");\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tthis.setState(\"error\", e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tobj = this.callback;\n\t\t\t\tif(this.moduleObject !== undefined) {\n\t\t\t\t\tconsole.log(\"ignore moudule named '\" + moduleMap.name + \"':\" + obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet isDefault = false;\n\t\t\tif(obj === undefined) {\n\t\t\t\tisDefault = true;\n\t\t\t\tobj = {\n\t\t\t\t\t__default: true\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(this.loopObject) {\n\t\t\t\tif(!xsloader.isObject(obj)) {\n\t\t\t\t\tthrow new Error(\"循环依赖的模块必须是对象：\" + this.name);\n\t\t\t\t}\n\t\t\t\tfor(let x in obj) {\n\t\t\t\t\tthis.loopObject[x] = obj[x];\n\t\t\t\t}\n\t\t\t\tobj = this.loopObject;\n\t\t\t}\n\t\t\t//this.moduleObject不为undefined，则使用了exports\n\t\t\tif(this.moduleObject === undefined ||\n\t\t\t\t!isDefault && obj !== undefined //如果使用了return、则优先使用\n\t\t\t) {\n\t\t\t\tthis.moduleObject = obj;\n\t\t\t}\n\t\t\tthis.setState(\"defined\");\n\t\t},\n\t\tstate: \"init\", //init,loading,loaded,defined,error,\n\t\terrinfo: null,\n\t\t_callback(fun) {\n\t\t\tlet thiz = this;\n\t\t\tlet _state = thiz.state;\n\t\t\tif(_state == 'defined' || thiz.loopObject) {\n\t\t\t\tlet theCallback = function() {\n\t\t\t\t\tif(fun) {\n\t\t\t\t\t\tlet depModule = newModuleInstance(thiz, fun.thatInvoker, fun.relyCallback, fun.pluginArgs);\n\t\t\t\t\t\tdepModule.init();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t//已经加载了模块，仍然需要判断为其另外设置的依赖模块是否已被加载\n\t\t\t\tlet deps = !thiz.loopObject && xsloader.config().getDeps(thiz.name);\n\t\t\t\t//console.log(this.name,\":\",deps);\n\t\t\t\t//deps=null;\n\t\t\t\tif(deps && deps.length > 0) {\n\t\t\t\t\txsloader.require(deps, function() {\n\t\t\t\t\t\ttheCallback();\n\t\t\t\t\t}).then({\n\t\t\t\t\t\tdefined_module_for_deps: thiz.name\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttheCallback();\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t} else if(_state == \"timeout\" || _state == \"error\") {\n\t\t\t\tif(fun) {\n\t\t\t\t\tfun.relyCallback(this, this.errinfo);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tsetState(_state, errinfo) {\n\t\t\tthis.state = _state;\n\t\t\tthis.errinfo = errinfo;\n\t\t\tif(!this._callback()) {\n\t\t\t\twhile(this.relys.length) {\n\t\t\t\t\tlet fun = this.relys.shift();\n\t\t\t\t\tthis._callback(fun);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tget() {\n\t\t\tif(this.otherModule) {\n\t\t\t\tthis.state = this.otherModule.state; //状态同步,保持与otherModule状态相同\n\t\t\t\treturn this.otherModule;\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * 依赖当前模块、表示依赖otherModule模块，当前模块为别名或引用。\n\t\t * @param {Object} otherModule\n\t\t */\n\t\ttoOtherModule(otherModule) {\n\t\t\tthis.otherModule = otherModule;\n\t\t\tthis.get(); //状态同步\n\t\t\tlet theRelys = this.relys;\n\t\t\tthis.relys = [];\n\t\t\twhile(theRelys.length) {\n\t\t\t\tlet fun = theRelys.shift();\n\t\t\t\totherModule.relyIt(fun.thatInvoker, fun.relyCallback, fun.pluginArgs);\n\t\t\t}\n\t\t},\n\t\twhenNeed(loadCallback) {\n\t\t\tif(this.relys.length || this.otherModule && this.otherModule.relys.length) {\n\t\t\t\tloadCallback(); //已经被依赖了\n\t\t\t} else {\n\t\t\t\tthis._loadCallback = loadCallback;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * \n\t\t * @param {Object} thatInvoker\n\t\t * @param {Object} callbackFun function(depModule,err)\n\t\t * @param {Object} pluginArgs\n\t\t */\n\t\trelyIt(thatInvoker, callbackFun, pluginArgs) {\n\t\t\tif(this.otherModule) {\n\t\t\t\tthis.get(); //状态同步\n\t\t\t\tthis.otherModule.relyIt(thatInvoker, callbackFun, pluginArgs); //传递给otherModule\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet fun = {\n\t\t\t\tthatInvoker: thatInvoker,\n\t\t\t\trelyCallback: callbackFun,\n\t\t\t\tpluginArgs: pluginArgs\n\t\t\t};\n\t\t\tif(this._callback(fun)) {\n\t\t\t\tthis.relys.push(fun);\n\t\t\t}\n\t\t\tif(this._loadCallback) { //将会加载此模块及其依赖的模块\n\t\t\t\tlet loadCallback = this._loadCallback;\n\t\t\t\tthis._loadCallback = null;\n\t\t\t\tloadCallback();\n\t\t\t}\n\t\t}\n\t};\n\tmoduleMap.thiz = new script.Invoker(moduleMap);\n\n\t//返回_module_\n\tmoduleMap.dealInstance = function(moduleInstance) {\n\t\tinstances.push(moduleInstance);\n\t\tlet _module_ = {\n\t\t\topId: null,\n\t\t\tsetToAll(name, value, opId) {\n\t\t\t\tif(opId !== undefined && opId == this.opId) {\n\t\t\t\t\treturn; //防止循环\n\t\t\t\t}\n\t\t\t\topId = opId || _getModuleId();\n\t\t\t\tthis.opId = opId;\n\n\t\t\t\tlet obj = {};\n\t\t\t\tif(xsloader.isString(name)) {\n\t\t\t\t\tobj[name] = value;\n\t\t\t\t} else if(xsloader.isObject(name)) {\n\t\t\t\t\tfor(let k in name) {\n\t\t\t\t\t\tobj[k] = name[k];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"unknown param:\" + name);\n\t\t\t\t}\n\n\t\t\t\tutils.each(instances, function(ins) {\n\t\t\t\t\tlet mobj = ins.moduleObject();\n\t\t\t\t\tfor(let k in obj) {\n\t\t\t\t\t\tmobj[k] = obj[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(mobj._modules_) {\n\t\t\t\t\t\tutils.each(mobj._modules_, function(_m_) {\n\t\t\t\t\t\t\t_m_.setToAll(name, value, opId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t};\n\n\t\treturn _module_;\n\t};\n\n\t//添加到前面\n\t//提供的参数deps为define里声明的\n\tmoduleMap.mayAddDeps = function(deps) {\n\t\tlet moduleDeps = this.deps;\n\t\tutils.each(moduleDeps, function(dep) {\n\t\t\tif(xsloader.indexInArray(deps, dep) < 0) {\n\t\t\t\tdeps.push(dep);\n\t\t\t}\n\t\t}, false, true);\n\t\tthis.deps = deps;\n\t\treturn deps;\n\t};\n\tmoduleMap.printOnNotDefined = function() {\n\t\tlet root = {\n\t\t\tnodes: []\n\t\t};\n\t\tthis._printOnNotDefined(root);\n\n\t\tlet leafs = [];\n\n\t\tfunction findLeaf(node) {\n\t\t\tif(node.nodes.length) {\n\t\t\t\tutils.each(node.nodes, function(item) {\n\t\t\t\t\tfindLeaf(item);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tleafs.push(node);\n\t\t\t}\n\t\t}\n\t\tfindLeaf(root);\n\n\t\tfunction genErrs(node, infos) {\n\t\t\tinfos.push(node.err);\n\t\t\tif(node.parent) {\n\t\t\t\tgenErrs(node.parent, infos);\n\t\t\t}\n\t\t}\n\t\tutils.each(leafs, function(leaf) {\n\t\t\tlet infos = [];\n\t\t\tgenErrs(leaf, infos);\n\t\t\tinfos = infos.reverse();\n\t\t\tconsole.error(\"load module error stack:my page=\" + location.href);\n\t\t\tfor(let i = 1; i < infos.length;) {\n\t\t\t\tlet as = [];\n\t\t\t\tas.push(\"\");\n\t\t\t\tfor(let k = 0; k < 3 && i < infos.length; k++) {\n\t\t\t\t\tas.push(infos[i++]);\n\t\t\t\t}\n\t\t\t\tconsole.info(as.join(\"--->\"));\n\t\t\t}\n\t\t\tlet errModule = leaf.module;\n\t\t\tif(leaf.module && leaf.module.state == \"defined\") {\n\t\t\t\terrModule = leaf.parent.module;\n\t\t\t}\n\t\t\tif(errModule) {\n\t\t\t\tlet as = [];\n\t\t\t\tfor(let i = 0; i < errModule.deps.length; i++) {\n\t\t\t\t\tlet dep = errModule.deps[i];\n\t\t\t\t\tlet index = dep.lastIndexOf(\"!\");\n\t\t\t\t\tif(index != -1) {\n\t\t\t\t\t\tdep = dep.substring(0, index);\n\t\t\t\t\t}\n\t\t\t\t\tlet depMod = theDefinedMap[dep];\n\t\t\t\t\tif(depMod) {\n\t\t\t\t\t\tas.push(dep + \":\" + depMod.state);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tas.push(dep + \":null\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.info(\"failed module '\" + errModule.name + \"' deps state infos [\" + as.join(\",\") + \"]\");\n\t\t\t}\n\t\t});\n\n\t};\n\tmoduleMap._printOnNotDefined = function(parentNode) {\n\t\tlet node = {\n\t\t\terr: \"[\" + this.name + \"].state=\" + this.state,\n\t\t\tmodule: this,\n\t\t\tparent: parentNode,\n\t\t\tnodes: []\n\t\t};\n\t\tparentNode.nodes.push(node);\n\t\tif(this.state == \"defined\") {\n\t\t\treturn;\n\t\t}\n\n\t\tutils.each(this.deps, function(dep) {\n\t\t\tlet indexPlguin = dep.indexOf(\"!\");\n\t\t\tif(indexPlguin > 0) {\n\t\t\t\tdep = dep.substring(0, indexPlguin);\n\t\t\t}\n\t\t\tlet mod = getModule(dep);\n\t\t\tif(mod && mod.state == \"defined\") {\n\t\t\t\tmod._printOnNotDefined(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//只打印一个错误栈\n\t\t\tif(mod) {\n\t\t\t\tmod._printOnNotDefined(node);\n\t\t\t} else {\n\t\t\t\tnode.nodes.push({\n\t\t\t\t\tparent: parentNode,\n\t\t\t\t\tnodes: [],\n\t\t\t\t\terr: \"[\" + dep + \"] has not module\"\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\tsetModule(moduleMap.name, moduleMap);\n\n\tbuildInvoker(moduleMap);\n\treturn moduleMap;\n}\n\nlet randModuleIndex = 0;\n\nfunction _getModuleId() {\n\treturn \"_xs_req_2019_\" + randModuleIndex++;\n}\n//处理嵌套依赖\nfunction _dealEmbedDeps(deps) {\n\tfor(let i = 0; i < deps.length; i++) {\n\t\tlet dep = deps[i];\n\t\tif(xsloader.isArray(dep)) {\n\t\t\t//内部的模块顺序加载\n\t\t\tlet modName = \"inner_order_\" + _getModuleId();\n\t\t\tlet isOrderDep = !(dep.length > 0 && dep[0] === false);\n\t\t\tif(dep.length > 0 && (dep[0] === false || dep[0] === true)) {\n\t\t\t\tdep = dep.slice(1);\n\t\t\t}\n\t\t\tinnerDepsMap[modName] = {\n\t\t\t\tdeps: dep,\n\t\t\t\torderDep: isOrderDep\n\t\t\t};\n\n\t\t\t//console.log(innerDepsMap[modName]);\n\t\t\tdeps[i] = INNER_DEPS_PLUGIN + \"!\" + modName;\n\t\t}\n\t}\n}\n\nfunction _getPluginParam(path) {\n\tlet pluginIndex = path.indexOf(\"!\");\n\tif(pluginIndex > 0) {\n\t\treturn path.substring(pluginIndex);\n\t} else {\n\t\treturn \"\";\n\t}\n}\n\n//everyOkCallback(depModules,module),errCallback(err,invoker)\nfunction everyRequired(defineObject, module, everyOkCallback, errCallback) {\n\tif(defineObject.isError) {\n\t\treturn;\n\t}\n\n\tlet config = xsloader.config();\n\tconst deps = module.deps;\n\n\tutils.replaceModulePrefix(config, deps); //前缀替换\n\t_dealEmbedDeps(deps); //处理嵌套依赖\n\n\tfor(let i = 0; i < deps.length; i++) {\n\t\t//console.log(module.name+(\"(\"+defineObject.handle.defined_module_for_deps+\")\"), \":\", deps);\n\t\tlet m = deps[i];\n\t\tlet jsFilePath = utils.isJsFile(m);\n\n\t\tif(module.thiz.rurl(defineObject)) { //替换相对路径为绝对路径\n\t\t\tif(jsFilePath && xsloader.startsWith(m, \".\")) {\n\t\t\t\tm = utils.getPathWithRelative(module.thiz.rurl(defineObject), jsFilePath.path) + _getPluginParam(m);\n\t\t\t\tdeps[i] = m;\n\t\t\t}\n\t\t}\n\t\tlet paths = utils.graphPath.tryAddEdge(defineObject.handle.defined_module_for_deps || module.name, m);\n\t\tif(paths.length > 0) {\n\t\t\tlet moduleLoop = getModule(m); //该模块必定已经被定义过\n\t\t\tmoduleLoop.loopObject = {};\n\t\t}\n\t}\n\n\tlet isError = false,\n\t\thasCallErr = false,\n\t\ttheExports;\n\tlet depCount = deps.length;\n\t//module.jsScriptCount = 0;\n\tlet depModules = new Array(depCount);\n\n\tlet invoker_the_module = module.thiz;\n\n\tfunction checkFinish(index, dep_name, depModule, syncHandle) {\n\t\tdepModules[index] = depModule;\n\n\t\tif( /*(depCount == 0 || depCount - module.jsScriptCount == 0)*/ depCount <= 0 && !isError) {\n\t\t\teveryOkCallback(depModules, module);\n\t\t} else if(isError) {\n\t\t\tmodule.setState('error', isError);\n\t\t\tif(!hasCallErr) {\n\t\t\t\thasCallErr = true;\n\t\t\t\terrCallback({\n\t\t\t\t\terr: isError,\n\t\t\t\t\tindex: index,\n\t\t\t\t\tdep_name: dep_name\n\t\t\t\t}, invoker_the_module);\n\t\t\t}\n\t\t}!isError && syncHandle && syncHandle();\n\t}\n\n\tutils.each(deps, function(dep, index, ary, syncHandle) {\n\t\tlet originDep = dep;\n\t\tlet pluginArgs = undefined;\n\t\tlet pluginIndex = dep.indexOf(\"!\");\n\t\tif(pluginIndex > 0) {\n\t\t\tpluginArgs = dep.substring(pluginIndex + 1);\n\t\t\tdep = dep.substring(0, pluginIndex);\n\t\t}\n\t\tlet relyItFun = function() {\n\t\t\tgetModule(dep).relyIt(invoker_the_module, function(depModule, err) {\n\n\t\t\t\tif(!err) {\n\t\t\t\t\tdepCount--;\n\t\t\t\t\tif(dep == \"exports\") {\n\t\t\t\t\t\tif(theExports) {\n\t\t\t\t\t\t\tmodule.moduleObject = theExports;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttheExports = module.moduleObject = depModule.genExports();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisError = err;\n\t\t\t\t}\n\t\t\t\tcheckFinish(index, originDep, depModule, syncHandle);\n\t\t\t}, pluginArgs);\n\t\t};\n\n\t\tif(!getModule(dep)) {\n\t\t\tlet isJsFile = utils.isJsFile(dep);\n\t\t\tdo {\n\n\t\t\t\tlet urls;\n\n\t\t\t\tif(!isJsFile && dep.indexOf(\"/\") < 0 && dep.indexOf(\":\") >= 0) {\n\t\t\t\t\tlet i1 = dep.indexOf(\":\");\n\t\t\t\t\tlet i2 = dep.indexOf(\":\", i1 + 1);\n\t\t\t\t\tlet i3 = i2 > 0 ? dep.indexOf(\":\", i2 + 1) : -1;\n\t\t\t\t\tif(i2 == -1) {\n\t\t\t\t\t\tisError = \"illegal module:\" + dep;\n\t\t\t\t\t\terrCallback(isError, invoker_the_module);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlet version;\n\t\t\t\t\tlet groupModule;\n\t\t\t\t\tif(i3 == -1) {\n\t\t\t\t\t\tversion = config.defaultVersion[dep];\n\t\t\t\t\t\tgroupModule = dep + \":\" + version;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tversion = dep.substring(i3 + 1);\n\t\t\t\t\t\tgroupModule = dep;\n\t\t\t\t\t}\n\t\t\t\t\tif(version === undefined) {\n\t\t\t\t\t\tisError = \"unknown version for:\" + dep;\n\t\t\t\t\t\terrCallback(isError, invoker_the_module);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlet _url = xsloader._resUrlBuilder(groupModule);\n\t\t\t\t\turls = xsloader.isArray(_url) ? _url : [_url];\n\t\t\t\t} else if(config.isInUrls(dep)) {\n\t\t\t\t\turls = config.getUrls(dep);\n\t\t\t\t} else if(isJsFile) {\n\t\t\t\t\turls = [dep];\n\t\t\t\t} else {\n\t\t\t\t\turls = [];\n\t\t\t\t}\n\n\t\t\t\tlet module2 = _newModule(dep, module.absUrl, module.thiz);\n\t\t\t\tmodule2.setState(\"loading\");\n\t\t\t\tutils.each(urls, function(url, index) {\n\t\t\t\t\tif(xsloader.startsWith(url, \".\") || xsloader.startsWith(url, \"/\")) {\n\t\t\t\t\t\tif(!module2.thiz.rurl(defineObject)) {\n\t\t\t\t\t\t\tisError = \"script url is null:'\" + module2.name;\n\t\t\t\t\t\t\tthrow new Error(isError);\n\t\t\t\t\t\t}\n\t\t\t\t\t\turl = utils.getPathWithRelative(module2.thiz.rurl(defineObject), url);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet absolute = utils.dealPathMayAbsolute(url);\n\t\t\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\t\t\turl = absolute.path;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\turl = config.baseUrl + url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\turls[index] = config.dealUrl(module2, url);\n\t\t\t\t});\n\n\t\t\t\tmayAsyncCallLoadModule();\n\n\t\t\t\tfunction mayAsyncCallLoadModule() {\n\t\t\t\t\t//\t\t\t\t\tif(IE_VERSION > 0 && IE_VERSION <= 10) {\n\t\t\t\t\t//\t\t\t\t\t\tasyncCall(function() {\n\t\t\t\t\t//\t\t\t\t\t\t\tloadModule();\n\t\t\t\t\t//\t\t\t\t\t\t});\n\t\t\t\t\t//\t\t\t\t\t} else {\n\t\t\t\t\t//\t\t\t\t\t\tloadModule();\n\t\t\t\t\t//\t\t\t\t\t}\n\t\t\t\t\tloadModule();\n\t\t\t\t}\n\n\t\t\t\t//加载模块dep:module2\n\t\t\t\tfunction loadModule(index = 0) {\n\t\t\t\t\tif(index >= urls.length) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet url = urls[index];\n\t\t\t\t\tmodule2.src = url;\n\t\t\t\t\tscript.loadScript(module2.name, url, (scriptData) => {\n\n\t\t\t\t\t}, (err) => {\n\t\t\t\t\t\tisError = err;\n\t\t\t\t\t\terrCallback(isError, invoker_the_module);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t} while (false);\n\t\t}\n\t\trelyItFun();\n\t}, defineObject.handle.orderDep);\n\t//TODO STRONG ie10及以下版本，js文件一个一个加载，从而解决缓存等造成的混乱问题\n}\n\nexport default {\n\tsetModule,\n\tnewModule,\n\tgetModule,\n\teveryRequired,\n\tINNER_DEPS_PLUGIN,\n\tinnerDepsMap,\n\tbuildInvoker,\n\tnewModuleInstance\n};","import utils from \"../util/index.js\";\nimport moduleScript from \"./module.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nconst defContextName = \"xsloader1.1.x\";\nconst DATA_ATTR_MODULE = 'data-xsloader-module';\nconst DATA_ATTR_CONTEXT = \"data-xsloader-context\";\nconst globalDefineQueue = []; //没有配置前的define\nconst hasNoSelfnameSrcMap = {}; //已经存在未定义selfname的define：src:boolean\n\nconst head = document.head || document.getElementsByTagName('head')[0];\nconst isOpera = typeof opera !== 'undefined' && opera.toString() === '[object Opera]';\nconst readyRegExp = navigator.platform === 'PLAYSTATION 3' ? /^complete$/ : /^(complete|loaded)$/;\nconst theLoaderScript = document.currentScript || utils.getScriptBySubname(\"xsloader.js\");\nconst theLoaderUrl = utils.getNodeAbsolutePath(theLoaderScript);\nconst thePageUrl = (function() {\n\tlet url = location.href;\n\turl = utils.removeQueryHash(url);\n\treturn url;\n})();\n\nconst currentDefineModuleQueue = []; //当前回调的模块\ncurrentDefineModuleQueue.peek = function() {\n\tif(this.length > 0) {\n\t\treturn this[this.length - 1];\n\t}\n};\n\nlet lastAppendHeadDom = theLoaderScript;\nlet useDefineQueue;\nlet theRealDefine;\nif(utils.safariVersion > 0 && utils.safariVersion <= 7) {\n\tuseDefineQueue = [];\n}\n/////////////////////////////\n\nclass Invoker {\n\tmoduleMap;\n\tconstructor(moduleMap) {\n\t\tthis.moduleMap = moduleMap;\n\t}\n\t/**\n\t * 获取绝对地址\n\t */\n\tgetAbsoluteUrl() {\n\t\treturn this.moduleMap.src;\n\t}\n\tgetName() {\n\t\treturn this.moduleMap.name;\n\t}\n\tinvoker() {\n\t\treturn this.moduleMap.invoker;\n\t}\n\tabsUrl() { //用于获取其他模块地址的参考路径\n\t\treturn this.moduleMap.absUrl;\n\t}\n}\n\nfunction getInvoker(thiz, nullNew) {\n\tif(thiz instanceof Invoker) {\n\t\treturn thiz;\n\t} else if(thiz instanceof DefineObject) {\n\t\treturn thiz.thatInvoker;\n\t} else if(nullNew) {\n\t\tlet moduleMap = {\n\t\t\tmodule: \"\",\n\t\t\tsrc: thePageUrl,\n\t\t\tabsUrl: thePageUrl,\n\t\t\tname: \"__root__\",\n\t\t\tinvoker: null\n\t\t};\n\t\tmoduleMap.thiz = new Invoker(moduleMap);\n\t\tmoduleScript.buildInvoker(moduleMap);\n\t\tmoduleMap.thiz.invoker = function() {\n\t\t\treturn this;\n\t\t};\n\t\treturn moduleMap.thiz;\n\t}\n}\n\nclass DefineObject {\n\tthiz;\n\targs;\n\tisRequire;\n\tsrc;\n\tparentDefine;\n\thandle;\n\tselfname;\n\tdeps;\n\tcallback;\n\tthatInvoker;\n\tconstructor(selfname, thiz, args, isRequire = false) {\n\t\tthis.selfname = selfname;\n\t\tthis.thiz = thiz;\n\t\tthis.args = args;\n\t\tthis.isRequire = isRequire;\n\t\tthis.parentDefine = currentDefineModuleQueue.peek();\n\t\tthis.handle = {\n\t\t\tonError(err) {},\n\t\t\tbefore(deps) {},\n\t\t\tdepBefore(index, dep, depDeps) {},\n\t\t\torderDep: false,\n\t\t\tabsoluteUrl: undefined, //弃用\n\t\t\tabsUrl: undefined,\n\t\t\tinstance: undefined,\n\t\t};\n\t\tthis.thatInvoker = getInvoker(thiz);\n\n\t\tif(!selfname && !isRequire && (this.parentDefine || this.thatInvoker) && args && (args.length == 0 || !xsloader.isString(args[0]))) {\n\t\t\tif(hasNoSelfnameSrcMap[this.src]) {\n\t\t\t\tthrow new Error(\"define:expected selfname\");\n\t\t\t} else {\n\t\t\t\thasNoSelfnameSrcMap[this.src] = true;\n\t\t\t}\n\t\t}\n\t}\n\tget absUrl() {\n\t\treturn this.getMineAbsUrl() || (this.thatInvoker ? this.thatInvoker.absUrl() : null);\n\t}\n\n\tgetMineAbsUrl() {\n\t\treturn this.handle.absUrl || this.handle.absoluteUrl;\n\t}\n}\n\n////////////////////////\n\n/**\n * 获取当前脚本，返回对象：\n * src:脚本绝对地址，不含参数\n * node:脚本dom对象\n * @param {Object} isRemoveQueryHash\n */\nfunction getCurrentScript(isRemoveQueryHash = true) {\n\tfunction _getCurrentScriptOrSrc() { //兼容获取正在运行的js\n\t\t//取得正在解析的script节点\n\t\tif(document.currentScript !== undefined) { //firefox 4+\n\t\t\tlet node = document.currentScript && document.currentScript.src && document.currentScript;\n\t\t\tif(node) {\n\t\t\t\treturn {\n\t\t\t\t\tnode,\n\t\t\t\t\tsrc: node.src\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tif(utils.IE_VERSION > 0 && utils.IE_VERSION <= 10) {\n\t\t\tlet nodes = document.getElementsByTagName(\"script\"); //只在head标签中寻找\n\t\t\tfor(let i = 0; i < nodes.length; i++) {\n\t\t\t\tlet node = nodes[i];\n\t\t\t\tif(node.readyState === \"interactive\") {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tsrc: node.src\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet stack;\n\t\ttry {\n\t\t\tlet a = undefined;\n\t\t\ta.b.c(); //强制报错,以便捕获e.stack\n\t\t} catch(e) { //safari的错误对象只有line,sourceId,sourceURL\n\t\t\tstack = e.stack || e.sourceURL || e.stacktrace || '';\n\t\t\tif(!stack && window.opera) {\n\t\t\t\t//opera 9没有e.stack,但有e.Backtrace,但不能直接取得,需要对e对象转字符串进行抽取\n\t\t\t\tstack = (String(e).match(/of linked script \\S+/g) || []).join(\" \");\n\t\t\t}\n\t\t}\n\t\tif(stack) {\n\t\t\t/**e.stack最后一行在所有支持的浏览器大致如下:\n\t\t\t *chrome23:\n\t\t\t * at http://113.93.50.63/data.js:4:1\n\t\t\t *firefox17:\n\t\t\t *@http://113.93.50.63/query.js:4\n\t\t\t *opera12:\n\t\t\t *@http://113.93.50.63/data.js:4\n\t\t\t *IE10:\n\t\t\t *  at Global code (http://113.93.50.63/data.js:4:1)\n\t\t\t */\n\t\t\tstack = stack.split(/[@ ]/g).pop(); //取得最后一行,最后一个空格或@之后的部分\n\t\t\tstack = stack[0] == \"(\" ? stack.slice(1, -1) : stack;\n\t\t\tlet s = stack.replace(/(:\\d+)?:\\d+$/i, \"\"); //去掉行号与或许存在的出错字符起始位置\n\t\t\treturn {\n\t\t\t\tsrc: s\n\t\t\t};\n\t\t}\n\t}\n\n\tlet rs = _getCurrentScriptOrSrc();\n\tif(rs) {\n\t\tif(!rs.node) {\n\t\t\tlet src = utils.removeQueryHash(rs.src);\n\t\t\tlet nodes = document.getElementsByTagName(\"script\"); //只在head标签中寻找\n\t\t\tfor(let i = 0; i < nodes.length; i++) {\n\t\t\t\tlet node = nodes[i];\n\t\t\t\tif(src == utils.removeQueryHash(node.src)) {\n\t\t\t\t\trs.node = node;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(rs.node) {\n\t\t\trs.src = utils.getNodeAbsolutePath(rs.node);\n\t\t}\n\t\tif(isRemoveQueryHash) {\n\t\t\trs.src = utils.removeQueryHash(rs.src);\n\t\t}\n\t}\n\treturn rs;\n\n}\n\nfunction __createNode() {\n\tlet node = document.createElement('script');\n\tnode.type = 'text/javascript';\n\tnode.charset = 'utf-8';\n\tnode.async = true;\n\treturn node;\n}\n\nfunction __removeListener(node, func, name, ieName) {\n\tif(node.detachEvent && !isOpera) {\n\t\tif(ieName) {\n\t\t\tnode.detachEvent(ieName, func);\n\t\t}\n\t} else {\n\t\tnode.removeEventListener(name, func, false);\n\t}\n}\n\n/**\n * callbackObj.onScriptLoad\n * callbackObj.onScriptError\n *\n */\nfunction __browserLoader(moduleName, url, callbackObj) {\n\tlet node = __createNode();\n\tnode.setAttribute(DATA_ATTR_MODULE, moduleName);\n\tnode.setAttribute(DATA_ATTR_CONTEXT, defContextName);\n\tif(node.attachEvent &&\n\t\t!(node.attachEvent.toString && node.attachEvent.toString().indexOf('[native code') < 0) &&\n\t\t!isOpera) {\n\t\tnode.attachEvent('onreadystatechange', callbackObj.onScriptLoad);\n\t} else {\n\t\tnode.addEventListener('load', callbackObj.onScriptLoad, true);\n\t\tlet errListen = function() {\n\t\t\t__removeListener(node, errListen, 'error');\n\t\t\tcallbackObj.onScriptError.apply(this, arguments);\n\t\t};\n\t\tcallbackObj.errListen = errListen;\n\t\tnode.addEventListener('error', errListen, true);\n\t}\n\tnode.src = url;\n\tappendHeadDom(node);\n}\n\nfunction __getScriptData(evt, callbackObj) {\n\tlet node = evt.currentTarget || evt.srcElement;\n\t__removeListener(node, callbackObj.onScriptLoad, 'load', 'onreadystatechange');\n\t__removeListener(node, callbackObj.errListen, 'error');\n\treturn {\n\t\tnode: node,\n\t\tname: node && node.getAttribute(DATA_ATTR_MODULE),\n\t\tsrc: node && utils.getNodeAbsolutePath(node)\n\t};\n}\n\nfunction appendHeadDom(dom) {\n\tif(!xsloader.isDOM(dom)) {\n\t\tthrow new Error(\"expected dom object,but provided:\" + dom);\n\t}\n\tlet nextDom = lastAppendHeadDom.nextSibling;\n\thead.insertBefore(dom, nextDom);\n\t//\t\t\thead.appendChild(dom);\n\tlastAppendHeadDom = dom;\n}\n\n/////////////////////////\n\nfunction loadScript(moduleName, url, onload, onerror) {\n\tlet callbackObj = {};\n\tcallbackObj.onScriptLoad = function(evt) {\n\t\tif(callbackObj.removed) {\n\t\t\treturn;\n\t\t}\n\t\tif(evt.type === 'load' || (readyRegExp.test((evt.currentTarget || evt.srcElement).readyState))) {\n\t\t\tcallbackObj.removed = true;\n\t\t\tlet scriptData = __getScriptData(evt, callbackObj);\n\t\t\tif(useDefineQueue) {\n\t\t\t\tutils.each(useDefineQueue, (defineObject) => {\n\t\t\t\t\tdefineObject.src = scriptData.src;\n\t\t\t\t});\n\t\t\t\ttheRealDefine([...useDefineQueue]);\n\t\t\t}\n\t\t\tonload(scriptData);\n\t\t}\n\t};\n\tcallbackObj.onScriptError = function(evt) {\n\t\tif(callbackObj.removed) {\n\t\t\treturn;\n\t\t}\n\t\tcallbackObj.removed = true;\n\t\tlet scriptData = __getScriptData(evt, callbackObj);\n\t\tonerror(scriptData);\n\t};\n\t__browserLoader(moduleName, url, callbackObj);\n}\n\nfunction doDefine(thiz, args, isRequire) {\n\n\tlet defineObject = new DefineObject(null, thiz, args, isRequire);\n\tif(!useDefineQueue) {\n\t\tdefineObject.src = getCurrentScript().src;\n\t\ttry { //防止执行其他脚本\n\t\t\tif(defineObject.src) {\n\t\t\t\tlet node = document.currentScript;\n\t\t\t\tif(node && node.getAttribute(\"src\") && node.getAttribute(DATA_ATTR_CONTEXT) != defContextName &&\n\t\t\t\t\tdefineObject.src != theLoaderUrl && defineObject.src != thePageUrl) {\n\t\t\t\t\tconsole.error(\"unknown js script module:\" + xsloader.xsJson2String(defineObject.src));\n\t\t\t\t\tconsole.error(node);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {\n\t\t\txsloader.config().error(e);\n\t\t}\n\n\t}\n\n\tlet handle = {\n\t\tthen(option) {\n\t\t\tdefineObject.handle = xsloader.extend(defineObject.handle, option);\n\t\t\treturn this;\n\t\t},\n\t\terror(onError) {\n\t\t\tdefineObject.handle.onError = onError;\n\t\t\treturn this;\n\t\t}\n\t};\n\n\txsloader.asyncCall(() => {\n\t\tif(useDefineQueue) {\n\t\t\tuseDefineQueue.push(defineObject);\n\t\t} else {\n\t\t\ttheRealDefine([defineObject]);\n\t\t}\n\t});\n\n\treturn handle;\n}\n\nfunction predefine() {\n\tlet args = [];\n\tfor(let i = 0; i < arguments.length; i++) {\n\t\targs.push(arguments[i]);\n\t}\n\treturn doDefine(this, args, false);\n}\n\nfunction prerequire(deps, callback) {\n\n\tif(!xsloader.config()) { //require必须是在config之后\n\t\tthrow new Error(\"not config\");\n\t}\n\tlet thatInvoker = getInvoker(this, true);\n\tif(arguments.length == 1 && xsloader.isString(deps)) { //获取已经加载的模块\n\t\tlet originDeps = deps;\n\t\tlet pluginArgs = undefined;\n\t\tlet pluginIndex = deps.indexOf(\"!\");\n\t\tif(pluginIndex > 0) {\n\t\t\tpluginArgs = deps.substring(pluginIndex + 1);\n\t\t\tdeps = deps.substring(0, pluginIndex);\n\t\t\tif(pluginArgs) {\n\t\t\t\tlet argArr = [pluginArgs];\n\t\t\t\tutils.replaceModulePrefix(xsloader.config(), argArr); //前缀替换\n\t\t\t\tpluginArgs = argArr[0];\n\t\t\t}\n\t\t}\n\t\tlet module = moduleScript.getModule(deps);\n\t\tif(!module) {\n\t\t\tdeps = thatInvoker.getUrl(deps, false);\n\t\t\tmodule = moduleScript.getModule(deps);\n\t\t}\n\t\tif(!module) {\n\t\t\tthrow new Error(\"the module '\" + originDeps + \"' is not load!\");\n\t\t} else if(module.state != \"defined\") {\n\t\t\tthrow new Error(\"the module '\" + originDeps + \"' is not defined:\" + module.state);\n\t\t}\n\t\tlet theMod;\n\t\tmoduleScript.newModuleInstance(module, thatInvoker, (depModule) => {\n\t\t\ttheMod = depModule.moduleObject();\n\t\t}, pluginArgs).init(true);\n\t\tif(theMod === undefined) {\n\t\t\tthrow Error(\"the module '\" + originDeps + \"' is not load!\");\n\t\t}\n\t\treturn theMod;\n\t}\n\n\tlet selfname = xsloader.randId(\"_require\");\n\tif(xsloader.isFunction(deps)) {\n\t\tcallback = deps;\n\t\tdeps = [];\n\t}\n\tutils.appendInnerDeps(deps, callback);\n\tlet timeid;\n\tlet handle = doDefine(this, [selfname, deps, function() {\n\t\tif(timeid !== undefined) {\n\t\t\tclearTimeout(timeid);\n\t\t}\n\t\tif(xsloader.isFunction(callback)) {\n\t\t\tcallback.apply(this, arguments);\n\t\t}\n\t}], true);\n\t//TODO handle.isError处理与抛出异常处理\n\tlet checkResultFun = function() {\n\t\tlet ifmodule = moduleScript.getModule(selfname);\n\t\tif((!ifmodule || ifmodule.state != 'defined') && !handle.isError) {\n\t\t\tlet module = ifmodule;\n\t\t\tif(module) {\n\t\t\t\tutils.each(module.deps, function(dep) {\n\t\t\t\t\tlet mod = moduleScript.getModule(dep);\n\t\t\t\t\tmod && mod.printOnNotDefined();\n\t\t\t\t});\n\t\t\t}\n\t\t\tconsole.error(\"require timeout:[\" + (deps ? deps.join(\",\") : \"\") + \"]\");\n\t\t}\n\t};\n\ttimeid = setTimeout(checkResultFun, xsloader.config().waitSeconds * 1000);\n\treturn handle;\n}\n\n//对于safari7-:在脚本加载事件中可获得正确的脚本地址\n\nconst initDefine = function(theDefine) {\n\ttheRealDefine = (defines) => {\n\t\tif(!xsloader.config()) { //还没有配置\n\t\t\tglobalDefineQueue.push(defines);\n\t\t} else {\n\t\t\ttheDefine(defines);\n\t\t}\n\t};\n\treturn {\n\t\tpredefine,\n\t\tprerequire,\n\t};\n};\n\nconst onConfigedCallback = function() {\n\twhile(globalDefineQueue.length) {\n\t\tlet defines = globalDefineQueue.shift();\n\t\ttheRealDefine(defines);\n\t}\n};\n\nexport default {\n\tdefContextName,\n\ttheLoaderScript,\n\ttheLoaderUrl,\n\tthePageUrl,\n\tappendHeadDom,\n\tinitDefine,\n\tInvoker,\n\tDefineObject,\n\tloadScript,\n\tcurrentDefineModuleQueue,\n\tonConfigedCallback\n};","import loader from './loader.js';\nimport \"../public/index.js\";\nimport utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nimport script from \"./script.js\";\nimport moduleScript from \"./module.js\";\n\nlet theContext;\nlet theConfig;\nlet argsObject = {};\n\nxsloader.config = function() {\n\treturn theConfig;\n};\nxsloader.script = function() {\n\treturn script.theLoaderScript;\n};\nxsloader.scriptSrc = function() {\n\treturn script.theLoaderUrl;\n};\n\nxsloader.putUrlArgs = function(argsObj) {\n\targsObject = xsloader.extend(argsObject, argsObj);\n};\n\nxsloader.getUrlArgs = function() {\n\tlet obj = xsloader.extend({}, argsObject);\n\treturn obj;\n};\n\nxsloader.clearUrlArgs = function() {\n\targsObject = {};\n};\n\nxsloader.hasDefine = function(name) {\n\tlet has = false;\n\tlet module = moduleScript.getModule(name);\n\tif(!module || module.state == \"init\") {\n\n\t} else {\n\t\thas = true;\n\t}\n\treturn has;\n};\n\n//用于把\"group:project:version\"转换成url地址,返回一个String或包含多个url地址的数组\nxsloader._resUrlBuilder = function(groupName) {\n\tthrow new Error('resUrlBuilder not found!');\n};\n\nxsloader.clear_module_ = function() {\n\tlet modules = arguments;\n\tfor(let i = 0; i < modules.length; i++) {\n\t\tif(modules[i]) {\n\t\t\tdelete modules[i]._module_;\n\t\t\tdelete modules[i]._modules_;\n\t\t}\n\t}\n};\n\nfunction _newContext() {\n\tlet context = {\n\t\tcontextName: script.contextName,\n\t\tdefQueue: []\n\t};\n\treturn context;\n}\n\nloader.loaderFun((option) => {\n\tif(theContext) {\n\t\tthrow new Error(\"already configed!\");\n\t}\n\toption = xsloader.extend({\n\t\tbaseUrl: utils.getPathWithRelative(location.pathname, \"./\", xsloader.endsWith(location.pathname, \"/\")),\n\t\turlArgs: {},\n\t\tignoreProperties: false,\n\t\tpaths: {},\n\t\tdepsPaths: {},\n\t\tdeps: {},\n\t\tjsExts: undefined,\n\t\tproperties: {},\n\t\tmodulePrefix: {},\n\t\tdefineFunction: {},\n\t\tmodulePrefixCount: 0,\n\t\twaitSeconds: 10,\n\t\tautoUrlArgs() {\n\t\t\treturn false;\n\t\t},\n\t\tinstance: \"single\",\n\t\tdealtDeps: {},\n\t\tdealProperties(obj) {\n\t\t\treturn utils.propertiesDeal(obj, option.properties);\n\t\t},\n\t\tisInUrls(m) {\n\t\t\treturn !!this.getUrls(m);\n\t\t},\n\t\tgetUrls(m) {\n\t\t\treturn this.paths[m] || this.depsPaths[m];\n\t\t},\n\t\tgetDeps(m) {\n\t\t\tlet as = this.dealtDeps[m] || [];\n\t\t\tlet deps = [];\n\t\t\tlet hasOrderDep = undefined;\n\n\t\t\tif(as.length > 0 && (as[0] === true || as[0] === false)) {\n\t\t\t\tif(as[0]) {\n\t\t\t\t\tdeps = [\n\t\t\t\t\t\t[]\n\t\t\t\t\t];\n\t\t\t\t\thasOrderDep = true;\n\t\t\t\t} else {\n\t\t\t\t\tas.splice(0, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(let i = 0; i < as.length; i++) {\n\t\t\t\tif(hasOrderDep === true) {\n\t\t\t\t\tdeps[0].push(as[i]);\n\t\t\t\t} else {\n\t\t\t\t\tdeps.push(as[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn deps;\n\t\t},\n\t\tdealUrl(module, url) {\n\t\t\tlet urlArg;\n\t\t\tlet nameOrUrl;\n\t\t\tif(this.autoUrlArgs()) {\n\t\t\t\turlArg = \"_t=\" + new Date().getTime();\n\t\t\t} else if(xsloader.isString(module)) {\n\t\t\t\turlArg = this.urlArgs[module];\n\t\t\t\tif(urlArg) {\n\t\t\t\t\tnameOrUrl = module;\n\t\t\t\t} else {\n\t\t\t\t\tnameOrUrl = module;\n\t\t\t\t\turlArg = this.forPrefixSuffix(module);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = \"*\";\n\t\t\t\t\turlArg = this.urlArgs[\"*\"];\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\turlArg = this.urlArgs[url];\n\t\t\t\tif(urlArg) {\n\t\t\t\t\tnameOrUrl = url;\n\t\t\t\t} else {\n\t\t\t\t\turlArg = this.forPrefixSuffix(url);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = module.name;\n\t\t\t\t\turlArg = this.urlArgs[nameOrUrl];\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = module.aurl;\n\t\t\t\t\turlArg = this.forPrefixSuffix(nameOrUrl);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = \"*\";\n\t\t\t\t\turlArg = this.urlArgs[\"*\"];\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif(xsloader.isFunction(urlArg)) {\n\t\t\t\turlArg = urlArg.call(this, nameOrUrl);\n\t\t\t}\n\t\t\tfor(let k in argsObject) { //加入全局的参数\n\t\t\t\turlArg += \"&\" + k + \"=\" + encodeURIComponent(argsObject[k]);\n\t\t\t}\n\t\t\treturn xsloader.appendArgs2Url(url, urlArg);\n\t\t},\n\t\tdealUrlArgs(url) {\n\t\t\turl = utils.getPathWithRelative(location.href, url);\n\t\t\treturn this.dealUrl(url, url);\n\t\t},\n\t\tdefaultVersion: {}\n\t}, option);\n\n\tif(!xsloader.endsWith(option.baseUrl, \"/\")) {\n\t\toption.baseUrl += \"/\";\n\t}\n\toption.baseUrl = utils.getPathWithRelative(location.href, option.baseUrl);\n\n\tif(!option.ignoreProperties) {\n\t\toption = option.dealProperties(option);\n\t}\n\n\tutils.strValue2Arr(option.paths);\n\tutils.strValue2Arr(option.depsPaths);\n\tutils.strValue2Arr(option.deps);\n\n\tif(!xsloader.isFunction(option.autoUrlArgs)) {\n\t\tlet isAutoUrlArgs = option.autoUrlArgs;\n\t\toption.autoUrlArgs = function() {\n\t\t\treturn isAutoUrlArgs;\n\t\t};\n\t}\n\n\tlet modulePrefixCount = 0;\n\tfor(let prefix in option.modulePrefix) {\n\t\tif(xsloader.startsWith(prefix, \".\") || xsloader.startsWith(prefix, \"/\")) {\n\t\t\tthrow new Error(\"modulePrefix can not start with '.' or '/'(\" + prefix + \")\");\n\t\t}\n\t\tmodulePrefixCount++;\n\t}\n\toption.modulePrefixCount = modulePrefixCount;\n\tif(modulePrefixCount > 0) {\n\t\t//替换urlArgs中地址前缀\n\t\tlet star = option.urlArgs[\"*\"];\n\t\tdelete option.urlArgs[\"*\"];\n\n\t\tlet urlArgsArr = [];\n\t\tfor(let k in option.urlArgs) {\n\t\t\tlet url = k;\n\t\t\tif(utils.isJsFile(url)) { //处理相对\n\t\t\t\tif(xsloader.startsWith(url, \".\") || xsloader.startsWith(url, \"/\") && !xsloader.startsWith(url, \"//\")) {\n\t\t\t\t\turl = utils.getPathWithRelative(script.theLoaderUrl, url);\n\t\t\t\t} else {\n\t\t\t\t\tlet absolute = utils.dealPathMayAbsolute(url);\n\t\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\t\turl = absolute.path;\n\t\t\t\t\t} else if(!xsloader.startsWith(url, \"*]\")) { //排除*]；单*[可以有前缀\n\t\t\t\t\t\turl = option.baseUrl + url;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\turlArgsArr.push({\n\t\t\t\turl: url,\n\t\t\t\targs: option.urlArgs[k]\n\t\t\t});\n\t\t}\n\n\t\tfor(let prefix in option.modulePrefix) {\n\t\t\tlet replaceStr = option.modulePrefix[prefix].replace;\n\t\t\tfor(let i = 0; i < urlArgsArr.length; i++) {\n\t\t\t\tlet urlArgObj = urlArgsArr[i];\n\t\t\t\tlet starP = \"\";\n\t\t\t\tif(xsloader.startsWith(urlArgObj.url, \"*[\")) {\n\t\t\t\t\tstarP = \"*[\";\n\t\t\t\t\turlArgObj.url = urlArgObj.url.substring(2);\n\t\t\t\t}\n\t\t\t\tif(xsloader.startsWith(urlArgObj.url, prefix)) {\n\t\t\t\t\turlArgObj.url = replaceStr + urlArgObj.url.substring(prefix.length);\n\t\t\t\t}\n\t\t\t\tstarP && (urlArgObj.url = starP + urlArgObj.url);\n\t\t\t}\n\t\t}\n\t\toption.urlArgs = {};\n\t\toption.urlArgs[\"*\"] = star;\n\t\tfor(let i = 0; i < urlArgsArr.length; i++) {\n\t\t\tlet urlArgObj = urlArgsArr[i];\n\t\t\toption.urlArgs[urlArgObj.url] = urlArgObj.args;\n\t\t}\n\t}\n\n\t//预处理urlArgs中的*[与*]\n\tlet _urlArgs_prefix = [];\n\tlet _urlArgs_suffix = [];\n\toption._urlArgs_prefix = _urlArgs_prefix;\n\toption._urlArgs_suffix = _urlArgs_suffix;\n\n\tfor(let k in option.urlArgs) {\n\t\tlet url = k;\n\t\tif(xsloader.startsWith(url, \"*[\")) {\n\t\t\tlet strfix = url.substring(2);\n\t\t\tif(xsloader.startsWith(strfix, \".\") || xsloader.startsWith(strfix, \"/\") && !xsloader.startsWith(strfix, \"//\")) {\n\t\t\t\tstrfix = utils.getPathWithRelative(script.theLoaderUrl, strfix);\n\t\t\t} else {\n\t\t\t\tlet absolute = utils.dealPathMayAbsolute(strfix);\n\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\tstrfix = absolute.path;\n\t\t\t\t} else {\n\t\t\t\t\turl = option.baseUrl + url;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_urlArgs_prefix.push({\n\t\t\t\tstrfix: strfix,\n\t\t\t\tvalue: option.urlArgs[k]\n\t\t\t});\n\t\t\tdelete option.urlArgs[k];\n\t\t} else if(xsloader.startsWith(url, \"*]\")) {\n\t\t\t_urlArgs_suffix.push({\n\t\t\t\tstrfix: url.substring(2),\n\t\t\t\tvalue: option.urlArgs[k]\n\t\t\t});\n\t\t\tdelete option.urlArgs[k];\n\t\t}\n\t}\n\n\toption.forPrefixSuffix = function(urlOrName) {\n\t\t//前缀判断\n\t\tfor(let i = 0; i < _urlArgs_prefix.length; i++) {\n\t\t\tlet strfixObj = _urlArgs_prefix[i];\n\t\t\tif(xsloader.startsWith(urlOrName, strfixObj.strfix)) {\n\t\t\t\tlet value;\n\t\t\t\tif(xsloader.isFunction(strfixObj.value)) {\n\t\t\t\t\tvalue = strfixObj.value.call(this, urlOrName);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = strfixObj.value;\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\n\t\t//后缀判断\n\t\tfor(let i = 0; i < _urlArgs_suffix.length; i++) {\n\t\t\tlet strfixObj = _urlArgs_suffix[i];\n\t\t\tif(xsloader.endsWith(urlOrName, strfixObj.strfix)) {\n\t\t\t\tlet value;\n\t\t\t\tif(xsloader.isFunction(strfixObj.value)) {\n\t\t\t\t\tvalue = strfixObj.value.call(this, urlOrName);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = strfixObj.value;\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t};\n\n\tfor(let name in option.paths) {\n\t\tutils.replaceModulePrefix(option, option.paths[name]); //前缀替换\n\t}\n\tfor(let name in option.depsPaths) {\n\t\tutils.replaceModulePrefix(option, option.depsPaths[name]); //前缀替换\n\t}\n\n\t//处理依赖\n\tlet dealtDeps = option.dealtDeps;\n\n\tlet pushDeps = (dealtDepArray, depsArray) => {\n\t\tutils.each(depsArray, (dep) => {\n\t\t\tdealtDepArray.push(dep);\n\t\t});\n\t};\n\n\tfor(let keyName in option.deps) {\n\t\tlet paths = keyName.split('::');\n\t\tlet depsArray = option.deps[keyName];\n\t\tutils.each(paths, (path) => {\n\t\t\tif(path == '*') {\n\t\t\t\tfor(let m in option.depsPaths) {\n\t\t\t\t\tlet dealtDepArray = dealtDeps[m] = dealtDeps[m] || [];\n\t\t\t\t\tpushDeps(dealtDepArray, depsArray);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet dealtDepArray = (dealtDeps[path] = dealtDeps[path] || []);\n\t\t\t\tpushDeps(dealtDepArray, depsArray);\n\t\t\t}\n\t\t});\n\t}\n\n\ttheConfig = option;\n\ttheContext = _newContext();\n\tscript.onConfigedCallback(); //完成配置回调\n\treturn theConfig;\n});","import utils from \"./util/index.js\";\nimport script from \"./core/script.js\";\nimport moduleScript from \"./core/module.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nconst defineHandle = script.initDefine(function theRealDefine(defines) {\n\tutils.each(defines, (defineObject) => {\n\t\tlet selfname = defineObject.args[0];\n\t\tlet deps = defineObject.args[1];\n\t\tlet callback = defineObject.args[2];\n\n\t\tif(typeof selfname !== 'string') {\n\t\t\tcallback = deps;\n\t\t\tdeps = selfname;\n\t\t\tselfname = defineObject.src;\n\t\t}\n\n\t\tif(!xsloader.isArray(deps)) {\n\t\t\tcallback = deps;\n\t\t\tdeps = null;\n\t\t}\n\n\t\tif(!deps) {\n\t\t\tdeps = [];\n\t\t}\n\n\t\t//获取函数体里直接require('...')的依赖\n\t\t//if(!isRequire) {\n\t\tutils.appendInnerDeps(deps, callback);\n\t\t//}\n\t\t//获取配置里配置的依赖\n\t\tlet _deps = xsloader.config().getDeps(defineObject.src);\n\t\tutils.each(_deps, (dep) => {\n\t\t\tdeps.push(dep);\n\t\t});\n\t\tif(selfname && selfname != defineObject.src) {\n\t\t\t_deps = xsloader.config().getDeps(selfname);\n\t\t\tutils.each(_deps, (dep) => {\n\t\t\t\tdeps.push(dep);\n\t\t\t});\n\t\t}\n\n\t\tif(xsloader.isFunction(callback)) {\n\t\t\tlet originCallback = callback;\n\t\t\tcallback = function() {\n\t\t\t\tlet config = xsloader.config();\n\t\t\t\tlet rt;\n\n\t\t\t\tlet defineFun;\n\t\t\t\tutils.each(defineObject.names, (name) => {\n\t\t\t\t\tlet fun = config.defineFunction[name];\n\t\t\t\t\tif(xsloader.isFunction(fun)) {\n\t\t\t\t\t\tdefineFun = fun;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(defineFun) {\n\t\t\t\t\tlet args = [];\n\t\t\t\t\tfor(let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\targs.push(arguments[i]);\n\t\t\t\t\t}\n\t\t\t\t\trt = defineFun.apply(this, [originCallback, this, args]);\n\t\t\t\t} else {\n\t\t\t\t\trt = originCallback.apply(this, arguments);\n\t\t\t\t}\n\n\t\t\t\toriginCallback = null;\n\t\t\t\treturn rt;\n\t\t\t};\n\t\t\tcallback.originCallback = originCallback;\n\t\t}\n\t\tdefineObject.selfname = selfname;\n\t\tdefineObject.deps = deps;\n\t\tdefineObject.callback = callback;\n\t\tonModuleLoaded(defineObject);\n\n\t});\n});\n\n/**\n * 当前模块脚本已经完成加载、但其依赖的模块可能需要加载。\n * 当前模块：src、selfname已经确定。\n * 若当前模块依赖为0、则可以直接finish；若当前模块存在其他依赖、则设置回调，等待被其他地方依赖时再触发。\n * @param {Object} defineObject 当前模块\n * @param {Object} lastDefineObject 第一次加载当前模块的模块\n */\nfunction onModuleLoaded(defineObject, lastDefineObject) {\n\n\t//先根据src获取模块\n\tlet ifmodule = moduleScript.getModule(defineObject.src);\n\tif(ifmodule) {\n\t\tif(ifmodule.state != 'loading' && ifmodule.state != 'init') {\n\t\t\t//正常\n\t\t} else if(ifmodule.state == \"defined\") {\n\t\t\tthrow new Error(\"already define '\" + ifmodule.selfname + \"'(src=\" + ifmodule.src + \")\");\n\t\t} else {\n\t\t\tthrow new Error(\"already define failed '\" + ifmodule.selfname + \"'(src=\" + ifmodule.src + \")\");\n\t\t}\n\n\t} else {\n\t\tifmodule = moduleScript.newModule(defineObject);\n\t}\n\n\tlet names = [ifmodule.src];\n\n\tif(ifmodule.selfname != ifmodule.src) {\n\t\t//此处的名字可能由配置指定\n\t\tlet moduleSelf = moduleScript.getModule(ifmodule.selfname);\n\t\tif(moduleSelf) { //让配置的名字也最终指向src的\n\t\t\tif(moduleSelf != ifmodule) {\n\t\t\t\tif(moduleSelf.state == \"init\") {\n\t\t\t\t\tmoduleScript.setModule(ifmodule.selfname, module);\n\t\t\t\t\tmoduleSelf.toOtherModule(module);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(\"already define '\" + ifmodule.selfname + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmoduleScript.setModule(ifmodule.selfname, module);\n\t\t}\n\t\tnames.push(ifmodule.selfname);\n\t}\n\n\tif(defineObject.selfname != defineObject.src && defineObject.selfname != ifmodule.selfname) {\n\t\t//此处的名字一定是define时指定\n\t\tlet moduleSelf = moduleScript.getModule(defineObject.selfname);\n\t\tif(moduleSelf) { //让define的名字也最终指向src的\n\t\t\tif(moduleSelf != ifmodule) {\n\t\t\t\tif(moduleSelf.state == \"init\") {\n\t\t\t\t\tmoduleScript.setModule(ifmodule.selfname, module);\n\t\t\t\t\tmoduleSelf.toOtherModule(module);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(\"already define '\" + ifmodule.selfname + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmoduleScript.setModule(ifmodule.selfname, module);\n\t\t}\n\t\tnames.push(defineObject.selfname);\n\t}\n\tdefineObject.names = names; //一个模块的所有名字，包括src\n\n\tlet module = ifmodule;\n\t//defineObject里的deps最初是直接声明的依赖,应该出现在最前面\n\tmodule.mayAddDeps(defineObject.deps);\n\n\tif(defineObject.handle.before) {\n\t\tdefineObject.handle.before(module.deps);\n\t}\n\tif(lastDefineObject && lastDefineObject.handle.depBefore) {\n\t\tlastDefineObject.handle.depBefore(lastDefineObject.index, module.name, module.deps, 2);\n\t}\n\n\tif(xsloader._ignoreAspect_[module.name]) {\n\t\tmodule.ignoreAspect = true;\n\t}\n\n\tmodule.setState(\"loaded\");\n\tmodule.setInstanceType(defineObject.handle.instance || xsloader.config().instance);\n\n\tif(module.deps.length == 0) {\n\t\tmodule.finish([]); //递归结束\n\t} else {\n\t\t//在其他模块依赖此模块时进行加载\n\t\tlet needCallback = function() {\n\t\t\tmoduleScript.everyRequired(defineObject, module, (depModules) => {\n\t\t\t\tlet args = [];\n\t\t\t\tlet depModuleArgs = [];\n\t\t\t\tutils.each(depModules, (depModule) => {\n\t\t\t\t\tdepModuleArgs.push(depModule);\n\t\t\t\t\targs.push(depModule && depModule.moduleObject());\n\t\t\t\t});\n\t\t\t\targs.push(depModuleArgs);\n\t\t\t\tmodule.finish(args);\n\t\t\t}, (err, invoker) => {\n\t\t\t\tdefineObject.handle.onError(err, invoker);\n\t\t\t});\n\t\t};\n\n\t\tif(defineObject.isRequire) {\n\t\t\tneedCallback();\n\t\t} else {\n\t\t\tmodule.whenNeed(needCallback);\n\t\t}\n\t}\n\n}\n\n//定义模块\nconst define = function() {\n\treturn defineHandle.predefine.apply(this, arguments);\n};\n\nconst require = function() {\n\treturn defineHandle.prerequire.apply(this, arguments);\n};\n\nxsloader.define = define;\nxsloader.defineAsync = define;\nxsloader.require = require;\nglobal.define = define;\nglobal.require = require;\n\ndefine.amd = true;\ndefine(\"exports\", function() {});","import moduleScript from \"../module.js\";\nimport utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n//内部依赖加载插件\n\nxsloader.define(moduleScript.INNER_DEPS_PLUGIN, {\n\tpluginMain(depId, onload, onerror, config) {\n\t\tlet depsObj = moduleScript.innerDepsMap[depId];\n\t\tlet deps = depsObj.deps;\n\t\t//delete innerDepsMap[depId];\n\t\tthis.invoker().require(deps, function() {\n\t\t\tlet args = [];\n\t\t\tfor(let k = 0; k < arguments.length; k++) {\n\t\t\t\targs.push(arguments[k]);\n\t\t\t}\n\t\t\tonload(args);\n\t\t}).then({\n\t\t\torderDep: depsObj.orderDep\n\t\t});\n\t},\n\tgetCacheKey(depId) {\n\t\treturn depId;\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nxsloader.define(\"ready\", {\n\tpluginMain(depId, onload, onerror, config) {\n\t\txsloader.onReady(function() {\n\t\t\tonload();\n\t\t});\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nxsloader.define(\"nodeps\", {\n\tisSingle: true,\n\tpluginMain(arg, onload, onerror, config) {\n\t\tthis.invoker().require([arg], function(mod, depModuleArgs) {\n\t\t\tonload(mod);\n\t\t}).then({\n\t\t\tdepBefore(index, dep, depDeps) {\n\t\t\t\tdepDeps.splice(0, depDeps.length);\n\t\t\t}\n\t\t}).error(function(e) {\n\t\t\tonerror(e);\n\t\t});\n\t}\n});","import moduleScript from \"../module.js\";\nimport utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nxsloader.define(\"exists\", {\n\tisSingle: true,\n\tpluginMain(arg, onload, onerror, config) {\n\t\tlet vars = arg.split(\"|\");\n\t\tfor(let i = 0; i < vars.length; i++) {\n\t\t\tvars[i] = vars[i].trim();\n\t\t}\n\t\tif(vars.length == 0) {\n\t\t\tonerror(\"args error for exists!\");\n\t\t} else {\n\t\t\tlet moduleName = vars[0];\n\t\t\tlet module = moduleScript.getModule(moduleName);\n\t\t\tif(module) {\n\t\t\t\tthis.invoker().require([moduleName], function(mod, depModuleArgs) {\n\t\t\t\t\tonload(mod);\n\t\t\t\t}).error(function(e) {\n\t\t\t\t\tonerror(e);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet obj = undefined;\n\t\t\t\tfor(let i = 1; i < vars.length; i++) {\n\t\t\t\t\tif(window[vars[i]]) {\n\t\t\t\t\t\tobj = window[vars[i]];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(obj === undefined) {\n\t\t\t\t\tonerror(\"not found:\" + arg);\n\t\t\t\t} else {\n\t\t\t\t\tonload(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});","import moduleScript from \"../module.js\";\nimport utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n/**\n * 格式:name!moduleName=>>modulePath\n */\n\nxsloader.define(\"name\", {\n\tisSingle: true,\n\tpluginMain(arg, onload, onerror, config) {\n\t\tlet index = arg.indexOf(\"=>>\");\n\t\tif(index == -1) {\n\t\t\tonerror(\"expected:=>>\");\n\t\t\treturn;\n\t\t}\n\t\tlet moduleName = arg.substring(0, index);\n\t\tmoduleName = moduleName.replace(/，/g, ',');\n\t\tlet names = moduleName.split(\",\");\n\t\tlet dep = arg.substring(index + 3);\n\t\tthis.invoker().require([dep], function(mod, depModuleArgs) {\n\t\t\tlet existsMods = [];\n\t\t\tfor(let i = 0; i < names.length; i++) {\n\t\t\t\tlet newName = names[i];\n\t\t\t\tlet lastM = moduleScript.getModule(newName);\n\t\t\t\tif(lastM && lastM.state != \"init\") {\n\t\t\t\t\texistsMods.push(newName);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(lastM) {\n\t\t\t\t\tlastM.toOtherModule(depModuleArgs[0].module);\n\t\t\t\t} else {\n\t\t\t\t\tmoduleScript.setModule(newName, depModuleArgs[0].module);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(existsMods.length) {\n\t\t\t\tconsole.warn(\"already exists:\", existsMods.join(','));\n\t\t\t}\n\t\t\tonload(mod);\n\t\t}).error(function(e) {\n\t\t\tonerror(e);\n\t\t});\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n/*\n * Require-CSS RequireJS css! loader plugin\n * 0.1.8\n * Guy Bedford 2014\n * MIT\n */\nxsloader.define(\"css\", function() {\n\tif(typeof window == 'undefined')\n\t\treturn {\n\t\t\tload: function(n, r, load) {\n\t\t\t\tload();\n\t\t\t}\n\t\t};\n\tlet engine = window.navigator.userAgent.match(/Trident\\/([^ ;]*)|AppleWebKit\\/([^ ;]*)|Opera\\/([^ ;]*)|rv\\:([^ ;]*)(.*?)Gecko\\/([^ ;]*)|MSIE\\s([^ ;]*)|AndroidWebKit\\/([^ ;]*)/) || 0;\n\tlet useImportLoad = false;\n\tlet useOnload = true;\n\tif(engine[1] || engine[7])\n\t\tuseImportLoad = parseInt(engine[1]) < 6 || parseInt(engine[7]) <= 9;\n\telse if(engine[2] || engine[8] || 'WebkitAppearance' in document.documentElement.style)\n\t\tuseOnload = false;\n\telse if(engine[4])\n\t\tuseImportLoad = parseInt(engine[4]) < 18;\n\tlet cssAPI = {};\n\tlet curStyle, curSheet;\n\tlet createStyle = function() {\n\t\tcurStyle = document.createElement('style');\n\t\txsloader.appendHeadDom(curStyle);\n\t\tcurSheet = curStyle.styleSheet || curStyle.sheet;\n\t};\n\tlet ieCnt = 0;\n\tlet ieLoads = [];\n\tlet ieCurCallback;\n\tlet createIeLoad = function(url) {\n\t\tcurSheet.addImport(url);\n\t\tcurStyle.onload = function() {\n\t\t\tprocessIeLoad();\n\t\t};\n\n\t\tieCnt++;\n\t\tif(ieCnt == 31) {\n\t\t\tcreateStyle();\n\t\t\tieCnt = 0;\n\t\t}\n\t};\n\tlet processIeLoad = function() {\n\t\tieCurCallback();\n\t\tlet nextLoad = ieLoads.shift();\n\t\tif(!nextLoad) {\n\t\t\tieCurCallback = null;\n\t\t\treturn;\n\t\t}\n\t\tieCurCallback = nextLoad[1];\n\t\tcreateIeLoad(nextLoad[0]);\n\t};\n\tlet importLoad = function(url, callback) {\n\t\tcallback = callback || function() {};\n\t\tif(!curSheet || !curSheet.addImport)\n\t\t\tcreateStyle();\n\n\t\tif(curSheet && curSheet.addImport) {\n\t\t\tif(ieCurCallback) {\n\t\t\t\tieLoads.push([url, callback]);\n\t\t\t} else {\n\t\t\t\tcreateIeLoad(url);\n\t\t\t\tieCurCallback = callback;\n\t\t\t}\n\t\t} else {\n\t\t\tcurStyle.textContent = '@import \"' + url + '\";';\n\t\t\tlet loadInterval = setInterval(function() {\n\t\t\t\ttry {\n\t\t\t\t\tcurStyle.sheet.cssRules;\n\t\t\t\t\tclearInterval(loadInterval);\n\t\t\t\t\tcallback();\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t};\n\tlet linkLoad = function(url, callback) {\n\t\tcallback = callback || function() {};\n\t\tlet link = document.createElement('link');\n\t\tlink.type = 'text/css';\n\t\tlink.rel = 'stylesheet';\n\t\tif(useOnload)\n\t\t\tlink.onload = function() {\n\t\t\t\tlink.onload = function() {};\n\t\t\t\tsetTimeout(callback, 7);\n\t\t\t};\n\t\telse {\n\t\t\tlet loadInterval = setInterval(function() {\n\t\t\t\tfor(let i = 0; i < document.styleSheets.length; i++) {\n\t\t\t\t\tlet sheet = document.styleSheets[i];\n\t\t\t\t\tif(sheet.href == link.href) {\n\t\t\t\t\t\tclearInterval(loadInterval);\n\t\t\t\t\t\treturn callback();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t}\n\t\tlink.href = url;\n\t\txsloader.appendHeadDom(link);\n\t};\n\tcssAPI.pluginMain = function(cssId, onload, onerror, config) {\n\t\t//\t\t\tif(cssId.indexOf(\".css\") != cssId.length - 4) {\n\t\t//\t\t\t\tcssId += \".css\";\n\t\t//\t\t\t}\n\t\t(useImportLoad ? importLoad : linkLoad)(this.invoker().getUrl(cssId, true), onload);\n\t};\n\tcssAPI.getCacheKey = function(cssId) {\n\t\t//\t\t\tif(cssId.indexOf(\".css\") != cssId.length - 4) {\n\t\t//\t\t\t\tcssId += \".css\";\n\t\t//\t\t\t}\n\t\tlet invoker = this.invoker();\n\t\treturn invoker ? invoker.getUrl(cssId, true) : cssId;\n\t};\n\tcssAPI.loadCss = function(cssPath, callback) {\n\t\t(useImportLoad ? importLoad : linkLoad)(xsloader.getUrl(cssPath), callback);\n\t};\n\n\tcssAPI.loadCsses = function() {\n\t\tlet args = arguments;\n\t\tfor(let i = 0; i < args.length; i++) {\n\t\t\t(useImportLoad ? importLoad : linkLoad)(xsloader.getUrl(args[i]), null);\n\t\t}\n\t};\n\treturn cssAPI;\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nxsloader.define(\"text\", [\"xshttp\"], {\n\tisSingle: true,\n\tpluginMain(name, onload, onerror, config, http) {\n\t\tlet url = this.invoker().getUrl(name, true);\n\t\thttp().url(url)\n\t\t\t.handleAs(\"text\")\n\t\t\t.ok(function(text) {\n\t\t\t\tonload(text);\n\t\t\t})\n\t\t\t.fail(function(err) {\n\t\t\t\tonerror(err);\n\t\t\t})\n\t\t\t.done();\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n/**\n * 格式：window!varNameInWindow=>>modulePath\n */\n//window插件,用于添加模块到window对象中\nxsloader.define(\"window\", {\n\tisSingle: true,\n\tpluginMain: function(arg, onload, onerror, config, http) {\n\t\tlet index = arg.indexOf(\"=>>\");\n\t\tif(index == -1) {\n\t\t\tonerror(\"expected:=>>\");\n\t\t\treturn;\n\t\t}\n\t\tlet moduleName = arg.substring(0, index);\n\t\tlet dep = arg.substring(index + 3);\n\t\tthis.invoker().require([dep], function(mod, depModuleArgs) {\n\t\t\twindow[moduleName] = mod;\n\t\t\tonload(mod);\n\t\t});\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n/**\n * 格式:withdeps!modulePath=>>[deps]\n */\nxsloader.define(\"withdeps\", {\n\tpluginMain(arg, onload, onerror, config) {\n\t\tlet index = arg.indexOf(\"=>>\");\n\t\tif(index == -1) {\n\t\t\tonerror(\"expected:=>>\");\n\t\t\treturn;\n\t\t}\n\t\tlet moduleName = arg.substring(0, index);\n\t\tlet depsStr = arg.substring(index + 3);\n\t\tlet deps;\n\t\ttry {\n\t\t\tdeps = xsloader.xsParseJson(depsStr);\n\t\t\tif(!xsloader.isArray(deps)) {\n\t\t\t\tonerror(\"deps is not Array:\" + depsStr);\n\t\t\t\treturn;\n\t\t\t}\n\t\t} catch(e) {\n\t\t\tonerror(\"deps error:\" + depsStr);\n\t\t\treturn;\n\t\t}\n\t\tthis.invoker().require([\n\t\t\t[false].concat(deps), moduleName\n\t\t], function(_deps, mod, depModuleArgs) {\n\t\t\tonload(mod);\n\t\t}).then({\n\t\t\torderDep: true\n\t\t});\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n/**\n * 加载json对象\n */\nxsloader.define(\"json\", [\"xshttp\"], {\n\tisSingle: true,\n\tpluginMain(name, onload, onerror, config, http) {\n\t\tlet url = this.invoker().getUrl(name, true);\n\t\thttp().url(url)\n\t\t\t.handleAs(\"json\")\n\t\t\t.ok(function(json) {\n\t\t\t\tonload(json);\n\t\t\t})\n\t\t\t.fail(function(err) {\n\t\t\t\tonerror(err);\n\t\t\t})\n\t\t\t.done();\n\t}\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nlet progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];\n/**\n * option._beforeOpenHook\n * option._onOkResponseHook\n * option._onFailResponseHook\n * \n * @param {Object} option\n */\nfunction httpRequest(option) {\n\tif(!option) {\n\t\toption = {};\n\t}\n\n\tfunction prop(obj, varName, defaultVal) {\n\t\tif(obj[varName] === undefined) {\n\t\t\treturn defaultVal;\n\t\t} else {\n\t\t\treturn obj[varName];\n\t\t}\n\t}\n\n\tfunction putProp(obj, varName, toObj) {\n\t\tif(obj[varName]) {\n\t\t\tfor(let x in obj[varName]) {\n\t\t\t\tlet value = obj[varName][x];\n\t\t\t\tif(value === null || value === undefined) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ttoObj[x] = value;\n\t\t\t}\n\t\t}\n\t}\n\tlet _url = prop(option, \"url\", \"\"),\n\t\t_method = prop(option, \"method\", \"GET\"),\n\t\t_params = {},\n\t\t_headers = {\n\t\t\t\"X-Requested-With\": \"XMLHttpRequest\"\n\t\t},\n\t\t_async = prop(option, \"async\", true),\n\t\t_multiPart = prop(option, \"multiPart\", false),\n\t\t_handleType = prop(option, \"handleType\", \"json\");\n\tlet _timeout = option.timeout;\n\tputProp(option, \"params\", _params);\n\tputProp(option, \"headers\", _headers);\n\n\tlet okCallback = option.ok;\n\tlet failCallback = option.fail;\n\tlet uploadStartCallback = option.uploadStart;\n\tlet uploadProgressCallback = option.uploadProgress;\n\tlet uploadOkCallback = option.uploadOk;\n\tlet uploadErrorCallback = option.uploadError;\n\tlet uploadEndCallback = option.uploadEnd;\n\n\tlet _beforeOpenHook = option._beforeOpenHook || httpRequest._beforeOpenHook;\n\tlet _onOkResponseHook = option._onOkResponseHook || httpRequest._onOkResponseHook;\n\tlet _onFailResponseHook = option._onFailResponseHook || httpRequest._onFailResponseHook;\n\n\tfunction createXhr() {\n\t\tlet xhr, i, progId;\n\t\tif(typeof XMLHttpRequest !== \"undefined\") {\n\t\t\treturn new XMLHttpRequest();\n\t\t} else if(typeof ActiveXObject !== \"undefined\") {\n\t\t\tfor(i = 0; i < 3; i += 1) {\n\t\t\t\tprogId = progIds[i];\n\t\t\t\ttry {\n\t\t\t\t\txhr = new ActiveXObject(progId);\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t}\n\n\t\t\t\tif(xhr) {\n\t\t\t\t\tprogIds = [progId];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn xhr;\n\t}\n\n\tfunction conn() {\n\t\t_conn(createXhr());\n\t}\n\n\tfunction _conn(xhr) {\n\t\tlet option = {\n\t\t\turl: _url,\n\t\t\tmethod: _method.toUpperCase(),\n\t\t\tparams: _params,\n\t\t\theaders: _headers,\n\t\t\thandleType: _handleType,\n\t\t\tasync: _async,\n\t\t\tmultiPart: _multiPart,\n\t\t\ttimeout: _timeout\n\t\t};\n\t\t_beforeOpenHook(option, function() {\n\t\t\t_connAfterOpenHook(option, xhr);\n\t\t}, xhr);\n\t}\n\n\tfunction _doOnFailResponseHook(option, xhr, err, extraErr) {\n\t\t_onFailResponseHook(option, function(result) {\n\t\t\tif(result !== false && result !== undefined) {\n\t\t\t\tif(typeof okCallback == \"function\") {\n\t\t\t\t\tokCallback(result, xhr);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else if(typeof failCallback == \"function\") {\n\t\t\t\tfailCallback(err);\n\t\t\t} else {\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t}, xhr, extraErr);\n\t}\n\n\tfunction _connAfterOpenHook(option, xhr) {\n\t\tlet body;\n\t\tif(option.multiPart) {\n\t\t\tlet formData = new FormData();\n\t\t\tfor(let x in option.params) {\n\t\t\t\tlet value = option.params[x];\n\t\t\t\tif(xsloader.isArray(value)) {\n\t\t\t\t\tformData.append(x, xsloader.xsJson2String(value));\n\t\t\t\t} else {\n\t\t\t\t\tformData.append(x, value);\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tbody = formData;\n\t\t} else {\n\t\t\tbody = \"\";\n\t\t\tfor(let x in option.params) {\n\t\t\t\tlet value = option.params[x];\n\t\t\t\tif(value === null || value === undefined) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(typeof value == \"object\") {\n\t\t\t\t\tvalue = xsloader.xsJson2String(value);\n\t\t\t\t}\n\t\t\t\tbody += \"&\" + encodeURIComponent(x) + \"=\" + encodeURIComponent(value);\n\t\t\t}\n\t\t\tif(!(option.method == \"POST\" || option.method == \"PUT\")) {\n\t\t\t\tif(option.url.lastIndexOf(\"?\") < 0 && body.length > 0) {\n\t\t\t\t\toption.url += \"?\";\n\t\t\t\t}\n\t\t\t\toption.url += body;\n\t\t\t\toption.url = option.url.replace(\"?&\", \"?\");\n\t\t\t\tbody = null;\n\t\t\t}\n\t\t}\n\n\t\txhr.open(option.method, option.url, option.async);\n\t\tif((option.method == \"POST\" || option.method == \"PUT\") && !option.multiPart && !option.headers.hasOwnProperty(\"Content-Type\")) {\n\n\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n\t\t}\n\t\tfor(let header in option.headers) {\n\t\t\txhr.setRequestHeader(header, option.headers[header]);\n\t\t}\n\n\t\tif(typeof uploadStartCallback == \"function\") {\n\t\t\txhr.upload.onloadstart = uploadStartCallback;\n\t\t}\n\n\t\tif(typeof uploadProgressCallback == \"function\") {\n\t\t\txhr.upload.onprogress = uploadProgressCallback;\n\t\t}\n\n\t\tif(typeof uploadOkCallback == \"function\") {\n\t\t\txhr.upload.onload = uploadOkCallback;\n\t\t}\n\n\t\tif(typeof uploadErrorCallback == \"function\") {\n\t\t\txhr.upload.onerror = uploadErrorCallback;\n\t\t}\n\n\t\tif(typeof uploadEndCallback == \"function\") {\n\t\t\txhr.upload.onloadend = uploadEndCallback;\n\t\t}\n\n\t\tlet timeoutTimer;\n\t\tlet isTimeout = false;\n\t\tif(option.timeout) {\n\t\t\ttimeoutTimer = setTimeout(function() {\n\t\t\t\tisTimeout = true;\n\t\t\t\txhr.abort();\n\t\t\t\tclearTimeout(timeoutTimer);\n\t\t\t}, option.timeout);\n\t\t}\n\n\t\txhr.onreadystatechange = function(evt) {\n\t\t\tlet status, err;\n\t\t\tif(xhr.readyState === 4) {\n\t\t\t\tstatus = xhr.status || 0;\n\t\t\t\tif(status > 399 && status < 600 || !status) {\n\t\t\t\t\tlet err = new Error(option.url + ' HTTP status: ' + status);\n\t\t\t\t\terr.xhr = xhr;\n\t\t\t\t\t_doOnFailResponseHook(option, xhr, err);\n\t\t\t\t} else {\n\t\t\t\t\tlet result;\n\t\t\t\t\tif(option.handleType === \"json\") {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresult = xsloader.xsParseJson(xhr.responseText);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t_doOnFailResponseHook(option, xhr, new Error(\"parse-json-error:\" + e), \"parse-json-error\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(option.handleType === \"text\") {\n\t\t\t\t\t\tresult = xhr.responseText;\n\t\t\t\t\t}\n\t\t\t\t\t_onOkResponseHook(result, option, function(result) {\n\t\t\t\t\t\tif(typeof okCallback == \"function\") {\n\t\t\t\t\t\t\tokCallback(result, xhr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, xhr);\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tif(timeoutTimer && isTimeout) {\n\t\t\t\t\tlet err = new Error(option.url + ' timeout status: ' + status);\n\t\t\t\t\terr.xhr = xhr;\n\t\t\t\t\t_doOnFailResponseHook(option, xhr, err);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\txhr.send(body);\n\t}\n\n\tlet requestObj = {\n\t\tmultiPart(multiPart) {\n\t\t\t_multiPart = multiPart;\n\t\t\treturn this;\n\t\t},\n\t\tuploadStart(uploadStart) {\n\t\t\tuploadStartCallback = uploadStart;\n\t\t\treturn this;\n\t\t},\n\t\tuploadProgress(uploadProgress) {\n\t\t\tuploadProgressCallback = uploadProgress;\n\t\t\treturn this;\n\t\t},\n\t\tuploadOk(callback) {\n\t\t\tuploadOkCallback = callback;\n\t\t\treturn this;\n\t\t},\n\t\tuploadError(callback) {\n\t\t\tuploadErrorCallback = callback;\n\t\t\treturn this;\n\t\t},\n\t\tuploadEnd(uploadEnd) {\n\t\t\tuploadEndCallback = uploadEnd;\n\t\t\treturn this;\n\t\t},\n\t\turl(urlStr) {\n\t\t\t_url = urlStr;\n\t\t\treturn this;\n\t\t},\n\t\tmethod(methodStr) {\n\t\t\t_method = methodStr;\n\t\t\treturn this;\n\t\t},\n\t\ttimeout(timeout) {\n\t\t\t_timeout = timeout;\n\t\t\treturn this;\n\t\t},\n\t\tasync(isAsync) {\n\t\t\t_async = isAsync;\n\t\t\treturn this;\n\t\t},\n\t\tparams(paramsObj) {\n\t\t\tif(paramsObj) {\n\t\t\t\tfor(let x in paramsObj) {\n\t\t\t\t\tlet value = paramsObj[x];\n\t\t\t\t\tif(value === null || value === undefined) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t_params[x] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\theaders(headersObj) {\n\t\t\tif(headersObj) {\n\t\t\t\tfor(let x in headersObj) {\n\t\t\t\t\t_headers[x] = headersObj[x];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\thandleType(_handleType) {\n\t\t\treturn this.handleAs(_handleType);\n\t\t},\n\t\thandleAs(handleType) {\n\t\t\tif(handleType !== \"json\" && handleType !== \"text\") {\n\t\t\t\tthrow \"unknown handleType:\" + handleType;\n\t\t\t}\n\t\t\t_handleType = handleType;\n\t\t\treturn this;\n\t\t},\n\t\tok(callback) {\n\t\t\tokCallback = callback;\n\t\t\treturn this;\n\t\t},\n\t\tfail(callback) {\n\t\t\tfailCallback = callback;\n\t\t\treturn this;\n\t\t},\n\t\t_beforeOpenHook(callback) {\n\t\t\t_beforeOpenHook = callback;\n\t\t\treturn this;\n\t\t},\n\t\t_onOkResponseHook(callback) {\n\t\t\t_onOkResponseHook = callback;\n\t\t\treturn this;\n\t\t},\n\t\t_onFailResponseHook(callback) {\n\t\t\t_onFailResponseHook = callback;\n\t\t\treturn this;\n\t\t},\n\t\tdone() {\n\t\t\ttry {\n\t\t\t\tconn();\n\t\t\t} catch(e) {\n\t\t\t\tif(typeof failCallback == \"function\") {\n\t\t\t\t\tfailCallback(e);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\treturn requestObj;\n}\n/**\n */\nhttpRequest._beforeOpenHook = function(option, callback, xhr) {\n\tcallback();\n};\n\n/**\n * function(result,option,xhr,callback),callback(result)的result为最终的结果\n */\nhttpRequest._onOkResponseHook = function(result, option, callback, xhr) {\n\tcallback(result);\n};\n/**\n * function(option,xhr,callback,extraErrorType),callback(result)的result为false则不会处理后面的,如果为非undefined则作为成功的结果。\n * extraErrorType==\"parse-json-error\"表示转换成json时出错\n */\nhttpRequest._onFailResponseHook = function(option, callback, xhr, extraErrorType) {\n\tcallback(undefined);\n};\n\nwindow._xshttp_request_ = httpRequest;\n\nxsloader.define(\"xshttp\", [], function() {\n\treturn httpRequest;\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nxsloader.define(\"xsrequest\", [\"xshttp\"], function(http) {\n\t/**\n\t * 参数列表:\n\t * callback:function(rs)\n\t * async:始终为true\n\t * 其他参数同xshttp\n\t * 不断返回then(function()).then,当返回false时取消调用后面的回调。\n\t * @param {Object} option\n\t */\n\tlet xsRequest = function(option) {\n\t\toption = xsloader.extend({\n\t\t\tparams: undefined,\n\t\t\theaders: undefined,\n\t\t\tmethod: undefined,\n\t\t\turl: undefined,\n\t\t\tcallback: undefined\n\t\t}, option);\n\t\tlet isResponsed = false;\n\t\tlet callbacksQueue = [function(rs) {\n\t\t\treturn rs;\n\t\t}];\n\t\tif(option.callback) {\n\t\t\tcallbacksQueue.push(option.callback);\n\t\t}\n\t\tcallbacksQueue.callback = function(rs) {\n\t\t\tisResponsed = true;\n\t\t\tfor(let i = 0; i < this.length; i++) {\n\t\t\t\tlet callback = this[i];\n\t\t\t\trs = callback(rs);\n\t\t\t\tif(rs === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\toption.ok = function(rs) {\n\t\t\tcallbacksQueue.callback(rs);\n\t\t};\n\t\toption.fail = function(err) {\n\t\t\tcallbacksQueue.callback({\n\t\t\t\tcode: -1,\n\t\t\t\tdesc: err\n\t\t\t});\n\t\t};\n\t\toption.async = true;\n\n\t\tfunction newHandle() {\n\t\t\tlet handle = {\n\t\t\t\tthen: function(callback) {\n\t\t\t\t\tif(isResponsed) {\n\t\t\t\t\t\tthrow new Error(\"already responsed!\");\n\t\t\t\t\t}\n\t\t\t\t\tcallbacksQueue.push(callback);\n\t\t\t\t\treturn newHandle();\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn handle;\n\t\t}\n\t\thttp(option).done();\n\t\treturn newHandle();\n\t};\n\n\treturn xsRequest;\n});","import utils from \"../../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\ntry {\n\tlet isXsMsgDebug = false;\n\tlet api = {};\n\n\tfunction isDebug(type) {\n\t\treturn isXsMsgDebug;\n\t}\n\n\tapi.linkedList = function() {\n\t\treturn new LinkedList();\n\t};\n\n\tfunction LinkedList() {\n\t\tfunction newNode(element) {\n\t\t\tlet node = {\n\t\t\t\telement: element,\n\t\t\t\tnext: null,\n\t\t\t\tpre: null\n\t\t\t};\n\t\t\treturn node;\n\t\t}\n\t\tlet length = 0;\n\t\tlet headNode = newNode(),\n\t\t\tlastNode = headNode;\n\n\t\t/**\n\t\t * 在链表末尾添加元素\n\t\t */\n\t\tthis.append = function(element) {\n\t\t\tlet current = newNode(element);\n\n\t\t\tlastNode.next = current;\n\t\t\tcurrent.pre = lastNode;\n\t\t\tlastNode = current;\n\t\t\tlength++;\n\t\t};\n\n\t\t//在链表的任意位置插入元素\n\t\tthis.insert = function(position, element) {\n\t\t\tif(position >= 0 && position <= length) {\n\n\t\t\t\tlet node = newNode(element);\n\t\t\t\tlet pNode = headNode;\n\t\t\t\twhile(position--) {\n\t\t\t\t\tpNode = pNode.next;\n\t\t\t\t}\n\n\t\t\t\tif(pNode.next) {\n\t\t\t\t\tpNode.next.pre = node;\n\t\t\t\t\tnode.next = pNode.next;\n\t\t\t\t}\n\t\t\t\tpNode.next = node;\n\t\t\t\tnode.pre = pNode;\n\t\t\t\tlength++;\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\tthis.elementAt = function(position) {\n\t\t\treturn getElement(position);\n\t\t};\n\n\t\tfunction getElement(position, willRemove) {\n\t\t\tif(position >= 0 && position < length) {\n\n\t\t\t\tlet pNode = headNode;\n\t\t\t\twhile(position--) {\n\t\t\t\t\tpNode = pNode.next;\n\t\t\t\t}\n\n\t\t\t\tif(pNode.next) {\n\t\t\t\t\tlet currentNode = pNode.next;\n\t\t\t\t\tif(willRemove) {\n\t\t\t\t\t\tlet nextCurrentNode = currentNode.next;\n\t\t\t\t\t\tif(nextCurrentNode) {\n\t\t\t\t\t\t\tnextCurrentNode.pre = pNode;\n\t\t\t\t\t\t\tpNode.next = nextCurrentNode;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpNode.next = null;\n\t\t\t\t\t\t\tlastNode = pNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlength--;\n\t\t\t\t\t}\n\t\t\t\t\treturn currentNode.element;\n\t\t\t\t} else {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @param callback function 返回true表示移除\n\t\t */\n\t\tthis.eachForRemove = function(callback) {\n\t\t\tlet pNode = headNode.next;\n\t\t\twhile(pNode) {\n\t\t\t\tlet currentNode = pNode;\n\t\t\t\tif(callback(currentNode)) {\n\t\t\t\t\tlet nextCurrentNode = currentNode.next;\n\t\t\t\t\tif(nextCurrentNode) {\n\t\t\t\t\t\tnextCurrentNode.pre = pNode;\n\t\t\t\t\t\tpNode.next = nextCurrentNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpNode.next = null;\n\t\t\t\t\t\tlastNode = pNode;\n\t\t\t\t\t}\n\t\t\t\t\tlength--;\n\t\t\t\t\tpNode = nextCurrentNode;\n\t\t\t\t} else {\n\t\t\t\t\tpNode = pNode.next;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//从链表中移除元素\n\t\tthis.removeAt = function(position) {\n\t\t\treturn getElement(position, true);\n\t\t};\n\n\t\t/**\n\t\t * 移除并获取第一个元素\n\t\t * @param callback function(elem,index)\n\t\t */\n\t\tthis.pop = function(callback) {\n\t\t\treturn this.removeAt(0);\n\t\t};\n\n\t\t/**\n\t\t * 返回元素在链表中的位置\n\t\t * @param element object|function(elem)\n\t\t */\n\t\tthis.indexOf = function(element) {\n\t\t\tlet pNode = headNode.next;\n\t\t\tlet index = 0;\n\t\t\twhile(pNode) {\n\t\t\t\tif(typeof element == \"function\") {\n\t\t\t\t\tif(element(pNode.element)) {\n\t\t\t\t\t\treturn index;\n\t\t\t\t\t}\n\t\t\t\t} else if(pNode.element === element) {\n\t\t\t\t\treturn index;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tpNode = pNode.next;\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\n\t\tthis.find = function(element) {\n\t\t\tlet index = this.indexOf(element);\n\t\t\treturn index >= 0 ? this.elementAt(index) : undefined;\n\t\t};\n\n\t\t//移除某个元素\n\t\tthis.remove = function(element) {\n\t\t\tlet index = this.indexOf(element);\n\t\t\treturn this.removeAt(index);\n\t\t};\n\n\t\t//判断链表是否为空\n\n\t\tthis.isEmpty = function() {\n\t\t\treturn length === 0;\n\t\t};\n\n\t\t//返回链表的长度\n\t\tthis.size = function() {\n\t\t\treturn length;\n\t\t};\n\n\t}\n\n\tif(window.addEventListener) {\n\t\tlet postMessageBridge = (function() {\n\t\t\tlet handle = {};\n\n\t\t\tlet instanceMap = {}; //id:listener\n\t\t\tlet cmd2ListenerMap = {}; //cmd:[]\n\t\t\tlet instanceBindMap = {}; //instanceid:true\n\t\t\tlet oinstanceidMap = {}; //已经被绑定的oinstanceid:instanceid\n\n\t\t\t//isActive为false表示监听者\n\t\t\thandle.listen = function(cmd, conndata, connectingSource, source, isActive, _onConned, _onMsg, _onResponse, _onElse) {\n\n\t\t\t\tlet listener = {\n\t\t\t\t\tcmd: cmd,\n\t\t\t\t\t_onConned: _onConned,\n\t\t\t\t\t_onMsg: _onMsg,\n\t\t\t\t\t_onResponse: _onResponse,\n\t\t\t\t\t_onElse: _onElse,\n\t\t\t\t\tconndata: conndata,\n\t\t\t\t\tosource: source,\n\t\t\t\t\tactive: isActive,\n\t\t\t\t\tconnectingSource: connectingSource,\n\t\t\t\t\tid: xsloader.randId(),\n\t\t\t\t\trefused: {}\n\t\t\t\t};\n\n\t\t\t\tif(!cmd2ListenerMap[cmd]) {\n\t\t\t\t\tcmd2ListenerMap[cmd] = [];\n\t\t\t\t}\n\t\t\t\tcmd2ListenerMap[cmd].push(listener);\n\n\t\t\t\tlet instanceid = listener.id;\n\t\t\t\tinstanceMap[instanceid] = listener;\n\t\t\t\treturn instanceid;\n\t\t\t};\n\n\t\t\thandle.remove = function(instanceid) {\n\t\t\t\t//TODO !!!!!!!\n\t\t\t\t/*let listener = listeners[id];\n\t\t\t\tdelete listeners[id];\n\t\t\t\tif(listener.active) {\n\t\t\t\t\tfor(let x in activeListenerMyIds) {\n\t\t\t\t\t\tlet as = activeListenerMyIds[x];\n\t\t\t\t\t\tlet found = false;\n\t\t\t\t\t\tfor(let k = 0; k < as.length; k++) {\n\t\t\t\t\t\t\tif(as[k] == id) {\n\t\t\t\t\t\t\t\tas.splice(k, 1);\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(found) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}*/\n\t\t\t};\n\n\t\t\thandle.send = function(data, instanceid, msgid) {\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t_sendData(\"msg\", listener.cmd, listener.osource, data, instanceid, msgid);\n\t\t\t};\n\n\t\t\thandle.sendConn = function(instanceid) {\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t_sendData(\"conn\", listener.cmd, listener.osource, listener.conndata, instanceid);\n\t\t\t};\n\n\t\t\thandle.sendResponse = function(data, instanceid) {\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t_sendData(\"response\", listener.cmd, listener.osource, data, instanceid);\n\t\t\t};\n\n\t\t\tfunction handleConn(cmd, fromSource, originStr, data, oinstanceid) {\n\t\t\t\tif(oinstanceidMap[oinstanceid]) {\n\t\t\t\t\t//console.warn(\"already bind:\" + cmd);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet listeners = cmd2ListenerMap[cmd];\n\t\t\t\tif(!listeners) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction Callback(instanceid) {\n\n\t\t\t\t\treturn function(isAccept, msg) {\n\t\t\t\t\t\tif(!isAccept) {\n\t\t\t\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t\t\t\tlistener.refused[oinstanceid] = true;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(oinstanceidMap[oinstanceid]) {\n\t\t\t\t\t\t\tconsole.warn(\"already bind other:\" + cmd + \",my page:\" + location.href);\n\t\t\t\t\t\t} else if(instanceBindMap[instanceid]) {\n\t\t\t\t\t\t\tconsole.warn(\"already self bind:\" + cmd + \",my page:\" + location.href);\n\t\t\t\t\t\t\t_sendData(\"binded\", cmd, fromSource, oinstanceid);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toinstanceidMap[oinstanceid] = instanceid;\n\t\t\t\t\t\t\tinstanceBindMap[instanceid] = true;\n\t\t\t\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t\t\t\tlistener.osource = fromSource;\n\t\t\t\t\t\t\tlistener.origin = originStr;\n\t\t\t\t\t\t\t_sendData(\"accept\", cmd, fromSource, listener.conndata, instanceid, oinstanceid);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tfor(let i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlet listener = listeners[i];\n\t\t\t\t\tif(!listener.refused[oinstanceid]) {\n\t\t\t\t\t\tlistener.connectingSource(fromSource, originStr, data, Callback(listener.id));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleAccept(cmd, fromSource, originStr, data, oinstanceid, minstanceid) {\n\t\t\t\tlet listeners = cmd2ListenerMap[cmd];\n\t\t\t\tif(!listeners) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction Callback(instanceid) {\n\n\t\t\t\t\treturn function(isAccept, msg) {\n\t\t\t\t\t\tif(!isAccept) {\n\t\t\t\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t\t\t\tlistener.refused[oinstanceid] = true;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(oinstanceidMap[oinstanceid]) {\n\t\t\t\t\t\t\tconsole.warn(\"already bind:\" + cmd + \",my page:\" + location.href);\n\t\t\t\t\t\t} else if(instanceBindMap[instanceid]) {\n\t\t\t\t\t\t\tconsole.warn(\"already self bind:\" + cmd + \",my page:\" + location.href);\n\t\t\t\t\t\t\t_sendData(\"binded\", cmd, fromSource, oinstanceid);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toinstanceidMap[oinstanceid] = instanceid;\n\t\t\t\t\t\t\tinstanceBindMap[instanceid] = true;\n\n\t\t\t\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\t\t\t\tlistener.osource = fromSource;\n\t\t\t\t\t\t\tlistener.origin = originStr;\n\t\t\t\t\t\t\t_sendData(\"conned\", cmd, fromSource, listener.conndata, instanceid);\n\t\t\t\t\t\t\tlistener._onConned(fromSource, data);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tfor(let i = 0; i < listeners.length; i++) {\n\t\t\t\t\tlet listener = listeners[i];\n\t\t\t\t\tif(listener.id == minstanceid && !listener.refused[oinstanceid]) { //当前为主动发起连接的页面\n\t\t\t\t\t\tlistener.connectingSource(fromSource, originStr, data, Callback(listener.id));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleBinded(cmd, fromSource, originStr, minstanceid) {\n\t\t\t\tlet listener = instanceMap[minstanceid];\n\t\t\t\tlistener._onElse(\"binded\");\n\t\t\t}\n\n\t\t\tfunction checkSource(listener, fromSource, originStr) {\n\t\t\t\tif(listener.osource != fromSource && listener.origin != originStr) {\n\t\t\t\t\tconsole.warn(\"expected:\" + listener.origin + \",but:\" + originStr);\n\t\t\t\t\tthrow new Error(\"source changed!\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleConned(cmd, fromSource, originStr, data, oinstanceid) {\n\t\t\t\tlet instanceid = oinstanceidMap[oinstanceid];\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\tcheckSource(listener, fromSource, originStr);\n\n\t\t\t\tlistener._onConned(listener.osource, data);\n\t\t\t}\n\n\t\t\tfunction handleMsg(cmd, fromSource, originStr, data, oinstanceid, msgid) {\n\t\t\t\tlet instanceid = oinstanceidMap[oinstanceid];\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\tcheckSource(listener, fromSource, originStr);\n\n\t\t\t\tlistener._onMsg(data, msgid);\n\t\t\t}\n\n\t\t\tfunction handleResponse(cmd, fromSource, originStr, data, oinstanceid) {\n\t\t\t\tlet instanceid = oinstanceidMap[oinstanceid];\n\t\t\t\tlet listener = instanceMap[instanceid];\n\t\t\t\tcheckSource(listener, fromSource, originStr);\n\n\t\t\t\tlistener._onResponse(data);\n\t\t\t}\n\n\t\t\tfunction _sendData(type, cmd, source, data, instanceid, msgid) {\n\t\t\t\tlet msg = {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tdata: data,\n\t\t\t\t\tcmd: cmd,\n\t\t\t\t\tid: instanceid,\n\t\t\t\t\tmsgid: msgid\n\t\t\t\t};\n\n\t\t\t\tif(isDebug(\"postMessageBridge\")) {\n\t\t\t\t\tconsole.log(\"send from:\" + location.href);\n\t\t\t\t\tconsole.log(msg);\n\t\t\t\t}\n\t\t\t\tsource.postMessage(xsloader.xsJson2String(msg), \"*\");\n\t\t\t}\n\n\t\t\twindow.addEventListener('message', function(event) {\n\t\t\t\tif(isDebug(\"postMessageBridge\")) {\n\t\t\t\t\tconsole.log(\"receive from:\" + event.origin + \",my page:\" + location.href);\n\t\t\t\t\tconsole.log(event.data);\n\t\t\t\t}\n\t\t\t\tlet data;\n\t\t\t\ttry {\n\t\t\t\t\tdata = xsloader.xsParseJson(event.data);\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t}\n\t\t\t\tif(!data || !(data.cmd && data.type)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet cmd = data.cmd;\n\t\t\t\tlet oinstanceid = data.id;\n\t\t\t\tlet rdata = data.data;\n\t\t\t\tlet type = data.type;\n\t\t\t\tlet msgid = data.msgid;\n\n\t\t\t\tif(type == \"conn\") {\n\t\t\t\t\thandleConn(cmd, event.source, event.origin, rdata, oinstanceid);\n\t\t\t\t} else if(type == \"accept\") {\n\t\t\t\t\thandleAccept(cmd, event.source, event.origin, rdata, oinstanceid, msgid);\n\t\t\t\t} else if(type == \"conned\") {\n\t\t\t\t\thandleConned(cmd, event.source, event.origin, rdata, oinstanceid);\n\t\t\t\t} else if(type == \"msg\") {\n\t\t\t\t\thandleMsg(cmd, event.source, event.origin, rdata, oinstanceid, msgid);\n\t\t\t\t} else if(type == \"response\") {\n\t\t\t\t\thandleResponse(cmd, event.source, event.origin, rdata, oinstanceid);\n\t\t\t\t} else if(type == \"binded\") {\n\t\t\t\t\thandleBinded(cmd, event.source, event.origin, rdata);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\thandle.runAfter = function(time, callback) {\n\t\t\t\tsetTimeout(callback, time);\n\t\t\t};\n\n\t\t\treturn handle;\n\t\t})();\n\n\t\tfunction CommunicationUnit(cmd, source, connectingSource, onfailed, isActive, conndata) {\n\t\t\tlet msgQueue = new LinkedList();\n\n\t\t\tlet MAX_TRY = 100,\n\t\t\t\tSLEEP = 500;\n\t\t\tlet isConnected = false,\n\t\t\t\tconnectCount = 0;\n\t\t\tlet isCanceled = false;\n\n\t\t\tlet thiz = this;\n\t\t\tlet handleId;\n\n\t\t\tthis.onConnectedListener = null;\n\t\t\tthis.onReceiveListener = null;\n\t\t\tthis.send = function(data) {\n\t\t\t\tlet msg = {\n\t\t\t\t\tid: xsloader.randId(),\n\t\t\t\t\tdata: data\n\t\t\t\t};\n\t\t\t\tmsgQueue.append(msg);\n\t\t\t\tsendTop();\n\t\t\t};\n\n\t\t\tthis.send.release = function() {\n\t\t\t\tpostMessageBridge.remove(handleId);\n\t\t\t};\n\n\t\t\tfunction _onConned(_source, data) {\n\t\t\t\tthiz.onConnectedListener.call(thiz, data);\n\t\t\t\tisConnected = true;\n\t\t\t\tsendTop();\n\t\t\t}\n\n\t\t\tfunction _onMsg(data, msgid) {\n\t\t\t\ttry {\n\t\t\t\t\tthiz.onReceiveListener.call(thiz, data);\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.warn(e);\n\t\t\t\t}\n\t\t\t\tpostMessageBridge.sendResponse({ //回应已经收到\n\t\t\t\t\tid: msgid\n\t\t\t\t}, handleId);\n\t\t\t}\n\n\t\t\tfunction _onResponse(data) {\n\t\t\t\tmsgQueue.remove(function(elem) {\n\t\t\t\t\treturn elem.id = data.id;\n\t\t\t\t});\n\t\t\t\tsendTop();\n\t\t\t}\n\n\t\t\tfunction _onElse(type) {\n\t\t\t\tif(type == \"binded\") {\n\t\t\t\t\tisCanceled = true;\n\t\t\t\t\tconsole.error(\"connect failed,that page already binded:\" + cmd + \",my page:\" + location.href);\n\t\t\t\t\tonfailed(\"canceled\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction initListen() {\n\t\t\t\thandleId = postMessageBridge.listen(cmd, conndata, connectingSource, source, isActive, _onConned, _onMsg, _onResponse, _onElse);\n\t\t\t}\n\n\t\t\tfunction sendTop() {\n\t\t\t\tif(isConnected) {\n\t\t\t\t\tlet msg;\n\t\t\t\t\twhile((msg = msgQueue.pop())) {\n\t\t\t\t\t\tpostMessageBridge.send(msg.data, handleId, msg.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction init() {\n\t\t\t\tif(isConnected || connectCount > MAX_TRY || isCanceled) {\n\t\t\t\t\tif(!isConnected && !isCanceled) {\n\t\t\t\t\t\tonfailed(\"timeout\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tpostMessageBridge.sendConn(handleId);\n\t\t\t\tconnectCount++;\n\t\t\t\tpostMessageBridge.runAfter(SLEEP, init);\n\t\t\t}\n\t\t\tif(source) {\n\t\t\t\tinitListen();\n\t\t\t\tinit();\n\t\t\t} else if(!isActive) {\n\t\t\t\tinitListen();\n\t\t\t}\n\n\t\t\tthis.setSource = function(_source) {\n\t\t\t\tsource = _source;\n\t\t\t\tif(source) {\n\t\t\t\t\tinitListen();\n\t\t\t\t\tinit();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tlet handleApi = api;\n\n\t\t/**\n\t\t * \n\t\t * @param {Object} winObjOrCallback\n\t\t * @param {Object} option\n\t\t * @param {Object} notActive\n\t\t */\n\t\tfunction _connectWindow(winObjOrCallback, option, notActive) {\n\t\t\toption = xsloader.extendDeep({\n\t\t\t\tcmd: \"default-cmd\",\n\t\t\t\tlistener: null,\n\t\t\t\tconnected: null,\n\t\t\t\tconndata: null,\n\t\t\t\tconnectingSource: function(source, origin, conndata, callback) {\n\t\t\t\t\tlet mine = location.protocol + \"//\" + location.host;\n\t\t\t\t\tcallback(mine == origin, \"default\");\n\t\t\t\t},\n\t\t\t\tonfailed: function(errtype) {\n\t\t\t\t\tif(errtype == \"timeout\") {\n\t\t\t\t\t\tconsole.warn(\"connect may timeout:cmd=\" + option.cmd + \",my page=\" + location.href);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, option);\n\n\t\t\tlet cmd = option.cmd;\n\t\t\tlet connectedCallback = option.connected;\n\t\t\tlet receiveCallback = option.listener;\n\t\t\tlet conndata = option.conndata;\n\t\t\tlet onfailed = option.onfailed;\n\n\t\t\tlet isActive = !notActive;\n\t\t\tlet connectingSource = option.connectingSource;\n\n\t\t\tlet unit;\n\t\t\tif(typeof winObjOrCallback == \"function\") {\n\t\t\t\tunit = new CommunicationUnit(cmd, null, connectingSource, onfailed, isActive, conndata);\n\t\t\t} else {\n\t\t\t\tunit = new CommunicationUnit(cmd, winObjOrCallback, connectingSource, onfailed, isActive, conndata);\n\t\t\t}\n\n\t\t\tconnectedCallback = connectedCallback || function(sender, conndata) {\n\t\t\t\tconsole.log((isActive ? \"active\" : \"\") + \" connected:\" + cmd);\n\t\t\t};\n\t\t\tif(connectedCallback) {\n\t\t\t\tunit.onConnectedListener = function(conndata) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconnectedCallback(this.send, conndata);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(receiveCallback) {\n\t\t\t\tunit.onReceiveListener = function(data) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treceiveCallback(data, this.send);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(typeof winObjOrCallback == \"function\") {\n\t\t\t\twinObjOrCallback(function(winObj) {\n\t\t\t\t\tunit.setSource(winObj);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn unit.send;\n\t\t}\n\n\t\tfunction _connectIFrame(iframe, option) {\n\t\t\tlet winObj;\n\t\t\tif(typeof iframe == \"string\") {\n\t\t\t\t//iframe = ddocument.querySelector(iframe);\n\t\t\t\twinObj = function(callback) {\n\t\t\t\t\tiframe.onload = function() {\n\t\t\t\t\t\tcallback(this.contentWindow);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\twinObj = iframe.contentWindow;\n\t\t\t}\n\t\t\treturn _connectWindow(winObj, option);\n\n\t\t}\n\n\t\t/**\n\t\t * 用于连接iframe.\n\t\t * @param {Object} iframe iframe或selector\n\t\t * @param {Object} option\n\t\t * @return 返回sender\n\t\t */\n\t\thandleApi.connectIFrame = function(iframe, option) {\n\t\t\treturn _connectIFrame(iframe, option);\n\t\t};\n\n\t\t/**\n\t\t * 用于连接父页面.\n\t\t * @param {Object} option\n\t\t * @return 返回sender\n\t\t */\n\t\thandleApi.connectParent = function(option) {\n\t\t\treturn _connectWindow(window.parent, option);\n\t\t};\n\n\t\t/**\n\t\t * 用于连接顶层页面.\n\t\t * @param {Object} option\n\t\t * @return 返回sender\n\t\t */\n\t\thandleApi.connectTop = function(option) {\n\t\t\treturn _connectWindow(window.top, option);\n\t\t};\n\n\t\t/**\n\t\t * 用于连接打开者.\n\t\t * @param {Object} option\n\t\t * @return 返回sender\n\t\t */\n\t\thandleApi.connectOpener = function(option) {\n\t\t\treturn _connectWindow(window.opener, option);\n\t\t};\n\n\t\t/**\n\t\t * 用于监听其他页面发送消息.\n\t\t * @param {Object} option\n\t\t * @return 返回一个sender\n\t\t */\n\t\thandleApi.listenMessage = function(option) {\n\t\t\treturn _connectWindow(null, option, true);\n\t\t};\n\n\t\thandleApi.debug = function(isDebug) {\n\t\t\tisXsMsgDebug = isDebug;\n\t\t};\n\n\t\t/**\n\t\t * *******************\n\t\t * option参数\n\t\t *********************\n\t\t * option.cmd:\n\t\t * option.connectingSource:function(source,origin,conndata,callback(isAccept,msg))默认只选择同源\n\t\t * option.listener: function(data,sender)\n\t\t * option.connected:function(sender,conndata)\n\t\t * option.onfailed:function(errtype):errtype,timeout,canceled\n\t\t * option.conndata:\n\t\t **************\n\t\t * 回调的extra参数\n\t\t **************\n\t\t * originStr:对方页面的地址\n\t\t */\n\t\txsloader.define(\"xsmsg\", handleApi); //TODO STRONG xsmsg\n\t}\n\n\txsloader.define(\"XsLinkedList\", function() {\n\t\treturn LinkedList;\n\t});\n} catch(e) {\n\tconsole.error(e);\n}","// 静态资源服务\nimport utils from \"./util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nconst http = global._xshttp_request_;\nconst DATA_CONF = \"data-conf\",\n\tDATA_CONFX = \"data-xsloader-conf\";\nconst DATA_CONF2 = \"data-conf2\",\n\tDATA_CONF2X = \"data-xsloader-conf2\";\nconst DATA_MAIN = \"data-main\",\n\tDATA_MAINX = \"data-xsloader-main\";\nconst DATA_CONF_TYPE = \"data-conf-type\";\n\nlet serviceConfigUrl;\nlet dataConf = xsloader.script().getAttribute(DATA_CONF) || xsloader.script().getAttribute(DATA_CONFX);\nlet dataMain = xsloader.script().getAttribute(DATA_MAIN) || xsloader.script().getAttribute(DATA_MAINX);\nlet dataConfType = xsloader.script().getAttribute(DATA_CONF_TYPE);\nif(dataConfType !== \"json\" && dataConfType != \"js\") {\n\tdataConfType = \"auto\";\n}\n\nlet initFun = () => {\n\tfunction getMainPath(config) {\n\t\tlet mainPath = config.main.getPath.call(config, dataMain);\n\t\tlet path = location.pathname;\n\n\t\tlet index = path.lastIndexOf(\"/\");\n\t\tlet name = path.substring(index + 1);\n\t\tif(name === \"\") {\n\t\t\tname = \"index\";\n\t\t}\n\t\tif(xsloader.endsWith(name, \".html\")) {\n\t\t\tname = name.substring(0, name.length - 5);\n\t\t}\n\t\tif(!mainPath) {\n\t\t\tmainPath = \"./main/{name}.js\";\n\t\t}\n\t\tmainPath = mainPath.replace(\"{name}\", name);\n\t\treturn mainPath;\n\t}\n\n\tfunction extendConfig(config) {\n\t\tconfig = xsloader.extendDeep({\n\t\t\tproperties: {},\n\t\t\tmain: {\n\t\t\t\tgetPath() {\n\t\t\t\t\treturn dataMain || \"./main/{name}.js\";\n\t\t\t\t},\n\t\t\t\tname: \"main\",\n\t\t\t\tlocalConfigVar: \"lconfig\",\n\t\t\t\tglobalConfigVar: \"gconfig\",\n\t\t\t\tbefore(name) {\n\t\t\t\t\tconsole.log(\"before:\" + name);\n\t\t\t\t},\n\t\t\t\tafter(name) {\n\t\t\t\t\tconsole.log(\"after:\" + name);\n\t\t\t\t}\n\t\t\t},\n\t\t\tservice: {\n\t\t\t\thasGlobal: false,\n\t\t\t\tresUrls: []\n\t\t\t},\n\t\t\tchooseLoader(localConfig) { //返回一个configName；当此函数为service全局配置的函数时，localConfig为应用的配置对象;本地配置调用时，localConfig为null。\n\t\t\t\treturn \"default\";\n\t\t\t},\n\t\t\tloader: {\n\t\t\t\t\"default\": {\n\t\t\t\t\tautoUrlArgs: true\n\t\t\t\t}\n\t\t\t}\n\t\t}, config);\n\n\t\treturn config;\n\t}\n\n\tfunction loadServiceConfig(tag, url, callback, isLocal) {\n\t\thttp({\n\t\t\turl: url,\n\t\t\tmethod: \"get\",\n\t\t\ttimeout: 20000,\n\t\t\thandleType: \"text\",\n\t\t\tok(confText) {\n\n\t\t\t\tlet conf;\n\t\t\t\tif(dataConfType == \"js\") {\n\t\t\t\t\tconf = xsloader.xsEval(confText);\n\t\t\t\t} else if(dataConfType == \"json\") {\n\t\t\t\t\tconf = xsloader.xsParseJson(confText);\n\t\t\t\t} else {\n\t\t\t\t\tif(xsloader.startsWith(url, location.protocol + \"//\" + location.host + \"/\")) {\n\t\t\t\t\t\t//同域则默认用脚本解析\n\t\t\t\t\t\tconf = xsloader.xsEval(confText);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconf = xsloader.xsParseJson(confText);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconf = extendConfig(conf);\n\t\t\t\tif(conf.beforeDealProperties) {\n\t\t\t\t\tconf.beforeDealProperties();\n\t\t\t\t}\n\t\t\t\tconf = xsloader.dealProperties(conf, conf.properties); //参数处理\n\n\t\t\t\tif(isLocal && conf.service.hasGlobal) {\n\t\t\t\t\tloadServiceConfig(\"global servie\", conf.service.confUrl,\n\t\t\t\t\t\tfunction(globalConfig) {\n\t\t\t\t\t\t\tlet localConfig = conf;\n\t\t\t\t\t\t\tglobal[globalConfig.main && globalConfig.main.localConfigVar || localConfig.main.localConfigVar] = localConfig;\n\t\t\t\t\t\t\tglobal[globalConfig.main && globalConfig.main.globalConfigVar || localConfig.main.globalConfigVar] = globalConfig;\n\n\t\t\t\t\t\t\tlet mainName, mainPath, loaderName;\n\n\t\t\t\t\t\t\tloaderName = globalConfig.chooseLoader.call(globalConfig, localConfig);\n\t\t\t\t\t\t\tlet conf;\n\t\t\t\t\t\t\tlet loader;\n\t\t\t\t\t\t\tif(loaderName != null) {\n\t\t\t\t\t\t\t\tmainName = globalConfig.main.name;\n\t\t\t\t\t\t\t\tmainPath = utils.getPathWithRelative(location.href, getMainPath(globalConfig));\n\t\t\t\t\t\t\t\tloader = globalConfig.loader[loaderName];\n\t\t\t\t\t\t\t\tconf = globalConfig;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(!loader) {\n\t\t\t\t\t\t\t\tloaderName = localConfig.chooseLoader.call(localConfig, null);\n\t\t\t\t\t\t\t\tmainName = localConfig.main.name;\n\t\t\t\t\t\t\t\tmainPath = utils.getPathWithRelative(location.href, getMainPath(localConfig));\n\t\t\t\t\t\t\t\tloader = localConfig.loader[loaderName];\n\t\t\t\t\t\t\t\tconf = localConfig;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(!loader) {\n\t\t\t\t\t\t\t\tconsole.error(\"unknown loader:\" + loaderName + \"\");\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tinitXsloader(mainName, mainPath, loader, conf, localConfig);\n\n\t\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcallback(conf);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfail(err) {\n\t\t\t\tconsole.error(\"load \" + tag + \" config err:url=\" + url + \",errinfo=\" + err);\n\t\t\t}\n\t\t}).done();\n\t}\n\n\tfunction startLoad() {\n\t\tloadServiceConfig(\"local\", serviceConfigUrl, function(localConfig) {\n\t\t\tglobal[localConfig.main.localConfigVar] = localConfig;\n\n\t\t\tlet mainName = localConfig.main.name;\n\n\t\t\tlet href = location.href;\n\t\t\tlet index = href.lastIndexOf(\"?\");\n\t\t\tif(index >= 0) {\n\t\t\t\thref = href.substring(0, index);\n\t\t\t}\n\n\t\t\tlet mainPath = getMainPath(localConfig);\n\n\t\t\tmainPath = mainPath.indexOf(\"!\") == -1 ? utils.getPathWithRelative(href, mainPath) : mainPath;\n\t\t\tlet loaderName = localConfig.chooseLoader.call(localConfig, null);\n\n\t\t\tlet loader = localConfig.loader[loaderName];\n\t\t\tif(!loader) {\n\t\t\t\tconsole.error(\"unknown local loader:\" + loaderName);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tinitXsloader(href, mainName, mainPath, loader, localConfig, localConfig);\n\t\t}, true);\n\t}\n\n\tfunction initXsloader(pageHref, mainName, mainPath, loader, conf, localConfig) {\n\t\tlet resUrls = [];\n\t\tconf.service.resUrl && resUrls.push(conf.service.resUrl);\n\t\tlocalConfig !== conf && localConfig.service.resUrl && resUrls.push(localConfig.service.resUrl);\n\n\t\tconf.service.resUrls && Array.pushAll(resUrls, conf.service.resUrls);\n\t\tlocalConfig !== conf && localConfig.service.resUrls && Array.pushAll(resUrls, localConfig.service.resUrls);\n\n\t\txsloader._resUrlBuilder = function(groupModule) {\n\t\t\tlet as = [];\n\t\t\tutils.each(resUrls, function(url) {\n\t\t\t\tas.push(xsloader.appendArgs2Url(url, \"m=\" + encodeURIComponent(groupModule)));\n\t\t\t});\n\t\t\treturn as;\n\t\t};\n\t\tloader.ignoreProperties = true;\n\t\tloader.defineFunction = loader.defineFunction || {};\n\t\tloader.depsPaths = loader.depsPaths || {};\n\t\tif(mainPath.indexOf(\"!\") != -1) { //插件调用\n\t\t\tlet theConfig = xsloader(loader);\n\n\t\t\tmainName = \"_plugin_main_\";\n\t\t\tlet deps = [];\n\t\t\tif(theConfig.deps) { //手动添加*依赖\n\t\t\t\tif(theConfig.deps[\"*\"]) {\n\t\t\t\t\tArray.pushAll(deps, theConfig.deps[\"*\"]);\n\t\t\t\t}\n\t\t\t\tif(theConfig.deps[mainName]) {\n\t\t\t\t\tArray.pushAll(deps, theConfig.deps[mainName]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdeps.push(mainPath);\n\t\t\txsloader.defineAsync(mainName, deps, function() {\n\n\t\t\t}).then({\n\t\t\t\tabsUrl: pageHref\n\t\t\t});\n\t\t} else if(!xsloader.hasDefine(mainName)) {\n\t\t\tloader.depsPaths[mainName] = mainPath; //让其依赖*中的所有依赖\n\t\t\txsloader(loader);\n\t\t} else {\n\t\t\txsloader(loader);\n\t\t}\n\n\t\tloader.defineFunction[mainName] = function(originCallback, originThis, originArgs) {\n\t\t\tif(xsloader.isFunction(conf.main.before)) {\n\t\t\t\tconf.main.before.call(conf, mainName);\n\t\t\t}\n\t\t\tlet rt = originCallback.apply(originThis, originArgs);\n\n\t\t\tif(xsloader.isFunction(conf.main.after)) {\n\t\t\t\tconf.main.after.call(conf, mainName);\n\t\t\t}\n\t\t\treturn rt;\n\t\t};\n\n\t\txsloader.require([mainName], function(main) {}).then({\n\t\t\tonError: function(err, invoker) {\n\t\t\t\tif(invoker) {\n\t\t\t\t\tconsole.error(\"error occured:invoker.url=\", invoker.getUrl());\n\t\t\t\t}\n\t\t\t\tconsole.error(\"invoke main err:\" + err);\n\t\t\t}\n\t\t});\n\t}\n\txsloader.asyncCall(startLoad, true);\n};\n\nif(dataConf) {\n\tserviceConfigUrl = utils.getPathWithRelative(location.href, dataConf);\n} else if((dataConf = (xsloader.script().getAttribute(DATA_CONF2) || xsloader.script().getAttribute(DATA_CONF2X)))) {\n\tserviceConfigUrl = utils.getPathWithRelative(xsloader.scriptSrc(), dataConf);\n} else {\n\tinitFun = null;\n}\ninitFun && initFun();"],"names":["g","window","undefined","self","global","Error","loaderFun","xsloader","apply","arguments","fun","ABSOLUTE_PROTOCOL_REG","ABSOLUTE_PROTOCOL_REG2","defaultJsExts","isJsFile","path","isString","pluginIndex","indexOf","substring","index","theConfig","config","jsExts","i","length","endsWith","ext","dealPathMayAbsolute","currentUrl","location","href","rs","exec","finalPath","absolute","protocol","_protocol","_host","host","getPathWithRelative","relative","isPathDir","relativeQuery","qIndex","lastIndexOf","isRelativeDir","prefix","absolute2","index2","stack","split","pop","relatives","str","push","result","join","appendArgs2Url","getNodeAbsolutePath","node","src","getAttribute","removeQueryHash","url","REPLACE_STRING_PROPERTIES_EXP","RegExp","ALL_TYPE_PROPERTIES_EXP","propertiesDeal","configObject","properties","replaceStringProperties","string","property","propKey","propValue","getObjectAttr","propertyKey","has","replaceProperties","obj","enableKeyAttr","isFunction","isArray","isObject","replaceKeyMap","x","_x","objx","__dealt__","call","replaceModulePrefix","deps","m","pluginParam","query","is","startsWith","modulePrefixCount","modulePrefix","replaceStr","replace","len","pluginName","dep","getScriptBySubname","subname","ss","document","getElementsByTagName","script","commentRegExp","cjsRequireRegExp","GraphPath","pathEdges","vertexMap","depMap","addEdge","begin","end","hasDep","name","tryAddEdge","paths","hasLoop","visited","recursionStack","checkLoop","v","edges","edge","strValue2Arr","each","ary","func","isSync","fromEnd","handle","__commentReplace","match","singlePrefix","appendInnerDeps","callback","toString","idCount","getAndIncIdCount","PluginError","err","graphPath","urls","base","utils","Function","prototype","bind","console","method","thiz","e","log","error","warn","Array","elem","offset","pushAll","arr","starts","ends","_indexInArray","array","ele","compare","indexInArray","indexInArrayFrom","JSON","rx_one","rx_two","rx_three","rx_four","rx_escapable","rx_dangerous","f","n","this_value","valueOf","Date","toJSON","isFinite","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","Boolean","Number","String","gap","indent","meta","rep","quote","lastIndex","test","a","c","charCodeAt","slice","key","holder","k","mind","partial","value","Object","hasOwnProperty","stringify","replacer","space","parse","text","reviver","j","walk","eval","SyntaxError","trim","randId","suffix","id","parseInt","getTime","Math","random","xsEval","scriptString","IE_VERSION","xsParseJson","option","extend","fnStart","fnEnd","rcomment","fnMap","fnOffset","indexStart","indexEnd","fnId","fnStr","fn","val","jsonObj","xsJSON","reg","message","posStr","pos","_str","e2","xsJson2String","_toParamsMap","argsStr","decode","search","ret","seg","s","decodeURIComponent","urlArgs","hashIndex","oldParams","newParams","paramKeys","sort","params","hash","queryString2ParamsMap","ostring","it","isDate","isRegExp","queryParam","otherValue","optionUrl","substr","r","getUrl","relativeUrl","appendArgs","optionalAbsUrl","thePageUrl","pageUrl","baseUrl","dealUrl","tryCall","defaultReturn","exCallback","dealProperties","target","extendDeep","_AsyncCall","useTimer","count","ctrlCallbackMap","initCtrlCallback","callbackObj","mineCount","ctrlCallback","asyncCallQueue","shift","lastReturn","nextCallback","nextObj","pushTask","next","Promise","resolve","then","setTimeout","queue","theAsyncCall","theAsyncCallOfTimer","asyncCall","attrNames","defaultValue","attrs","setObjectAttr","_obj","o","clone","isDeep","source","flags","copy","setTime","attr","isDOM","HTMLElement","nodeType","nodeName","onReadyFun","isGlobalReady","bindReadyQueue","BindReady","isReady","ready","addEventListener","removeEventListener","attachEvent","readyState","detachEvent","fun2","documentElement","doScroll","frameElement","readyCall","onReady","br","addEventHandle","type","toGlobal","deprecated","justLoader","funs","browser","_ignoreAspect_","theDefinedMap","INNER_DEPS_PLUGIN","innerDepsMap","getModule","nameOrUrl","get","setModule","last","buildInvoker","invoker","module","getId","getAbsoluteUrl","rurl","require","h","define","defineObject","absUrl","defineAsync","withAbsUrl","moduleMap","getName","Invoker","newModuleInstance","thatInvoker","relyCallback","pluginArgs","instanceModule","_invoker","_module_","initInvoker","ignoreAspect","_object","addTheAttrs","theObj","_invoker_","_modules_","isSingle","instanceType","loopObject","_setDepModuleObjectGen","moduleObject","genExports","_getCacheKey","getCacheKey","_willCache","cacheResult","willCache","lastSinglePluginResult","setSinglePluginResult","init","justForSingle","dealInstance","hasFinished","onload","__default","onerror","args","concat","depModules","pluginMain","waitSeconds","_newModule","DefineObject","newModule","instances","selfname","relys","otherModule","directDefineIndex","getMineAbsUrl","_loadCallback","setInstanceType","_singlePluginResult","finish","_directArgs","currentDefineModuleQueue","setState","isDefault","state","errinfo","_callback","_state","theCallback","depModule","getDeps","defined_module_for_deps","toOtherModule","theRelys","relyIt","whenNeed","loadCallback","callbackFun","moduleInstance","opId","setToAll","_getModuleId","ins","mobj","_m_","mayAddDeps","moduleDeps","printOnNotDefined","root","nodes","_printOnNotDefined","leafs","findLeaf","item","genErrs","infos","parent","leaf","reverse","as","info","errModule","depMod","parentNode","indexPlguin","mod","randModuleIndex","_dealEmbedDeps","modName","isOrderDep","orderDep","_getPluginParam","everyRequired","everyOkCallback","errCallback","isError","jsFilePath","moduleLoop","hasCallErr","theExports","depCount","invoker_the_module","checkFinish","dep_name","syncHandle","originDep","relyItFun","i1","i2","i3","version","groupModule","defaultVersion","_url","_resUrlBuilder","isInUrls","getUrls","module2","mayAsyncCallLoadModule","loadModule","loadScript","scriptData","defContextName","DATA_ATTR_MODULE","DATA_ATTR_CONTEXT","globalDefineQueue","hasNoSelfnameSrcMap","head","isOpera","opera","readyRegExp","navigator","platform","theLoaderScript","currentScript","theLoaderUrl","peek","lastAppendHeadDom","useDefineQueue","theRealDefine","safariVersion","getInvoker","nullNew","moduleScript","isRequire","parentDefine","onError","before","depBefore","depDeps","absoluteUrl","instance","getCurrentScript","isRemoveQueryHash","_getCurrentScriptOrSrc","b","sourceURL","stacktrace","__createNode","createElement","charset","async","__removeListener","ieName","__browserLoader","moduleName","setAttribute","onScriptLoad","errListen","onScriptError","appendHeadDom","__getScriptData","evt","currentTarget","srcElement","dom","nextDom","nextSibling","insertBefore","removed","doDefine","predefine","prerequire","originDeps","argArr","theMod","timeid","clearTimeout","checkResultFun","ifmodule","initDefine","theDefine","defines","onConfigedCallback","theContext","argsObject","scriptSrc","putUrlArgs","argsObj","getUrlArgs","clearUrlArgs","hasDefine","groupName","clear_module_","modules","_newContext","context","contextName","defQueue","loader","pathname","ignoreProperties","depsPaths","defineFunction","autoUrlArgs","dealtDeps","hasOrderDep","splice","urlArg","forPrefixSuffix","aurl","encodeURIComponent","dealUrlArgs","isAutoUrlArgs","star","urlArgsArr","urlArgObj","starP","_urlArgs_prefix","_urlArgs_suffix","strfix","urlOrName","strfixObj","pushDeps","dealtDepArray","depsArray","keyName","defineHandle","_deps","originCallback","rt","defineFun","names","onModuleLoaded","lastDefineObject","moduleSelf","needCallback","depModuleArgs","amd","depId","depsObj","arg","vars","existsMods","newName","lastM","load","engine","userAgent","useImportLoad","useOnload","style","cssAPI","curStyle","curSheet","createStyle","styleSheet","sheet","ieCnt","ieLoads","ieCurCallback","createIeLoad","addImport","processIeLoad","nextLoad","importLoad","textContent","loadInterval","setInterval","cssRules","clearInterval","linkLoad","link","rel","styleSheets","cssId","loadCss","cssPath","loadCsses","http","handleAs","ok","fail","done","depsStr","json","progIds","httpRequest","prop","varName","defaultVal","putProp","toObj","_method","_params","_headers","_async","_multiPart","_handleType","_timeout","timeout","okCallback","failCallback","uploadStartCallback","uploadStart","uploadProgressCallback","uploadProgress","uploadOkCallback","uploadOk","uploadErrorCallback","uploadError","uploadEndCallback","uploadEnd","_beforeOpenHook","_onOkResponseHook","_onFailResponseHook","createXhr","xhr","progId","XMLHttpRequest","ActiveXObject","conn","_conn","toUpperCase","headers","handleType","multiPart","_connAfterOpenHook","_doOnFailResponseHook","extraErr","body","formData","FormData","append","open","setRequestHeader","header","upload","onloadstart","onprogress","onloadend","timeoutTimer","isTimeout","abort","onreadystatechange","status","responseText","send","requestObj","urlStr","methodStr","isAsync","paramsObj","headersObj","extraErrorType","_xshttp_request_","xsRequest","isResponsed","callbacksQueue","code","desc","newHandle","isDebug","isXsMsgDebug","LinkedList","newNode","element","pre","headNode","lastNode","current","insert","position","pNode","elementAt","getElement","willRemove","currentNode","nextCurrentNode","eachForRemove","removeAt","find","remove","isEmpty","size","api","linkedList","CommunicationUnit","cmd","connectingSource","onfailed","isActive","conndata","msgQueue","MAX_TRY","SLEEP","isConnected","connectCount","isCanceled","handleId","onConnectedListener","onReceiveListener","data","msg","sendTop","release","postMessageBridge","_onConned","_source","_onMsg","msgid","sendResponse","_onResponse","_onElse","initListen","listen","sendConn","runAfter","setSource","_connectWindow","winObjOrCallback","notActive","listener","connected","origin","mine","errtype","connectedCallback","receiveCallback","unit","sender","winObj","_connectIFrame","iframe","contentWindow","instanceMap","cmd2ListenerMap","instanceBindMap","oinstanceidMap","osource","active","refused","instanceid","_sendData","handleConn","fromSource","originStr","oinstanceid","listeners","Callback","isAccept","handleAccept","minstanceid","handleBinded","checkSource","handleConned","handleMsg","handleResponse","postMessage","event","rdata","time","handleApi","connectIFrame","connectParent","connectTop","top","connectOpener","opener","listenMessage","debug","DATA_CONF","DATA_CONFX","DATA_CONF2","DATA_CONF2X","DATA_MAIN","DATA_MAINX","DATA_CONF_TYPE","serviceConfigUrl","dataConf","dataMain","dataConfType","initFun","getMainPath","mainPath","main","getPath","extendConfig","localConfigVar","globalConfigVar","after","service","hasGlobal","resUrls","chooseLoader","localConfig","loadServiceConfig","tag","isLocal","confText","conf","beforeDealProperties","confUrl","globalConfig","mainName","loaderName","initXsloader","startLoad","pageHref","resUrl","originThis","originArgs"],"mappings":"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"}