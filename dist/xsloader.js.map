{"version":3,"file":"xsloader.js","sources":["../src/util/global.js","../src/util/urls.js","../src/util/base.js","../src/util/index.js","../src/core/script.js","../src/core/module.js","../src/core/define.js","../src/core/index.js","../src/public/global-deprecated.js","../src/polyfill/json.js","../src/public/global-base.js","../src/public/is.js","../src/public/funs.js","../src/public/browser.js","../src/public/index.js"],"sourcesContent":["let g;\nif(typeof window !== undefined) {\n\tg = window;\n} else if(typeof self !== undefined) {\n\tg = self;\n} else if(typeof global !== undefined) {\n\tg = global;\n} else {\n\tthrow new Error(\"not found global var!\");\n}\n\nexport default {\n\tglobal:g\n};\n","const ABSOLUTE_PROTOCOL_REG = /^(([a-zA-Z0-9_]*:\\/\\/)|(\\/)|(\\/\\/))/;\nconst ABSOLUTE_PROTOCOL_REG2 = /^([a-zA-Z0-9_]+:)\\/\\/([^/\\s]+)/;\nconst defaultJsExts = [\".js\", \".js+\", \".js++\", \".es\", \"es6\", \".jsx\", \".vue\"];\n\nimport global from './global.js';\nconst xsloader = global.xsloader;\n\nfunction isJsFile(path) {\n\tif(!xsloader.isString(path)) {\n\t\treturn false;\n\t}\n\tvar pluginIndex = path.indexOf(\"!\");\n\tif(pluginIndex > 0) {\n\t\tpath = path.substring(0, pluginIndex);\n\t}\n\tvar index = path.indexOf(\"?\");\n\tif(index > 0) {\n\t\tpath = path.substring(0, index);\n\t}\n\tindex = path.indexOf(\"#\");\n\tif(index > 0) {\n\t\tpath = path.substring(0, index);\n\t}\n\tlet theConfig = xsloader.config();\n\n\tvar jsExts = theConfig && theConfig.jsExts || defaultJsExts;\n\tfor(var i = 0; i < jsExts.length; i++) {\n\t\tif(xsloader.endsWith(path, jsExts[i])) {\n\t\t\treturn {\n\t\t\t\text: jsExts[i],\n\t\t\t\tpath: path\n\t\t\t};\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction dealPathMayAbsolute(path, currentUrl) {\n\tcurrentUrl = currentUrl || location.href;\n\tlet rs = ABSOLUTE_PROTOCOL_REG.exec(path);\n\n\tlet finalPath;\n\tlet absolute;\n\tif(rs) {\n\t\tlet protocol = rs[1];\n\t\tabsolute = true;\n\n\t\trs = ABSOLUTE_PROTOCOL_REG2.exec(currentUrl);\n\t\tlet _protocol = rs && rs[1] || location.protocol;\n\t\tlet _host = rs && rs[2] || location.host;\n\n\t\tif(protocol == \"//\") {\n\t\t\tfinalPath = _protocol + \"//\" + path;\n\t\t} else if(protocol == \"/\") {\n\t\t\tfinalPath = _protocol + \"//\" + _host + path;\n\t\t} else {\n\t\t\tfinalPath = path;\n\t\t}\n\n\t} else {\n\t\tabsolute = false;\n\t\tfinalPath = path;\n\t}\n\treturn {\n\t\tabsolute: absolute,\n\t\tpath: finalPath\n\t};\n}\n\nfunction getPathWithRelative(path, relative, isPathDir) {\n\n\tlet relativeQuery = \"\";\n\tlet qIndex = path.lastIndexOf(\"?\");\n\tif(qIndex >= 0) {\n\t\tpath = path.substring(0, qIndex);\n\t} else {\n\t\tqIndex = path.lastIndexOf(\"#\");\n\t\tif(qIndex >= 0) {\n\t\t\tpath = path.substring(0, qIndex);\n\t\t}\n\t}\n\n\tqIndex = relative.lastIndexOf(\"?\");\n\tif(qIndex >= 0) {\n\t\trelativeQuery = relative.substring(qIndex);\n\t\trelative = relative.substring(0, qIndex);\n\t} else {\n\t\tqIndex = relative.lastIndexOf(\"#\");\n\t\tif(qIndex >= 0) {\n\t\t\trelativeQuery = relative.substring(qIndex);\n\t\t\trelative = relative.substring(0, qIndex);\n\t\t}\n\t}\n\n\tlet absolute = dealPathMayAbsolute(relative);\n\tif(absolute.absolute) {\n\t\treturn absolute.path + relativeQuery;\n\t}\n\n\tif(isPathDir === undefined) {\n\t\tlet index = path.lastIndexOf(\"/\");\n\t\tif(index == path.length - 1) {\n\t\t\tisPathDir = true;\n\t\t} else {\n\t\t\tif(index == -1) {\n\t\t\t\tindex = 0;\n\t\t\t} else {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\tisPathDir = path.indexOf(\".\", index) == -1;\n\t\t}\n\t}\n\n\tif(xsloader.endsWith(path, \"/\")) {\n\t\tpath = path.substring(0, path.length - 1);\n\t}\n\n\tlet isRelativeDir = false;\n\tif(relative == \".\" || xsloader.endsWith(relative, \"/\")) {\n\t\trelative = relative.substring(0, relative.length - 1);\n\t\tisRelativeDir = true;\n\t} else if(relative == \".\" || relative == \"..\" || xsloader.endsWith(\"/.\") || xsloader.endsWith(\"/..\")) {\n\t\tisRelativeDir = true;\n\t}\n\n\tlet prefix = \"\";\n\tlet index = -1;\n\tlet absolute2 = dealPathMayAbsolute(path);\n\tif(absolute2.absolute) {\n\t\tpath = absolute2.path;\n\t\tlet index2 = path.indexOf(\"//\");\n\t\tindex = path.indexOf(\"/\", index2 + 2);\n\t\tif(index == -1) {\n\t\t\tindex = path.length;\n\t\t}\n\t}\n\n\tprefix = path.substring(0, index + 1);\n\tpath = path.substring(index + 1);\n\n\tlet stack = path.split(\"/\");\n\tif(!isPathDir && stack.length > 0) {\n\t\tstack.pop();\n\t}\n\tlet relatives = relative.split(\"/\");\n\tfor(let i = 0; i < relatives.length; i++) {\n\t\tlet str = relatives[i];\n\t\tif(\"..\" == str) {\n\t\t\tif(stack.length == 0) {\n\t\t\t\tthrow new Error(\"no more upper path!\");\n\t\t\t}\n\t\t\tstack.pop();\n\t\t} else if(\".\" != str) {\n\t\t\tstack.push(str);\n\t\t}\n\t}\n\tif(stack.length == 0) {\n\t\treturn \"\";\n\t}\n\tlet result = prefix + stack.join(\"/\");\n\tif(isRelativeDir && !xsloader.endsWith(result, \"/\")) {\n\t\tresult += \"/\";\n\t}\n\tresult = xsloader.appendArgs2Url(result, relativeQuery);\n\treturn result;\n}\n\nfunction getNodeAbsolutePath(node) {\n\tlet src = node.src;\n\treturn getPathWithRelative(location.href, src);\n}\n\n//去掉url的query参数和#参数\nfunction removeQueryHash(url) {\n\tif(url) {\n\t\tlet index = url.indexOf(\"?\");\n\t\tif(index >= 0) {\n\t\t\turl = url.substring(0, index);\n\t\t}\n\n\t\tindex = url.indexOf(\"#\");\n\t\tif(index >= 0) {\n\t\t\turl = url.substring(0, index);\n\t\t}\n\t}\n\treturn url;\n}\n\nconst REPLACE_STRING_PROPERTIES_EXP = new RegExp(\"\\\\$\\\\{([^\\\\{]+)\\\\}\");\nconst ALL_TYPE_PROPERTIES_EXP = new RegExp(\"^\\\\$\\\\[([^\\\\[\\\\]]+)\\\\]$\");\n\nfunction propertiesDeal(configObject, properties) {\n\tif(!properties) {\n\t\treturn configObject;\n\t}\n\n\tfunction replaceStringProperties(string, properties, property) {\n\t\tlet rs;\n\t\tlet str = string;\n\t\trs = ALL_TYPE_PROPERTIES_EXP.exec(str);\n\t\tif(rs) {\n\t\t\tlet propKey = rs[1];\n\t\t\tlet propValue = xsloader.getObjectAttr(properties, propKey);\n\t\t\tif(propValue === undefined) {\n\t\t\t\treturn str;\n\t\t\t} else {\n\t\t\t\treturn propValue;\n\t\t\t}\n\t\t}\n\n\t\tlet result = \"\";\n\t\twhile(true) {\n\t\t\trs = REPLACE_STRING_PROPERTIES_EXP.exec(str);\n\t\t\tif(!rs) {\n\t\t\t\tresult += str;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlet propKey = rs[1];\n\t\t\t\tif(property !== undefined && property.propertyKey == propKey) {\n\t\t\t\t\tthrow new Error(\"replace property error:propertyKey=\" + propKey);\n\t\t\t\t} else if(property) {\n\t\t\t\t\tproperty.has = true;\n\t\t\t\t}\n\t\t\t\tresult += str.substring(0, rs.index);\n\t\t\t\tresult += xsloader.getObjectAttr(properties, propKey);\n\t\t\t\tstr = str.substring(rs.index + rs[0].length);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\t//处理属性引用\n\tfunction replaceProperties(obj, property, enableKeyAttr) {\n\t\tif(!obj) {\n\t\t\treturn obj;\n\t\t}\n\t\tif(xsloader.isFunction(obj)) {\n\t\t\treturn obj;\n\t\t} else if(xsloader.isArray(obj)) {\n\t\t\tfor(let i = 0; i < obj.length; i++) {\n\t\t\t\tobj[i] = replaceProperties(obj[i], property, enableKeyAttr);\n\t\t\t}\n\t\t} else if(xsloader.isString(obj)) {\n\t\t\tobj = replaceStringProperties(obj, properties, property);\n\t\t} else if(xsloader.isObject(obj)) {\n\t\t\tif(property) {\n\t\t\t\tproperty.has = false;\n\t\t\t}\n\t\t\tlet replaceKeyMap = {};\n\t\t\tfor(let x in obj) {\n\t\t\t\tif(property) {\n\t\t\t\t\tproperty.propertyKey = x;\n\t\t\t\t}\n\t\t\t\tobj[x] = replaceProperties(obj[x], property, enableKeyAttr);\n\t\t\t\tif(enableKeyAttr) {\n\t\t\t\t\tlet _x = replaceStringProperties(x, properties, property);\n\t\t\t\t\tif(_x !== x) {\n\t\t\t\t\t\treplaceKeyMap[x] = _x;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(let x in replaceKeyMap) {\n\t\t\t\tlet objx = obj[x];\n\t\t\t\tdelete obj[x];\n\t\t\t\tobj[replaceKeyMap[x]] = objx;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\n\t}\n\n\tif(!properties.__dealt__) {\n\t\tlet property = {\n\t\t\thas: false\n\t\t};\n\n\t\tfor(let x in properties) {\n\t\t\tlet fun = properties[x];\n\t\t\tif(xsloader.isFunction(fun)) {\n\t\t\t\tproperties[x] = fun.call(properties);\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\treplaceProperties(properties, property);\n\t\t} while (property.has);\n\t\tproperties.__dealt__ = true;\n\t}\n\n\treturn replaceProperties(configObject, undefined, true);\n}\n\nfunction replaceModulePrefix(config, deps) {\n\n\tif(!deps) {\n\t\treturn;\n\t}\n\n\tfor(let i = 0; i < deps.length; i++) {\n\t\tlet m = deps[i];\n\t\tlet index = m.indexOf(\"!\");\n\t\tlet pluginParam = index > 0 ? m.substring(index) : \"\";\n\t\tm = index > 0 ? m.substring(0, index) : m;\n\n\t\tindex = m.indexOf(\"?\");\n\t\tlet query = index > 0 ? m.substring(index) : \"\";\n\t\tm = index > 0 ? m.substring(0, index) : m;\n\n\t\tlet isJsFile = isJsFile(m);\n\t\tif(!isJsFile && (xsloader.startsWith(m, \".\") || dealPathMayAbsolute(m).absolute)) {\n\t\t\tdeps[i] = m + \".js\" + query + pluginParam;\n\t\t}\n\t}\n\n\tif(config.modulePrefixCount) {\n\t\t//模块地址的前缀替换\n\t\tfor(let prefix in config.modulePrefix) {\n\t\t\tlet replaceStr = config.modulePrefix[prefix].replace;\n\t\t\tlet len = prefix.length;\n\t\t\tfor(let i = 0; i < deps.length; i++) {\n\t\t\t\tlet m = deps[i];\n\t\t\t\tlet pluginIndex = m.indexOf(\"!\");\n\t\t\t\tlet pluginName = null;\n\t\t\t\tif(pluginIndex >= 0) {\n\t\t\t\t\tpluginName = m.substring(0, pluginIndex + 1);\n\t\t\t\t\tm = m.substring(pluginIndex + 1);\n\t\t\t\t}\n\t\t\t\tif(xsloader.startsWith(m, prefix)) {\n\t\t\t\t\tlet dep = replaceStr + m.substring(len);\n\t\t\t\t\tdeps[i] = pluginName ? pluginName + dep : dep;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getScriptBySubname(subname) {\n\tlet ss = document.getElementsByTagName('script');\n\tif(subname) {\n\t\tfor(let i = 0; i < ss.length; i++) {\n\t\t\tlet script = ss[i];\n\t\t\tlet src = script.src;\n\t\t\tsrc = src.substring(src.lastIndexOf(\"/\"));\n\t\t\tif(src.indexOf(subname) >= 0) {\n\t\t\t\treturn script;\n\t\t\t}\n\t\t}\n\t} else {\n\t\treturn ss;\n\t}\n}\n\nexport default {\n\tgetPathWithRelative,\n\tgetNodeAbsolutePath,\n\tdealPathMayAbsolute,\n\tremoveQueryHash,\n\tpropertiesDeal,\n\treplaceModulePrefix,\n\tisJsFile,\n\tgetScriptBySubname,\n};","import global from './global.js';\nconst xsloader = global.xsloader;\n\n//基于有向图进行循环依赖检测\nfunction GraphPath() {\n\tlet pathEdges = {};\n\tlet vertexMap = {};\n\tlet depMap = {};\n\tthis.addEdge = function(begin, end) {\n\t\tdepMap[begin + \"|\" + end] = true;\n\t\tif(!pathEdges[begin]) {\n\t\t\tpathEdges[begin] = [];\n\t\t}\n\t\tif(!vertexMap[begin]) {\n\t\t\tvertexMap[begin] = true;\n\t\t}\n\t\tif(!vertexMap[end]) {\n\t\t\tvertexMap[end] = true;\n\t\t}\n\t\tpathEdges[begin].push({\n\t\t\tbegin: begin,\n\t\t\tend: end\n\t\t});\n\t};\n\n\tthis.hasDep = function(name, dep) {\n\t\treturn depMap[name + \"|\" + dep];\n\t};\n\n\tthis.tryAddEdge = function(begin, end) {\n\t\tthis.addEdge(begin, end);\n\t\tlet paths = this.hasLoop();\n\t\tif(paths.length > 0) {\n\t\t\tpathEdges[begin].pop();\n\t\t}\n\t\treturn paths;\n\t};\n\n\tthis.hasLoop = function() {\n\t\tlet visited = {};\n\t\tlet recursionStack = {};\n\n\t\tfor(let x in vertexMap) {\n\t\t\tvisited[x] = false;\n\t\t\trecursionStack[x] = false;\n\t\t}\n\n\t\tlet has = false;\n\t\tlet paths = [];\n\t\tfor(let name in vertexMap) {\n\t\t\tpaths = [];\n\t\t\tif(checkLoop(name, visited, recursionStack, paths)) {\n\t\t\t\thas = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn has ? paths : [];\n\t};\n\n\tfunction checkLoop(v, visited, recursionStack, paths) {\n\t\tif(!visited[v]) {\n\t\t\tvisited[v] = true;\n\t\t\trecursionStack[v] = true;\n\t\t\tpaths.push(v);\n\n\t\t\tif(pathEdges[v]) {\n\t\t\t\tlet edges = pathEdges[v];\n\t\t\t\tfor(let i = 0; i < edges.length; i++) {\n\t\t\t\t\tlet edge = edges[i];\n\t\t\t\t\tif(!visited[edge.end] && checkLoop(edge.end, visited, recursionStack, paths)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if(recursionStack[edge.end]) {\n\t\t\t\t\t\tpaths.push(edge.end);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trecursionStack[v] = false;\n\t\treturn false;\n\t}\n}\n\n//使得内部的字符串变成数组\nfunction strValue2Arr(obj) {\n\tif(!obj || xsloader.isArray(obj)) {\n\t\treturn;\n\t}\n\tfor(let x in obj) {\n\t\tif(xsloader.isString(obj[x])) {\n\t\t\tobj[x] = [obj[x]];\n\t\t}\n\t}\n}\n\nfunction each(ary, func, isSync, fromEnd) {\n\tif(ary) {\n\t\tif(isSync) {\n\t\t\tfunction fun(index) {\n\t\t\t\tif(fromEnd ? index < 0 : index >= ary.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet handle = function(rs) {\n\t\t\t\t\tif(rs) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfun(fromEnd ? index - 1 : index + 1);\n\t\t\t\t};\n\t\t\t\tfunc(ary[index], index, ary, handle);\n\t\t\t}\n\t\t\tfun(fromEnd ? ary.length - 1 : 0);\n\t\t} else {\n\t\t\tif(fromEnd) {\n\t\t\t\tfor(let i = ary.length - 1; i >= 0; i--) {\n\t\t\t\t\tif(func(ary[i], i, ary)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor(let i = 0; i < ary.length; i++) {\n\t\t\t\t\tif(func(ary[i], i, ary)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nexport default {\n\tgraphPath:new GraphPath(),\n\tstrValue2Arr,\n\teach\n};","import urls from './urls.js';\nimport global from './global.js';\nimport base from './base.js';\n\nexport default {\n\t...urls,\n\t...global,\n\t...base\n};","import utils from \"../util/index.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\nconst defContextName = \"xsloader1.1.x\";\nconst DATA_ATTR_MODULE = 'data-xsloader-module';\nconst DATA_ATTR_CONTEXT = \"data-xsloader-context\";\n\nconst isOpera = typeof opera !== 'undefined' && opera.toString() === '[object Opera]';\nconst readyRegExp = navigator.platform === 'PLAYSTATION 3' ? /^complete$/ : /^(complete|loaded)$/;\nconst theLoaderScript = document.currentScript || utils.getScriptBySubname(\"xsloader.js\");\nconst theLoaderUrl = utils.getNodeAbsolutePath(theLoaderScript);\nconst thePageUrl = (function() {\n\tlet url = location.href;\n\turl = utils.removeQueryHash(url);\n\treturn url;\n})();\n\nconst currentDefineModuleQueue = []; //当前回调的模块\ncurrentDefineModuleQueue.peek = function() {\n\tif(this.length > 0) {\n\t\treturn this[this.length - 1];\n\t}\n};\n\nlet lastAppendHeadDom = theLoaderScript;\nlet useDefineQueue;\nlet theRealDefine;\nif(utils.safariVersion > 0 && utils.safariVersion <= 7) {\n\tuseDefineQueue = [];\n}\n\n/**\n * 获取当前脚本，返回对象：\n * src:脚本绝对地址，不含参数\n * node:脚本dom对象\n * @param {Object} isRemoveQueryHash\n */\nfunction getCurrentScript(isRemoveQueryHash = true) {\n\tfunction _getCurrentScriptOrSrc() { //兼容获取正在运行的js\n\t\t//取得正在解析的script节点\n\t\tif(document.currentScript !== undefined) { //firefox 4+\n\t\t\tlet node = document.currentScript && document.currentScript.src && document.currentScript;\n\t\t\tif(node) {\n\t\t\t\treturn {\n\t\t\t\t\tnode,\n\t\t\t\t\tsrc: node.src\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tif(utils.IE_VERSION > 0 && utils.IE_VERSION <= 10) {\n\t\t\tlet nodes = document.getElementsByTagName(\"script\"); //只在head标签中寻找\n\t\t\tfor(let i = 0; i < nodes.length; i++) {\n\t\t\t\tlet node = nodes[i];\n\t\t\t\tif(node.readyState === \"interactive\") {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tsrc: node.src\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet stack;\n\t\ttry {\n\t\t\tlet a = undefined;\n\t\t\ta.b.c(); //强制报错,以便捕获e.stack\n\t\t} catch(e) { //safari的错误对象只有line,sourceId,sourceURL\n\t\t\tstack = e.stack || e.sourceURL || e.stacktrace || '';\n\t\t\tif(!stack && window.opera) {\n\t\t\t\t//opera 9没有e.stack,但有e.Backtrace,但不能直接取得,需要对e对象转字符串进行抽取\n\t\t\t\tstack = (String(e).match(/of linked script \\S+/g) || []).join(\" \");\n\t\t\t}\n\t\t}\n\t\tif(stack) {\n\t\t\t/**e.stack最后一行在所有支持的浏览器大致如下:\n\t\t\t *chrome23:\n\t\t\t * at http://113.93.50.63/data.js:4:1\n\t\t\t *firefox17:\n\t\t\t *@http://113.93.50.63/query.js:4\n\t\t\t *opera12:\n\t\t\t *@http://113.93.50.63/data.js:4\n\t\t\t *IE10:\n\t\t\t *  at Global code (http://113.93.50.63/data.js:4:1)\n\t\t\t */\n\t\t\tstack = stack.split(/[@ ]/g).pop(); //取得最后一行,最后一个空格或@之后的部分\n\t\t\tstack = stack[0] == \"(\" ? stack.slice(1, -1) : stack;\n\t\t\tlet s = stack.replace(/(:\\d+)?:\\d+$/i, \"\"); //去掉行号与或许存在的出错字符起始位置\n\t\t\treturn {\n\t\t\t\tsrc: s\n\t\t\t};\n\t\t}\n\t}\n\n\tlet rs = _getCurrentScriptOrSrc();\n\tif(rs) {\n\t\tif(!rs.node) {\n\t\t\tlet src = utils.removeQueryHash(rs.src);\n\t\t\tlet nodes = document.getElementsByTagName(\"script\"); //只在head标签中寻找\n\t\t\tfor(let i = 0; i < nodes.length; i++) {\n\t\t\t\tlet node = nodes[i];\n\t\t\t\tif(src == utils.removeQueryHash(node.src)) {\n\t\t\t\t\trs.node = node;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trs.src = utils.getNodeAbsolutePath(rs.src);\n\t\tif(isRemoveQueryHash) {\n\t\t\trs.src = utils.removeQueryHash(rs.src);\n\t\t}\n\t}\n\treturn rs;\n\n}\n\nfunction __createNode() {\n\tlet node = document.createElement('script');\n\tnode.type = 'text/javascript';\n\tnode.charset = 'utf-8';\n\tnode.async = true;\n\treturn node;\n}\n\nfunction __removeListener(node, func, name, ieName) {\n\tif(node.detachEvent && !isOpera) {\n\t\tif(ieName) {\n\t\t\tnode.detachEvent(ieName, func);\n\t\t}\n\t} else {\n\t\tnode.removeEventListener(name, func, false);\n\t}\n}\n\n/**\n * callbackObj.onScriptLoad\n * callbackObj.onScriptError\n *\n */\nfunction __browserLoader(moduleName, url, callbackObj) {\n\tlet node = __createNode();\n\tnode.setAttribute(DATA_ATTR_MODULE, moduleName);\n\tnode.setAttribute(DATA_ATTR_CONTEXT, defContextName);\n\tif(node.attachEvent &&\n\t\t!(node.attachEvent.toString && node.attachEvent.toString().indexOf('[native code') < 0) &&\n\t\t!isOpera) {\n\t\tnode.attachEvent('onreadystatechange', callbackObj.onScriptLoad);\n\t} else {\n\t\tnode.addEventListener('load', callbackObj.onScriptLoad, true);\n\t\tlet errListen = function() {\n\t\t\t__removeListener(node, errListen, 'error');\n\t\t\tcallbackObj.onScriptError.apply(this, arguments);\n\t\t};\n\t\tcallbackObj.errListen = errListen;\n\t\tnode.addEventListener('error', errListen, true);\n\t}\n\tnode.src = url;\n\tappendHeadDom(node);\n}\n\nfunction __getScriptData(evt, callbackObj) {\n\tlet node = evt.currentTarget || evt.srcElement;\n\t__removeListener(node, callbackObj.onScriptLoad, 'load', 'onreadystatechange');\n\t__removeListener(node, callbackObj.errListen, 'error');\n\treturn {\n\t\tnode: node,\n\t\tname: node && node.getAttribute(DATA_ATTR_MODULE),\n\t\tsrc: node && utils.getNodeAbsolutePath(node.src || node.getAttribute(\"src\"))\n\t};\n}\n\nfunction appendHeadDom(dom) {\n\tif(!xsloader.isDOM(dom)) {\n\t\tthrow new Error(\"expected dom object,but provided:\" + dom);\n\t}\n\tlet nextDom = lastAppendHeadDom.nextSibling;\n\tutils.head.insertBefore(dom, nextDom);\n\t//\t\t\thead.appendChild(dom);\n\tlastAppendHeadDom = dom;\n}\n\n/////////////////////////\n\nfunction loaderScript(moduleName, url, onload, onerror) {\n\tlet callbackObj = {};\n\tcallbackObj.onScriptLoad = function(evt) {\n\t\tif(callbackObj.removed) {\n\t\t\treturn;\n\t\t}\n\t\tif(evt.type === 'load' || (readyRegExp.test((evt.currentTarget || evt.srcElement).readyState))) {\n\t\t\tcallbackObj.removed = true;\n\t\t\tlet scriptData = __getScriptData(evt, callbackObj);\n\t\t\tif(useDefineQueue) {\n\t\t\t\tutils.each(useDefineQueue, (defineObject) => {\n\t\t\t\t\tdefineObject.src = scriptData.src;\n\t\t\t\t});\n\t\t\t\ttheRealDefine.define([...useDefineQueue]);\n\t\t\t}\n\n\t\t\tonload(scriptData);\n\t\t}\n\t};\n\tcallbackObj.onScriptError = function(evt) {\n\t\tif(callbackObj.removed) {\n\t\t\treturn;\n\t\t}\n\t\tcallbackObj.removed = true;\n\t\tlet scriptData = __getScriptData(evt, callbackObj);\n\t\tonerror(scriptData);\n\t};\n\t__browserLoader(moduleName, url, callbackObj);\n}\n\nfunction doDefine(thiz, args, isRequire) {\n\n\tlet defineObject = {\n\t\tthiz,\n\t\targs,\n\t\tsrc: undefined,\n\t\tisRequire,\n\t\tparentDefine: currentDefineModuleQueue.peek(),\n\t\thandle: {\n\t\t\tonError(err) {\n\n\t\t\t},\n\t\t\tbefore(deps) {},\n\t\t\tdepBefore(index, dep, depDeps) {},\n\t\t\torderDep: false,\n\t\t\tabsoluteUrl: undefined,\n\t\t\tinstance: undefined,\n\t\t}\n\t};\n\tif(!useDefineQueue) {\n\t\tdefineObject.src = getCurrentScript().src;\n\n\t\ttry { //防止执行其他脚本\n\t\t\tif(defineObject.src) {\n\t\t\t\tvar node = document.currentScript;\n\t\t\t\tif(node && node.getAttribute(\"src\") && node.getAttribute(DATA_ATTR_CONTEXT) != defContextName &&\n\t\t\t\t\tdefineObject.src != theLoaderUrl && defineObject.src != thePageUrl) {\n\t\t\t\t\tconsole.error(\"unknown js script module:\" + xsloader.xsJson2String(defineObject.src));\n\t\t\t\t\tconsole.error(node);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch(e) {\n\t\t\txsloader.config().error(e);\n\t\t}\n\n\t}\n\n\tlet handle = {\n\t\tthen(option) {\n\t\t\tdefineObject.handle = xsloader.extend(defineObject.handle, option);\n\t\t\treturn this;\n\t\t},\n\t\terror(onError) {\n\t\t\tdefineObject.handle.onError = onError;\n\t\t\treturn this;\n\t\t}\n\t};\n\n\txsloader.asyncCall(() => {\n\t\tif(useDefineQueue) {\n\t\t\tuseDefineQueue.push(defineObject);\n\t\t} else {\n\t\t\ttheRealDefine.define([defineObject]);\n\t\t}\n\t});\n\n\treturn handle;\n}\n\nfunction predefine() {\n\tlet args = [];\n\tfor(let i = 0; i < arguments.length; i++) {\n\t\targs.push(arguments[i]);\n\t}\n\treturn doDefine(this, args, false);\n}\n\nfunction prerequire() {\n\tthrow 'todo...';\n}\n\n//对于safari7-:在脚本加载事件中可获得正确的脚本地址\n\nconst initDefine = function(theDefine) {\n\ttheRealDefine = theDefine;\n\treturn {\n\t\tpredefine,\n\t\tprerequire,\n\t};\n};\n\nexport default {\n\tdefContextName,\n\ttheLoaderScript,\n\ttheLoaderUrl,\n\tthePageUrl,\n\tappendHeadDom,\n\tinitDefine,\n};","import utils from \"../util/index.js\";\nimport script from \"./script.js\";\nconst global = utils.global;\nconst xsloader = global.xsloader;\nconst theDefinedMap = {};\n\n/**\n *模块的名字来源：\n * 1、模块url地址:一定存在\n * 2、模块define时提供的：可选\n * 3、paths或depsPaths提供的：可选\n * 4、name!提供的：可选\n */\n/////////////////////////////////\n\nfunction getModule(nameOrUrl) {\n\tnameOrUrl = utils.removeUrlParam(nameOrUrl);\n\tlet m = theDefinedMap[nameOrUrl];\n\treturn m ? m.get() : null;\n}\n\nfunction setModule(nameOrUrl, m) {\n\tnameOrUrl = utils.removeUrlParam(nameOrUrl);\n\tlet last = theDefinedMap[nameOrUrl];\n\ttheDefinedMap[nameOrUrl] = m;\n\treturn last;\n}\n\nfunction buildInvoker(obj) {\n\tlet invoker = obj[\"thiz\"];\n\tlet module = obj.module || obj;\n\tlet id = xsloader.randId();\n\tinvoker.getId = function() {\n\t\treturn id;\n\t};\n\tinvoker.getUrl = function(relativeUrl, appendArgs, optionalAbsUrl) {\n\t\tif(optionalAbsUrl && !utils.dealPathMayAbsolute(optionalAbsUrl).absolute) {\n\t\t\tthrow new Error(-1, \"expected absolute url:\" + optionalAbsUrl)\n\t\t}\n\t\tif(appendArgs === undefined) {\n\t\t\tappendArgs = true;\n\t\t}\n\t\tlet url;\n\t\tif(relativeUrl === undefined) {\n\t\t\turl = this.getAbsoluteUrl();\n\t\t} else if(xsloader.startsWith(relativeUrl, \".\") || utils.dealPathMayAbsolute(relativeUrl).absolute) {\n\t\t\turl = utils.getPathWithRelative(optionalAbsUrl || this.rurl(), relativeUrl);\n\t\t} else {\n\t\t\turl = xsloader.config().baseUrl + relativeUrl;\n\t\t}\n\t\tif(appendArgs) {\n\t\t\tif(url == script.thePageUrl) {\n\t\t\t\turl += location.search + location.hash;\n\t\t\t}\n\t\t\treturn xsloader.config().dealUrl(module, url);\n\t\t} else {\n\t\t\treturn url;\n\t\t}\n\t};\n\tinvoker.require = function() {\n\t\tlet h = xsloader.require.apply(new _Async_Object_(invoker, false), arguments);\n\t\treturn h;\n\t};\n\tinvoker.define = function() {\n\t\tlet h = xsloader.define.apply(new _Async_Object_(invoker, false), arguments);\n\t\treturn h;\n\t};\n\tinvoker.rurl = function(thenOption) {\n\t\treturn thenOption && thenOption.absUrl() || this.absUrl() || this.getAbsoluteUrl();\n\t};\n\tinvoker.defineAsync = function() {\n\t\tlet thenOption = {\n\n\t\t};\n\t\tlet handle = {\n\t\t\tthen: function(option) {\n\t\t\t\tthenOption = xsloader.extend(thenOption, option);\n\t\t\t}\n\t\t}\n\t\tlet args = arguments;\n\t\tif(args.length < 0 || !xsloader.isString(args[0])) {\n\t\t\tthrowError(-1, \"expected module name from the first argument\");\n\t\t}\n\t\txsloader.asyncCall(function() {\n\t\t\tlet h = xsloader.define.apply(new _Async_Object_(invoker, true), args);\n\t\t\tif(thenOption) {\n\t\t\t\th.then(thenOption);\n\t\t\t}\n\t\t});\n\t\treturn handle;\n\t};\n\tinvoker.withAbsUrl = function(absoluteUrl) {\n\t\tlet newObj = {\n\t\t\tmodule: module,\n\t\t\tthiz: {\n\t\t\t\tgetAbsoluteUrl() {\n\t\t\t\t\treturn absoluteUrl;\n\t\t\t\t},\n\t\t\t\tabsUrl() {\n\t\t\t\t\treturn absoluteUrl;\n\t\t\t\t},\n\t\t\t\tgetName() {\n\t\t\t\t\treturn invoker.getName();\n\t\t\t\t},\n\t\t\t\tinvoker() {\n\t\t\t\t\treturn invoker.invoker();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tbuildInvoker(newObj);\n\t\treturn newObj.thiz;\n\t};\n};\n\nfunction _newModule(name, src, deps, absoluteUrl, thatInvoker, callback) {\n\tlet defineObject = {\n\t\tselfname: name,\n\t\tsrc,\n\t\tdeps,\n\t\tthatInvoker,\n\t\tcallback,\n\t\thandle: {\n\n\t\t}\n\t};\n\treturn newModule(defineObject);\n}\n\nfunction newModule(defineObject) {\n\n\tlet instances = []; //所有模块实例\n\tlet moduleMap = {\n\t\tid: idCount++,\n\t\tname: defineObject.selfname || defineObject.src,\n\t\tdeps: defineObject.deps || [],\n\t\trelys: [],\n\t\totherModule: undefined,\n\t\tdirectDefineIndex: 0, //模块直接声明的依赖开始索引\n\t\tignoreAspect: false,\n\t\tdepModules: null,\n\t\tsrc: null, //绝对路径,可能等于当前页面路径\n\t\tabsoluteUrl: defineObject.absoluteUrl,\n\t\tcallback: defineObject.callback,\n\t\t_loadCallback: null,\n\t\tmoduleObject: undefined, //依赖模块对应的对象\n\t\tloopObject: undefined, //循环依赖对象\n\t\tinvoker: defineObject.thatInvoker,\n\t\tinstanceType: \"single\",\n\t\tsetInstanceType(instanceType) {\n\t\t\tthis.instanceType = instanceType;\n\t\t},\n\t\t_singlePluginResult: {},\n\t\tlastSinglePluginResult(id, pluginArgs) {\n\t\t\tif(this._singlePluginResult[id]) {\n\t\t\t\treturn this._singlePluginResult[id][pluginArgs];\n\t\t\t}\n\t\t},\n\t\tsetSinglePluginResult(willCache, id, pluginArgs, obj) {\n\t\t\tif(willCache) {\n\t\t\t\tif(!this._singlePluginResult[id]) {\n\t\t\t\t\tthis._singlePluginResult[id] = {};\n\t\t\t\t}\n\t\t\t\tthis._singlePluginResult[id][pluginArgs] = obj;\n\t\t\t} else {\n\t\t\t\tif(this._singlePluginResult[id]) {\n\t\t\t\t\tdelete this._singlePluginResult[id][pluginArgs];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfinish(args) {\n\t\t\tif(this.directDefineIndex != 0) {\n\t\t\t\tlet _directArgs = [];\n\t\t\t\tfor(let i = this.directDefineIndex; i < args.length; i++) {\n\t\t\t\t\t_directArgs.push(args[i]);\n\t\t\t\t}\n\t\t\t\targs = _directArgs;\n\t\t\t}\n\t\t\tthis.depModules = args;\n\t\t\tlet obj;\n\t\t\tif(isFunction(this.callback)) {\n\t\t\t\ttry {\n\t\t\t\t\tcurrentDefineModuleQueue.push(this);\n\t\t\t\t\tobj = this.callback.apply(this.thiz, args);\n\t\t\t\t\tcurrentDefineModuleQueue.pop();\n\t\t\t\t} catch(e) {\n\t\t\t\t\tcurrentDefineModuleQueue.pop();\n\t\t\t\t\tconsole.error(\"error occured,invoker.url=\", this.invoker ? this.invoker.getUrl() : \"\");\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tthis.setState(\"error\", e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tobj = this.callback;\n\t\t\t\tif(this.moduleObject !== undefined) {\n\t\t\t\t\tconsole.log(\"ignore moudule named '\" + moduleMap.name + \"':\" + obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet isDefault = false;\n\t\t\tif(obj === undefined) {\n\t\t\t\tisDefault = true;\n\t\t\t\tobj = {\n\t\t\t\t\t__default: true\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(this.loopObject) {\n\t\t\t\tif(!isObject(obj)) {\n\t\t\t\t\tthrow new Error(\"循环依赖的模块必须是对象：\" + this.name);\n\t\t\t\t}\n\t\t\t\tfor(let x in obj) {\n\t\t\t\t\tthis.loopObject[x] = obj[x];\n\t\t\t\t}\n\t\t\t\tobj = this.loopObject;\n\t\t\t}\n\t\t\t//this.moduleObject不为undefined，则使用了exports\n\t\t\tif(this.moduleObject === undefined ||\n\t\t\t\t!isDefault && obj !== undefined //如果使用了return、则优先使用\n\t\t\t) {\n\t\t\t\tthis.moduleObject = obj;\n\t\t\t}\n\t\t\tthis.setState(\"defined\");\n\t\t},\n\t\tstate: \"init\", //init,loading,loaded,defined,error,\n\t\terrinfo: null,\n\t\t_callback(fun) {\n\t\t\tlet thiz = this;\n\t\t\tlet _state = thiz.state;\n\t\t\tif(_state == 'defined' || thiz.loopObject) {\n\t\t\t\tlet theCallback = function() {\n\t\t\t\t\tif(fun) {\n\t\t\t\t\t\tlet depModule = _newDepModule(thiz, fun.thatInvoker, fun.relyCallback, fun.pluginArgs);\n\t\t\t\t\t\tdepModule.init();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t//已经加载了模块，仍然需要判断为其另外设置的依赖模块是否已被加载\n\t\t\t\tlet deps = !thiz.loopObject && theConfig.getDeps(thiz.name);\n\t\t\t\t//console.log(this.name,\":\",deps);\n\t\t\t\t//deps=null;\n\t\t\t\tif(deps && deps.length > 0) {\n\t\t\t\t\txsloader.require(deps, function() {\n\t\t\t\t\t\ttheCallback();\n\t\t\t\t\t}).then({\n\t\t\t\t\t\tdefined_module_for_deps: thiz.name\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttheCallback();\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t} else if(_state == \"timeout\" || _state == \"error\") {\n\t\t\t\tif(fun) {\n\t\t\t\t\tfun.relyCallback(this, this.errinfo);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tsetState(_state, errinfo) {\n\t\t\tthis.state = _state;\n\t\t\tthis.errinfo = errinfo;\n\t\t\tif(!this._callback()) {\n\t\t\t\twhile(this.relys.length) {\n\t\t\t\t\tlet fun = this.relys.shift();\n\t\t\t\t\tthis._callback(fun);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tget() {\n\t\t\tif(this.otherModule) {\n\t\t\t\tthis.state = this.otherModule.state; //状态同步,保持与otherModule状态相同\n\t\t\t\treturn this.otherModule;\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t/**\n\t\t * 依赖当前模块、表示依赖otherModule模块，当前模块为别名或引用。\n\t\t * @param {Object} otherModule\n\t\t */\n\t\ttoOtherModule(otherModule) {\n\t\t\tthis.otherModule = otherModule;\n\t\t\tthis.get(); //状态同步\n\t\t\tlet theRelys = this.relys;\n\t\t\tthis.relys = [];\n\t\t\twhile(theRelys.length) {\n\t\t\t\tlet fun = theRelys.shift();\n\t\t\t\totherModule.relyIt(fun.thatInvoker, fun.relyCallback, fun.pluginArgs);\n\t\t\t}\n\t\t},\n\t\twhenNeed(loadCallback) {\n\t\t\tif(this.relys.length || this.otherModule && this.otherModule.relys.length) {\n\t\t\t\tloadCallback(); //已经被依赖了\n\t\t\t} else {\n\t\t\t\tthis._loadCallback = loadCallback;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * \n\t\t * @param {Object} thatInvoker\n\t\t * @param {Object} callbackFun function(depModule,err)\n\t\t * @param {Object} pluginArgs\n\t\t */\n\t\trelyIt(thatInvoker, callbackFun, pluginArgs) {\n\t\t\tif(this.otherModule) {\n\t\t\t\tthis.get(); //状态同步\n\t\t\t\tthis.otherModule.relyIt(thatInvoker, callbackFun, pluginArgs); //传递给otherModule\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet fun = {\n\t\t\t\tthatInvoker: thatInvoker,\n\t\t\t\trelyCallback: callbackFun,\n\t\t\t\tpluginArgs: pluginArgs\n\t\t\t};\n\t\t\tif(this._callback(fun)) {\n\t\t\t\tthis.relys.push(fun);\n\t\t\t}\n\t\t\tif(this._loadCallback) { //将会加载此模块及其依赖的模块\n\t\t\t\tlet loadCallback = this._loadCallback;\n\t\t\t\tthis._loadCallback = null;\n\t\t\t\tloadCallback();\n\t\t\t}\n\t\t},\n\t\tthiz: {\n\t\t\tgetAbsoluteUrl() {\n\t\t\t\treturn moduleMap.src;\n\t\t\t},\n\t\t\tgetName() {\n\t\t\t\treturn moduleMap.name;\n\t\t\t},\n\t\t\tinvoker() {\n\t\t\t\treturn moduleMap.invoker;\n\t\t\t},\n\t\t\tabsUrl() { //用于获取其他模块地址的参考路径\n\t\t\t\treturn moduleMap.absoluteUrl;\n\t\t\t}\n\t\t}\n\t};\n\n\t//返回_module_\n\tmoduleMap.dealInstance = function(moduleInstance) {\n\t\tinstances.push(moduleInstance);\n\t\tlet _module_ = {\n\t\t\topId: null,\n\t\t\tsetToAll(name, value, opId) {\n\t\t\t\tif(opId !== undefined && opId == this.opId) {\n\t\t\t\t\treturn; //防止循环\n\t\t\t\t}\n\t\t\t\topId = opId || _getModuleId();\n\t\t\t\tthis.opId = opId;\n\n\t\t\t\tlet obj = {};\n\t\t\t\tif(isString(name)) {\n\t\t\t\t\tobj[name] = value;\n\t\t\t\t} else if(isObject(name)) {\n\t\t\t\t\tfor(let k in name) {\n\t\t\t\t\t\tobj[k] = name[k];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"unknown param:\" + name);\n\t\t\t\t}\n\n\t\t\t\tutils.each(instances, function(ins) {\n\t\t\t\t\tlet mobj = ins.moduleObject();\n\t\t\t\t\tfor(let k in obj) {\n\t\t\t\t\t\tmobj[k] = obj[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(mobj._modules_) {\n\t\t\t\t\t\teach(mobj._modules_, function(_m_) {\n\t\t\t\t\t\t\t_m_.setToAll(name, value, opId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t};\n\n\t\treturn _module_;\n\t};\n\n\t//添加到前面\n\tmoduleMap.mayAddDeps = function(deps) {\n\t\tlet moduleDeps = this.deps;\n\t\tutils.each(moduleDeps, function(dep) {\n\t\t\tif(indexInArray(deps, dep) < 0) {\n\t\t\t\tdeps.push(dep);\n\t\t\t}\n\t\t}, false, true);\n\t\tthis.deps = deps;\n\t\treturn deps;\n\t};\n\tmoduleMap.printOnNotDefined = function() {\n\t\tlet root = {\n\t\t\tnodes: []\n\t\t};\n\t\tthis._printOnNotDefined(root);\n\n\t\tlet leafs = [];\n\n\t\tfunction findLeaf(node) {\n\t\t\tif(node.nodes.length) {\n\t\t\t\teach(node.nodes, function(item) {\n\t\t\t\t\tfindLeaf(item);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tleafs.push(node);\n\t\t\t}\n\t\t}\n\t\tfindLeaf(root);\n\n\t\tfunction genErrs(node, infos) {\n\t\t\tinfos.push(node.err);\n\t\t\tif(node.parent) {\n\t\t\t\tgenErrs(node.parent, infos);\n\t\t\t}\n\t\t}\n\t\tutils.each(leafs, function(leaf) {\n\t\t\tlet infos = [];\n\t\t\tgenErrs(leaf, infos);\n\t\t\tinfos = infos.reverse();\n\t\t\tconsole.error(\"load module error stack:my page=\" + location.href);\n\t\t\tfor(let i = 1; i < infos.length;) {\n\t\t\t\tlet as = [];\n\t\t\t\tas.push(\"\");\n\t\t\t\tfor(let k = 0; k < 3 && i < infos.length; k++) {\n\t\t\t\t\tas.push(infos[i++]);\n\t\t\t\t}\n\t\t\t\tconsole.info(as.join(\"--->\"));\n\t\t\t}\n\t\t\tlet errModule = leaf.module;\n\t\t\tif(leaf.module && leaf.module.state == \"defined\") {\n\t\t\t\terrModule = leaf.parent.module;\n\t\t\t}\n\t\t\tif(errModule) {\n\t\t\t\tlet as = [];\n\t\t\t\tfor(let i = 0; i < errModule.deps.length; i++) {\n\t\t\t\t\tlet dep = errModule.deps[i];\n\t\t\t\t\tlet index = dep.lastIndexOf(\"!\");\n\t\t\t\t\tif(index != -1) {\n\t\t\t\t\t\tdep = dep.substring(0, index);\n\t\t\t\t\t}\n\t\t\t\t\tlet depMod = theDefinedMap[dep];\n\t\t\t\t\tif(depMod) {\n\t\t\t\t\t\tas.push(dep + \":\" + depMod.state);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tas.push(dep + \":null\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.info(\"failed module '\" + errModule.name + \"' deps state infos [\" + as.join(\",\") + \"]\");\n\t\t\t}\n\t\t});\n\n\t};\n\tmoduleMap._printOnNotDefined = function(parentNode) {\n\t\tlet node = {\n\t\t\terr: \"[\" + this.name + \"].state=\" + this.state,\n\t\t\tmodule: this,\n\t\t\tparent: parentNode,\n\t\t\tnodes: []\n\t\t};\n\t\tparentNode.nodes.push(node);\n\t\tif(this.state == \"defined\") {\n\t\t\treturn;\n\t\t}\n\n\t\tutils.each(this.deps, function(dep) {\n\t\t\tlet indexPlguin = dep.indexOf(\"!\");\n\t\t\tif(indexPlguin > 0) {\n\t\t\t\tdep = dep.substring(0, indexPlguin);\n\t\t\t}\n\t\t\tlet mod = getModule(dep);\n\t\t\tif(mod && mod.state == \"defined\") {\n\t\t\t\tmod._printOnNotDefined(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//只打印一个错误栈\n\t\t\tif(mod) {\n\t\t\t\tmod._printOnNotDefined(node);\n\t\t\t} else {\n\t\t\t\tnode.nodes.push({\n\t\t\t\t\tparent: parentNode,\n\t\t\t\t\tnodes: [],\n\t\t\t\t\terr: \"[\" + dep + \"] has not module\"\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\tsetModule(moduleMap.name, moduleMap);\n\n\tif(module.src != module.name) {\n\t\tsetModule(moduleMap.src, moduleMap);\n\t}\n\n\tbuildInvoker(moduleMap);\n\treturn moduleMap;\n}\n\nlet randModuleIndex = 0;\n\nfunction _getModuleId() {\n\treturn \"_xs_req_2019_\" + randModuleIndex++;\n}\n//处理嵌套依赖\nfunction _dealEmbedDeps(deps) {\n\tfor(let i = 0; i < deps.length; i++) {\n\t\tlet dep = deps[i];\n\t\tif(isArray(dep)) {\n\t\t\t//内部的模块顺序加载\n\t\t\tlet modName = \"inner_order_\" + _getModuleId();\n\t\t\tlet isOrderDep = !(dep.length > 0 && dep[0] === false);\n\t\t\tif(dep.length > 0 && (dep[0] === false || dep[0] === true)) {\n\t\t\t\tdep = dep.slice(1);\n\t\t\t}\n\t\t\tinnerDepsMap[modName] = {\n\t\t\t\tdeps: dep,\n\t\t\t\torderDep: isOrderDep\n\t\t\t};\n\n\t\t\t//console.log(innerDepsMap[modName]);\n\t\t\tdeps[i] = INNER_DEPS_PLUGIN + \"!\" + modName;\n\t\t}\n\t}\n}\n\nfunction _getPluginParam(path) {\n\tvar pluginIndex = path.indexOf(\"!\");\n\tif(pluginIndex > 0) {\n\t\treturn path.substring(pluginIndex);\n\t} else {\n\t\treturn \"\";\n\t}\n}\n\n//everyOkCallback(depModules,module),errCallback(err,invoker)\nfunction everyRequired(defineObject, module, everyOkCallback, errCallback) {\n\t//data, thenOption, module, deps, \n\tif(defineObject.isError) {\n\t\treturn;\n\t}\n\n\tlet config = xsloader.config();\n\tlet context = theContext;\n\tconst deps = module.deps;\n\n\tutils.replaceModulePrefix(config, deps); //前缀替换\n\t_dealEmbedDeps(deps); //处理嵌套依赖\n\n\tfor(let i = 0; i < deps.length; i++) {\n\t\t//console.log(module.name+(\"(\"+thenOption.defined_module_for_deps+\")\"), \":\", deps);\n\t\tlet m = deps[i];\n\t\tlet jsFilePath = utils.isJsFile(m);\n\n\t\tif(module.thiz.rurl(thenOption)) { //替换相对路径为绝对路径\n\t\t\tif(jsFilePath && xsloader.startsWith(m, \".\")) {\n\t\t\t\tm = utils.getPathWithRelative(module.thiz.rurl(thenOption), jsFilePath.path) + _getPluginParam(m);\n\t\t\t\tdeps[i] = m;\n\t\t\t}\n\t\t}\n\t\tlet paths = utils.graphPath.tryAddEdge(thenOption.defined_module_for_deps || module.name, m);\n\t\tif(paths.length > 0) {\n\t\t\tlet moduleLoop = getModule(m); //该模块必定已经被定义过\n\t\t\tmoduleLoop.loopObject = {};\n\t\t}\n\t}\n\n\tlet isError = false,\n\t\thasCallErr = false,\n\t\ttheExports;\n\tlet depCount = deps.length;\n\t//module.jsScriptCount = 0;\n\tlet depModules = new Array(depCount);\n\n\tlet invoker_the_module = module.thiz;\n\n\tfunction checkFinish(index, dep_name, depModule, syncHandle) {\n\t\tdepModules[index] = depModule;\n\n\t\tif( /*(depCount == 0 || depCount - module.jsScriptCount == 0)*/ depCount <= 0 && !isError) {\n\t\t\teveryOkCallback(depModules, module);\n\t\t} else if(isError) {\n\t\t\tmodule.setState('error', isError);\n\t\t\tif(!hasCallErr) {\n\t\t\t\thasCallErr = true;\n\t\t\t\terrCallback({\n\t\t\t\t\terr: isError,\n\t\t\t\t\tindex: index,\n\t\t\t\t\tdep_name: dep_name\n\t\t\t\t}, invoker_the_module);\n\t\t\t}\n\t\t}!isError && syncHandle && syncHandle();\n\t}\n\n\tutils.each(deps, function(dep, index, ary, syncHandle) {\n\t\tlet originDep = dep;\n\t\tlet pluginArgs = undefined;\n\t\tlet pluginIndex = dep.indexOf(\"!\");\n\t\tif(pluginIndex > 0) {\n\t\t\tpluginArgs = dep.substring(pluginIndex + 1);\n\t\t\tdep = dep.substring(0, pluginIndex);\n\t\t}\n\t\tlet relyItFun = function() {\n\t\t\tgetModule(dep).relyIt(invoker_the_module, function(depModule, err) {\n\n\t\t\t\tif(!err) {\n\t\t\t\t\tdepCount--;\n\t\t\t\t\tif(dep == \"exports\") {\n\t\t\t\t\t\tif(theExports) {\n\t\t\t\t\t\t\tmodule.moduleObject = theExports;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttheExports = module.moduleObject = depModule.genExports();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisError = err;\n\t\t\t\t}\n\t\t\t\tcheckFinish(index, originDep, depModule, syncHandle);\n\t\t\t}, pluginArgs);\n\t\t};\n\n\t\tif(!getModule(dep)) {\n\t\t\tlet isJsFile = utils.isJsFile(dep);\n\t\t\tdo {\n\n\t\t\t\tlet willDelay = false;\n\t\t\t\tlet urls;\n\t\t\t\tlet _deps = config.getDeps(dep); //未加载模块前，获取其依赖\n\t\t\t\tif(defineObject.handle.depBefore) {\n\t\t\t\t\tdefineObject.handle.depBefore(index, dep, _deps, 1);\n\t\t\t\t}\n\n\t\t\t\tif(!isJsFile && dep.indexOf(\"/\") < 0 && dep.indexOf(\":\") >= 0) {\n\t\t\t\t\tlet i1 = dep.indexOf(\":\");\n\t\t\t\t\tlet i2 = dep.indexOf(\":\", i1 + 1);\n\t\t\t\t\tlet i3 = i2 > 0 ? dep.indexOf(\":\", i2 + 1) : -1;\n\t\t\t\t\tif(i2 == -1) {\n\t\t\t\t\t\tisError = \"illegal module:\" + dep;\n\t\t\t\t\t\terrCallback(isError, invoker_the_module);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlet version;\n\t\t\t\t\tlet groupModule;\n\t\t\t\t\tif(i3 == -1) {\n\t\t\t\t\t\tversion = config.defaultVersion[dep];\n\t\t\t\t\t\tgroupModule = dep + \":\" + version;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tversion = dep.substring(i3 + 1);\n\t\t\t\t\t\tgroupModule = dep;\n\t\t\t\t\t}\n\t\t\t\t\tif(version === undefined) {\n\t\t\t\t\t\tisError = \"unknown version for:\" + dep;\n\t\t\t\t\t\terrCallback(isError, invoker_the_module);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlet _url = xsloader._resUrlBuilder(groupModule);\n\t\t\t\t\turls = isArray(_url) ? _url : [_url];\n\t\t\t\t} else if(config.isInUrls(dep)) {\n\t\t\t\t\turls = config.getUrls(dep);\n\t\t\t\t} else if(isJsFile) {\n\t\t\t\t\turls = [dep];\n\t\t\t\t} else {\n\t\t\t\t\twillDelay = true; //延迟加载\n\t\t\t\t\turls = [];\n\t\t\t\t}\n\n\t\t\t\t//(name, src, deps, absoluteUrl, thatInvoker, callback)\n\t\t\t\tlet module2 = _newModule(dep, undefined, _deps, null, module.thiz);\n\t\t\t\tif(willDelay && _deps.length == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tmodule2.setState(\"loading\");\n\t\t\t\tutils.each(urls, function(url, index) {\n\t\t\t\t\tif(xsloader.startsWith(url, \".\") || xsloader.startsWith(url, \"/\")) {\n\t\t\t\t\t\tif(!module2.thiz.rurl(thenOption)) {\n\t\t\t\t\t\t\tisError = \"script url is null:'\" + module2.name + \"',\" + module2.callback;\n\t\t\t\t\t\t\tthrow new Error(-11, isError);\n\t\t\t\t\t\t}\n\t\t\t\t\t\turl = utils.getPathWithRelative(module2.thiz.rurl(thenOption), url);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet absolute = utils.dealPathMayAbsolute(url);\n\t\t\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\t\t\turl = absolute.path;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\turl = config.baseUrl + url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\turls[index] = config.dealUrl(module2, url);\n\t\t\t\t});\n\n\t\t\t\tif(_deps.length > 0) {\n\t\t\t\t\txsloader.require.call(defineObject, _deps, (_depModules) => {\n\t\t\t\t\t\tlet depModules = _depModules.slice(_deps.length);\n\t\t\t\t\t\tlet args = [];\n\t\t\t\t\t\tlet hasExports = false;\n\t\t\t\t\t\tutils.each(depModules, function(depModule) {\n\t\t\t\t\t\t\targs.push(depModule && depModule.moduleObject());\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmayAsyncCallLoadModule();\n\t\t\t\t\t}).then({\n\t\t\t\t\t\terror(err, invoker) {\n\t\t\t\t\t\t\tisError = err;\n\t\t\t\t\t\t\terrCallback(err, invoker);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tmayAsyncCallLoadModule();\n\t\t\t\t}\n\n\t\t\t\tfunction mayAsyncCallLoadModule() {\n\t\t\t\t\tif(IE_VERSION > 0 && IE_VERSION <= 10) {\n\t\t\t\t\t\tasyncCall(function() {\n\t\t\t\t\t\t\tloadModule();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tloadModule();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t//加载模块dep:module2\n\t\t\t\tfunction loadModule(index = 0) {\n\t\t\t\t\tif(index >= urls.length) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet url=urls[index];\n\t\t\t\t}\n\n\t\t\t} while (false);\n\t\t}\n\t\trelyItFun();\n\t}, defineObject.handle.orderDep);\n\t//TODO STRONG ie10及以下版本，js文件一个一个加载，从而解决缓存等造成的混乱问题\n}\n\nexport default {\n\tsetModule,\n\tnewModule,\n\tgetModule,\n\teveryRequired,\n};","import utils from \"../util/index.js\";\nimport script from \"./script.js\";\nimport moduleScript from \"./module.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\nconst theDefinedMap = {};\n\nconst defineHandle = script.initDefine(function theRealDefine(defines) {\n\tutils.eache(defines, (defineObject) => {\n\t\tlet {\n\t\t\tthiz,\n\t\t\targs,\n\t\t\tsrc, //必存在src\n\t\t\tisRequire,\n\t\t\tparentDefine,\n\t\t\thandle: {\n\t\t\t\tonError,\n\t\t\t\tbefore,\n\t\t\t\tdepBefore,\n\t\t\t\torderDep,\n\t\t\t\tabsoluteUrl,\n\t\t\t\tinstance,\n\t\t\t},\n\t\t} = defineObject;\n\t\tdefineObject.thatInvoker = getThatInvokerForDef_Req(thiz);\n\n\t\tlet [selfname, deps, callback] = args;\n\n\t\tif(typeof selfname !== 'string') {\n\t\t\tcallback = deps;\n\t\t\tdeps = selfname;\n\t\t\tselfname = src;\n\t\t}\n\n\t\tif(!utils.isArray(deps)) {\n\t\t\tcallback = deps;\n\t\t\tdeps = null;\n\t\t}\n\n\t\tif(!deps) {\n\t\t\tdeps = [];\n\t\t}\n\n\t\tif(!isRequire) {\n\t\t\txsloader.appendInnerDeps(deps, callback);\n\t\t}\n\n\t\tif(xsloader.isFunction(callback)) {\n\t\t\tlet originCallback = callback;\n\t\t\tcallback = function() {\n\t\t\t\tlet config = script.getConfig();\n\t\t\t\tlet rt;\n\t\t\t\tif(xsloader.isFunction(config.defineFunction[cache.name])) {\n\t\t\t\t\tlet args = [];\n\t\t\t\t\tfor(let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\targs.push(arguments[i]);\n\t\t\t\t\t}\n\t\t\t\t\trt = config.defineFunction[cache.name].apply(this, [originCallback, this, args]);\n\t\t\t\t} else {\n\t\t\t\t\trt = originCallback.apply(this, arguments);\n\t\t\t\t}\n\n\t\t\t\toriginCallback = null;\n\t\t\t\treturn rt;\n\t\t\t};\n\t\t\tcallback.originCallback = originCallback;\n\t\t}\n\t\tdefineObject.selfname = selfname;\n\t\tdefineObject.deps = deps;\n\t\tdefineObject.callback = callback;\n\t\tonModuleLoaded(defineObject);\n\n\t});\n});\n\n/**\n * 当前模块脚本已经完成加载、但其依赖的模块可能需要加载。\n * 当前模块：src、selfname已经确定。\n * 若当前模块依赖为0、则可以直接finish；若当前模块存在其他依赖、则设置回调，等待被其他地方依赖时再触发。\n * @param {Object} defineObject 当前模块\n * @param {Object} lastDefineObject 第一次加载当前模块的模块\n */\nfunction onModuleLoaded(defineObject, lastDefineObject) {\n\t//moduleName, cache, aurl, isRequire, lastThenOptionObj\n\n\t//判断模块是否已经被定义\n\tif(defineObject.selfname) {\n\t\tlet ifmodule = moduleScript.getModule(defineObject.selfname);\n\t\tif(ifmodule && ifmodule.state != 'loading' && ifmodule.state != 'init') {\n\t\t\tlet lastModule = ifmodule;\n\t\t\tif(lastModule.src == defineObject.src) { //已经加载过js模块\n\t\t\t\ttry {\n\t\t\t\t\tconsole.warn(\"already loaded js:\" + aurl);\n\t\t\t\t} catch(e) {\n\t\t\t\t\t//TODO handle the exception\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(\"already define '\" + moduleName + \"'\");\n\t\t}\n\t}\n\n\tlet module = moduleScript.getModule(defineObject.selfname || defineObject.src);\n\tif(!module) {\n\t\tmodule = moduleScript.newModule(defineObject);\n\t} else {\n\t\t//defineObject里的deps最初是直接声明的依赖,应该出现在最前面\n\t\tmodule.mayAddDeps(defineObject.deps);\n\t}\n\n\tif(defineObject.handle.before) {\n\t\tdefineObject.before(module.deps);\n\t}\n\tif(lastDefineObject && lastDefineObject.handle.depBefore) {\n\t\tlastDefineObject.handle.depBefore(lastDefineObject.index, module.name, module.deps, 2);\n\t}\n\n\tif(xsloader._ignoreAspect_[module.name]) {\n\t\tmodule.ignoreAspect = true;\n\t}\n\n\tif(cache.selfname && cache.selfname != cache.name) {\n\t\tvar moduleSelf = getModule(cache.selfname);\n\t\tif(moduleSelf) {\n\t\t\tif(moduleSelf.state == \"init\") {\n\t\t\t\tsetModule(cache.selfname, module);\n\t\t\t\tmoduleSelf.toOtherModule(module);\n\t\t\t} else if(moduleSelf.cacheId == cache.id) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tthrowError(-2, \"already define '\" + cache.selfname + \"'\");\n\t\t\t}\n\t\t} else {\n\t\t\tsetModule(cache.selfname, module);\n\t\t}\n\t}\n\n\tmodule.setState(\"loaded\");\n\tmodule.setInstanceType(defineObject.handle.instance || xsloader.config().instance);\n\n\tif(deps.length == 0) {\n\t\tmodule.finish([]); //递归结束\n\t} else {\n\t\t//在其他模块依赖此模块时进行加载\n\t\tlet needCallback = function() {\n\t\t\tmoduleScript.everyRequired(defineObject, module, (depModules) => {\n\t\t\t\tlet args = [];\n\t\t\t\tlet depModuleArgs = [];\n\t\t\t\tutils.each(depModules, (depModule) => {\n\t\t\t\t\tdepModuleArgs.push(depModule);\n\t\t\t\t\targs.push(depModule && depModule.moduleObject());\n\t\t\t\t});\n\t\t\t\targs.push(depModuleArgs);\n\t\t\t\tmodule.finish(args);\n\t\t\t}, (err, invoker) => {\n\t\t\t\tthenOption.onError(err, invoker);\n\t\t\t});\n\t\t};\n\n\t\tif(defineObject.isRequire) {\n\t\t\tneedCallback();\n\t\t} else {\n\t\t\tmodule.whenNeed(needCallback);\n\t\t}\n\t}\n\n};\n\n//定义模块\nexport const define = function() {\n\treturn defineHandle.predefine.apply(this, arguments);\n}\n\nexport const require = function() {\n\treturn defineHandle.prerequire.apply(this, arguments);\n}\n\nxsloader.define = define;\nxsloader.defineAsync = define;\nxsloader.require = require;","import utils from \"../util/index.js\";\nimport script from \"./script.js\";\nimport \"./define.js\";\n\nconst global = utils.global;\n\nlet theContext;\nlet theConfig;\nlet globalDefineQueue = []; //在config之前，可以调用define来定义模块\nlet requiresQueueBeforeConf = []; //配置前的require\nlet argsObject = {};\n\nfunction _newContext() {\n\tlet context = {\n\t\tcontextName: script.contextName,\n\t\tdefQueue: []\n\t};\n\treturn context;\n}\n\nlet xsloader = global.xsloader = function(option) {\n\tif(theContext) {\n\t\tthrow new Error(\"already configed!\");\n\t}\n\toption = xsloader.extend({\n\t\tbaseUrl: utils.getPathWithRelative(location.pathname, \"./\", xsloader.endsWith(location.pathname, \"/\")),\n\t\turlArgs: {},\n\t\tignoreProperties: false,\n\t\tpaths: {},\n\t\tdepsPaths: {},\n\t\tdeps: {},\n\t\tjsExts: undefined,\n\t\tproperties: {},\n\t\tmodulePrefix: {},\n\t\tdefineFunction: {},\n\t\tmodulePrefixCount: 0,\n\t\twaitSeconds: 10,\n\t\tautoUrlArgs() {\n\t\t\treturn false;\n\t\t},\n\t\tinstance: \"single\",\n\t\tdealtDeps: {},\n\t\tdealProperties(obj) {\n\t\t\treturn utils.propertiesDeal(obj, option.properties);\n\t\t},\n\t\tisInUrls(m) {\n\t\t\treturn !!this.getUrls(m);\n\t\t},\n\t\tgetUrls(m) {\n\t\t\treturn this.paths[m] || this.depsPaths[m];\n\t\t},\n\t\tgetDeps(m) {\n\t\t\tlet as = this.dealtDeps[m] || [];\n\t\t\tlet deps = [];\n\t\t\tlet hasOrderDep = undefined;\n\n\t\t\tif(as.length > 0 && (as[0] === true || as[0] === false)) {\n\t\t\t\tif(as[0]) {\n\t\t\t\t\tdeps = [\n\t\t\t\t\t\t[]\n\t\t\t\t\t];\n\t\t\t\t\thasOrderDep = true;\n\t\t\t\t} else {\n\t\t\t\t\tas.splice(0, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(let i = 0; i < as.length; i++) {\n\t\t\t\tif(hasOrderDep === true) {\n\t\t\t\t\tdeps[0].push(as[i]);\n\t\t\t\t} else {\n\t\t\t\t\tdeps.push(as[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn deps;\n\t\t},\n\t\tdealUrl(module, url) {\n\t\t\tlet urlArg;\n\t\t\tlet nameOrUrl;\n\t\t\tif(this.autoUrlArgs()) {\n\t\t\t\turlArg = \"_t=\" + new Date().getTime();\n\t\t\t} else if(xsloader.isString(module)) {\n\t\t\t\turlArg = this.urlArgs[module];\n\t\t\t\tif(urlArg) {\n\t\t\t\t\tnameOrUrl = module;\n\t\t\t\t} else {\n\t\t\t\t\tnameOrUrl = module;\n\t\t\t\t\turlArg = this.forPrefixSuffix(module);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = \"*\";\n\t\t\t\t\turlArg = this.urlArgs[\"*\"];\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\turlArg = this.urlArgs[url];\n\t\t\t\tif(urlArg) {\n\t\t\t\t\tnameOrUrl = url;\n\t\t\t\t} else {\n\t\t\t\t\turlArg = this.forPrefixSuffix(url);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = module.name;\n\t\t\t\t\turlArg = this.urlArgs[nameOrUrl];\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = module.aurl;\n\t\t\t\t\turlArg = this.forPrefixSuffix(nameOrUrl);\n\t\t\t\t}\n\n\t\t\t\tif(!urlArg) {\n\t\t\t\t\tnameOrUrl = \"*\";\n\t\t\t\t\turlArg = this.urlArgs[\"*\"];\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif(xsloader.isFunction(urlArg)) {\n\t\t\t\turlArg = urlArg.call(this, nameOrUrl);\n\t\t\t}\n\t\t\tfor(let k in argsObject) { //加入全局的参数\n\t\t\t\turlArg += \"&\" + k + \"=\" + encodeURIComponent(argsObject[k]);\n\t\t\t}\n\t\t\treturn xsloader.appendArgs2Url(url, urlArg);\n\t\t},\n\t\tdealUrlArgs(url) {\n\t\t\turl = utils.getPathWithRelative(location.href, url);\n\t\t\treturn this.dealUrl(url, url);\n\t\t},\n\t\tdefaultVersion: {}\n\t}, option);\n\n\tif(!xsloader.endsWith(option.baseUrl, \"/\")) {\n\t\toption.baseUrl += \"/\";\n\t}\n\toption.baseUrl = utils.getPathWithRelative(location.href, option.baseUrl);\n\n\tif(!option.ignoreProperties) {\n\t\toption = option.dealProperties(option);\n\t}\n\n\tutils.strValue2Arr(option.paths);\n\tutils.strValue2Arr(option.depsPaths);\n\tutils.strValue2Arr(option.deps);\n\n\tif(!xsloader.isFunction(option.autoUrlArgs)) {\n\t\tlet isAutoUrlArgs = option.autoUrlArgs;\n\t\toption.autoUrlArgs = function() {\n\t\t\treturn isAutoUrlArgs;\n\t\t};\n\t}\n\n\tlet modulePrefixCount = 0;\n\tfor(let prefix in option.modulePrefix) {\n\t\tif(xsloader.startsWith(prefix, \".\") || xsloader.startsWith(prefix, \"/\")) {\n\t\t\tthrow new Error(\"modulePrefix can not start with '.' or '/'(\" + prefix + \")\");\n\t\t}\n\t\tmodulePrefixCount++;\n\t}\n\toption.modulePrefixCount = modulePrefixCount;\n\tif(modulePrefixCount > 0) {\n\t\t//替换urlArgs中地址前缀\n\t\tlet star = option.urlArgs[\"*\"];\n\t\tdelete option.urlArgs[\"*\"];\n\n\t\tlet urlArgsArr = [];\n\t\tfor(let k in option.urlArgs) {\n\t\t\tlet url = k;\n\t\t\tif(utils.isJsFile(url)) { //处理相对\n\t\t\t\tif(xsloader.startsWith(url, \".\") || xsloader.startsWith(url, \"/\") && !xsloader.startsWith(url, \"//\")) {\n\t\t\t\t\turl = utils.getPathWithRelative(theLoaderUrl, url);\n\t\t\t\t} else {\n\t\t\t\t\tlet absolute = utils.dealPathMayAbsolute(url);\n\t\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\t\turl = absolute.path;\n\t\t\t\t\t} else if(!xsloader.startsWith(url, \"*]\")) { //排除*]；单*[可以有前缀\n\t\t\t\t\t\turl = option.baseUrl + url;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\turlArgsArr.push({\n\t\t\t\turl: url,\n\t\t\t\targs: option.urlArgs[k]\n\t\t\t});\n\t\t}\n\n\t\tfor(let prefix in option.modulePrefix) {\n\t\t\tlet replaceStr = option.modulePrefix[prefix].replace;\n\t\t\tfor(let i = 0; i < urlArgsArr.length; i++) {\n\t\t\t\tlet urlArgObj = urlArgsArr[i];\n\t\t\t\tlet starP = \"\";\n\t\t\t\tif(xsloader.startsWith(urlArgObj.url, \"*[\")) {\n\t\t\t\t\tstarP = \"*[\";\n\t\t\t\t\turlArgObj.url = urlArgObj.url.substring(2);\n\t\t\t\t}\n\t\t\t\tif(xsloader.startsWith(urlArgObj.url, prefix)) {\n\t\t\t\t\turlArgObj.url = replaceStr + urlArgObj.url.substring(prefix.length);\n\t\t\t\t}\n\t\t\t\tstarP && (urlArgObj.url = starP + urlArgObj.url);\n\t\t\t}\n\t\t}\n\t\toption.urlArgs = {};\n\t\toption.urlArgs[\"*\"] = star;\n\t\tfor(let i = 0; i < urlArgsArr.length; i++) {\n\t\t\tlet urlArgObj = urlArgsArr[i];\n\t\t\toption.urlArgs[urlArgObj.url] = urlArgObj.args;\n\t\t}\n\t}\n\n\t//预处理urlArgs中的*[与*]\n\tlet _urlArgs_prefix = [];\n\tlet _urlArgs_suffix = [];\n\toption._urlArgs_prefix = _urlArgs_prefix;\n\toption._urlArgs_suffix = _urlArgs_suffix;\n\n\tfor(let k in option.urlArgs) {\n\t\tlet url = k;\n\t\tif(xsloader.startsWith(url, \"*[\")) {\n\t\t\tlet strfix = url.substring(2);\n\t\t\tif(xsloader.startsWith(strfix, \".\") || xsloader.startsWith(strfix, \"/\") && !xsloader.startsWith(strfix, \"//\")) {\n\t\t\t\tstrfix = utils.getPathWithRelative(theLoaderUrl, strfix);\n\t\t\t} else {\n\t\t\t\tlet absolute = utils.dealPathMayAbsolute(strfix);\n\t\t\t\tif(absolute.absolute) {\n\t\t\t\t\tstrfix = absolute.path;\n\t\t\t\t} else {\n\t\t\t\t\turl = option.baseUrl + url;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_urlArgs_prefix.push({\n\t\t\t\tstrfix: strfix,\n\t\t\t\tvalue: option.urlArgs[k]\n\t\t\t});\n\t\t\tdelete option.urlArgs[k];\n\t\t} else if(xsloader.startsWith(url, \"*]\")) {\n\t\t\t_urlArgs_suffix.push({\n\t\t\t\tstrfix: url.substring(2),\n\t\t\t\tvalue: option.urlArgs[k]\n\t\t\t});\n\t\t\tdelete option.urlArgs[k];\n\t\t}\n\t}\n\n\toption.forPrefixSuffix = function(urlOrName) {\n\t\t//前缀判断\n\t\tfor(let i = 0; i < _urlArgs_prefix.length; i++) {\n\t\t\tlet strfixObj = _urlArgs_prefix[i];\n\t\t\tif(xsloader.startsWith(urlOrName, strfixObj.strfix)) {\n\t\t\t\tlet value;\n\t\t\t\tif(xsloader.isFunction(strfixObj.value)) {\n\t\t\t\t\tvalue = strfixObj.value.call(this, urlOrName);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = strfixObj.value;\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\n\t\t//后缀判断\n\t\tfor(let i = 0; i < _urlArgs_suffix.length; i++) {\n\t\t\tlet strfixObj = _urlArgs_suffix[i];\n\t\t\tif(xsloader.endsWith(urlOrName, strfixObj.strfix)) {\n\t\t\t\tlet value;\n\t\t\t\tif(xsloader.isFunction(strfixObj.value)) {\n\t\t\t\t\tvalue = strfixObj.value.call(this, urlOrName);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = strfixObj.value;\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t};\n\n\tfor(let name in option.paths) {\n\t\tutils.replaceModulePrefix(option, option.paths[name]); //前缀替换\n\t}\n\tfor(let name in option.depsPaths) {\n\t\tutils.replaceModulePrefix(option, option.depsPaths[name]); //前缀替换\n\t}\n\n\t//处理依赖\n\tlet dealtDeps = option.dealtDeps;\n\n\tlet pushDeps = (dealtDepArray, depsArray) => {\n\t\tutils.each(depsArray, (dep) => {\n\t\t\tdealtDepArray.push(dep);\n\t\t});\n\t};\n\n\tfor(let keyName in option.deps) {\n\t\tlet paths = keyName.split('::');\n\t\tlet depsArray = option.deps[keyName];\n\t\tutils.each(paths, (path) => {\n\t\t\tif(path == '*') {\n\t\t\t\tfor(let m in option.depsPaths) {\n\t\t\t\t\tlet dealtDepArray = dealtDeps[m] = dealtDeps[m] || [];\n\t\t\t\t\tpushDeps(dealtDepArray, depsArray);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet dealtDepArray = (dealtDeps[path] = dealtDeps[path] || []);\n\t\t\t\tpushDeps(dealtDepArray, depsArray);\n\t\t\t}\n\t\t});\n\t}\n\n\ttheConfig = option;\n\ttheContext = _newContext();\n\n\tlet arr = globalDefineQueue;\n\tglobalDefineQueue = null;\n\t//定义config之前的模块\n\tutils.each(arr, (elem) => {\n\t\telem.data.isGlobal = true;\n\t\t__define(elem.data, elem.name, elem.deps, elem.callback, elem.src).then(elem.thenOption);\n\t});\n\tif(requiresQueueBeforeConf && requiresQueueBeforeConf.length) {\n\t\twhile(requiresQueueBeforeConf.length) {\n\t\t\trequiresQueueBeforeConf.shift()();\n\t\t}\n\t}\n\treturn theConfig;\n};\n\nxsloader.config = () => theConfig;\nxsloader.script = () => script.theLoaderScript;\nxsloader.scriptSrc = () => script.theLoaderUrl;\n\nxsloader.putUrlArgs = function(argsObj) {\n\targsObject = xsloader.extend(argsObject, argsObj);\n};\n\nxsloader.getUrlArgs = function(argsObj) {\n\tlet obj = xsloader.extend({}, argsObject);\n\treturn obj;\n};\n\nxsloader.clearUrlArgs = function() {\n\targsObject = {};\n};","import utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader = global.xsloader;\n\n//ie9\ntry {\n\tif(Function.prototype.bind && console && (typeof console['log'] == \"object\")) {\n\t\tutils.each([\"log\", \"info\", \"warn\", \"error\", \"assert\", \"dir\", \"clear\", \"profile\", \"profileEnd\"], (method) => {\n\t\t\tvar thiz = Function.prototype.bind;\n\t\t\tconsole[method] = thiz.call(console[method], console);\n\t\t});\n\t}\n} catch(e) {\n\tglobal.console = {\n\t\tlog: function() {},\n\t\terror: function() {},\n\t\twarn: function() {}\n\t};\n}\n\ntry {\n\n\tif(!Array.prototype.indexOf) {\n\t\tArray.prototype.indexOf = function(elem, offset) {\n\t\t\tfor(let i = offset === undefined ? 0 : offset; i < this.length; i++) {\n\t\t\t\tif(this[i] == elem) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\t}\n\n\tif(!Array.pushAll) {\n\t\tArray.pushAll = function(thiz, arr) {\n\t\t\tif(!xsloader.isArray(arr)) {\n\t\t\t\tthrow new Error(\"not array:\" + arr);\n\t\t\t}\n\t\t\tfor(let i = 0; i < arr.length; i++) {\n\t\t\t\tthiz.push(arr[i]);\n\t\t\t}\n\t\t\treturn thiz;\n\t\t};\n\t}\n} catch(e) {\n\tconsole.error(e);\n}\n\nfunction startsWith(str, starts) {\n\tif(!(typeof str == \"string\")) {\n\t\treturn false;\n\t}\n\treturn str.indexOf(starts) == 0;\n}\n\nfunction endsWith(str, ends) {\n\tif(!(typeof str == \"string\")) {\n\t\treturn false;\n\t}\n\tlet index = str.lastIndexOf(ends);\n\tif(index >= 0 && (str.length - ends.length == index)) {\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction _indexInArray(array, ele, offset = 0, compare) {\n\tlet index = -1;\n\tif(array) {\n\t\tfor(let i = offset || 0; i < array.length; i++) {\n\t\t\tif(compare) {\n\t\t\t\tif(compare(array[i], ele, i, array)) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(array[i] == ele) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\treturn index;\n}\n\nfunction indexInArray(array, ele, compare) {\n\treturn _indexInArray(array, ele, 0, compare);\n}\n\nfunction indexInArrayFrom(array, ele, offset, compare) {\n\treturn _indexInArray(array, ele, offset, compare);\n}\n\nexport default {\n\tstartsWith,\n\tendsWith,\n\tindexInArray,\n\tindexInArrayFrom\n};","//https://github.com/douglascrockford/JSON-js\n//  json2.js\n//  2017-06-12\n//  Public Domain.\n//  NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n//  USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n//  NOT CONTROL.\nconst JSON = {};\n\nexport default JSON;\n\nlet rx_one = /^[\\],:{}\\s]*$/;\nlet rx_two = /\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g;\nlet rx_three = /\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g;\nlet rx_four = /(?:^|:|,)(?:\\s*\\[)+/g;\nlet rx_escapable = /[\\\\\"\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\nlet rx_dangerous = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\n\nfunction f(n) {\n\t// Format integers to have at least two digits.\n\treturn(n < 10) ?\n\t\t\"0\" + n :\n\t\tn;\n}\n\nfunction this_value() {\n\treturn this.valueOf();\n}\n\nif(typeof Date.prototype.toJSON !== \"function\") {\n\n\tDate.prototype.toJSON = function() {\n\t\treturn isFinite(this.valueOf()) ?\n\t\t\t(\n\t\t\t\tthis.getUTCFullYear() +\n\t\t\t\t\"-\" +\n\t\t\t\tf(this.getUTCMonth() + 1) +\n\t\t\t\t\"-\" +\n\t\t\t\tf(this.getUTCDate()) +\n\t\t\t\t\"T\" +\n\t\t\t\tf(this.getUTCHours()) +\n\t\t\t\t\":\" +\n\t\t\t\tf(this.getUTCMinutes()) +\n\t\t\t\t\":\" +\n\t\t\t\tf(this.getUTCSeconds()) +\n\t\t\t\t\"Z\"\n\t\t\t) :\n\t\t\tnull;\n\t};\n\n\tBoolean.prototype.toJSON = this_value;\n\tNumber.prototype.toJSON = this_value;\n\tString.prototype.toJSON = this_value;\n}\n\nlet gap;\nlet indent;\nlet meta;\nlet rep;\n\nfunction quote(string) {\n\n\t// If the string contains no control characters, no quote characters, and no\n\t// backslash characters, then we can safely slap some quotes around it.\n\t// Otherwise we must also replace the offending characters with safe escape\n\t// sequences.\n\n\trx_escapable.lastIndex = 0;\n\treturn rx_escapable.test(string) ?\n\t\t\"\\\"\" + string.replace(rx_escapable, function(a) {\n\t\t\tlet c = meta[a];\n\t\t\treturn typeof c === \"string\" ?\n\t\t\t\tc :\n\t\t\t\t\"\\\\u\" + (\"0000\" + a.charCodeAt(0).toString(16)).slice(-4);\n\t\t}) + \"\\\"\" :\n\t\t\"\\\"\" + string + \"\\\"\";\n}\n\nfunction str(key, holder) {\n\t// Produce a string from holder[key].\n\tlet i; // The loop counter.\n\tlet k; // The member key.\n\tlet v; // The member value.\n\tlet length;\n\tlet mind = gap;\n\tlet partial;\n\tlet value = holder[key];\n\n\t// If the value has a toJSON method, call it to obtain a replacement value.\n\tif(\n\t\tvalue &&\n\t\ttypeof value === \"object\" &&\n\t\ttypeof value.toJSON === \"function\"\n\t) {\n\t\tvalue = value.toJSON(key);\n\t}\n\n\t// If we were called with a replacer function, then call the replacer to\n\t// obtain a replacement value.\n\n\tif(typeof rep === \"function\") {\n\t\tvalue = rep.call(holder, key, value);\n\t}\n\n\t// What happens next depends on the value's type.\n\n\tswitch(typeof value) {\n\t\tcase \"string\":\n\t\t\treturn quote(value);\n\t\tcase \"number\":\n\t\t\t// JSON numbers must be finite. Encode non-finite numbers as null.\n\t\t\treturn(isFinite(value)) ?\n\t\t\t\tString(value) :\n\t\t\t\t\"null\";\n\n\t\tcase \"boolean\":\n\t\tcase \"null\":\n\t\t\t// If the value is a boolean or null, convert it to a string. Note:\n\t\t\t// typeof null does not produce \"null\". The case is included here in\n\t\t\t// the remote chance that this gets fixed someday.\n\t\t\treturn String(value);\n\n\t\t\t// If the type is \"object\", we might be dealing with an object or an array or\n\t\t\t// null.\n\t\tcase \"object\":\n\t\t\t// Due to a specification blunder in ECMAScript, typeof null is \"object\",\n\t\t\t// so watch out for that case.\n\t\t\tif(!value) {\n\t\t\t\treturn \"null\";\n\t\t\t}\n\n\t\t\t// Make an array to hold the partial results of stringifying this object value.\n\n\t\t\tgap += indent;\n\t\t\tpartial = [];\n\t\t\t// Is the value an array?\n\t\t\tif(Object.prototype.toString.apply(value) === \"[object Array]\") {\n\n\t\t\t\t// The value is an array. Stringify every element. Use null as a placeholder\n\t\t\t\t// for non-JSON values.\n\t\t\t\tlength = value.length;\n\t\t\t\tfor(i = 0; i < length; i += 1) {\n\t\t\t\t\tpartial[i] = str(i, value) || \"null\";\n\t\t\t\t}\n\t\t\t\t// Join all of the elements together, separated with commas, and wrap them in\n\t\t\t\t// brackets.\n\n\t\t\t\tv = partial.length === 0 ?\n\t\t\t\t\t\"[]\" :\n\t\t\t\t\tgap ?\n\t\t\t\t\t(\n\t\t\t\t\t\t\"[\\n\" +\n\t\t\t\t\t\tgap +\n\t\t\t\t\t\tpartial.join(\",\\n\" + gap) +\n\t\t\t\t\t\t\"\\n\" +\n\t\t\t\t\t\tmind +\n\t\t\t\t\t\t\"]\"\n\t\t\t\t\t) :\n\t\t\t\t\t\"[\" + partial.join(\",\") + \"]\";\n\t\t\t\tgap = mind;\n\t\t\t\treturn v;\n\t\t\t}\n\n\t\t\t// If the replacer is an array, use it to select the members to be stringified.\n\t\t\tif(rep && typeof rep === \"object\") {\n\t\t\t\tlength = rep.length;\n\t\t\t\tfor(i = 0; i < length; i += 1) {\n\t\t\t\t\tif(typeof rep[i] === \"string\") {\n\t\t\t\t\t\tk = rep[i];\n\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\tif(v) {\n\t\t\t\t\t\t\tpartial.push(quote(k) + (\n\t\t\t\t\t\t\t\t(gap) ?\n\t\t\t\t\t\t\t\t\": \" : \":\"\n\t\t\t\t\t\t\t) + v);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Otherwise, iterate through all of the keys in the object.\n\t\t\t\tfor(k in value) {\n\t\t\t\t\tif(Object.prototype.hasOwnProperty.call(value, k)) {\n\t\t\t\t\t\tv = str(k, value);\n\t\t\t\t\t\tif(v) {\n\t\t\t\t\t\t\tpartial.push(quote(k) + (\n\t\t\t\t\t\t\t\t(gap) ?\n\t\t\t\t\t\t\t\t\": \" :\n\t\t\t\t\t\t\t\t\":\"\n\t\t\t\t\t\t\t) + v);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Join all of the member texts together, separated with commas,\n\t\t\t// and wrap them in braces.\n\n\t\t\tv = partial.length === 0 ?\n\t\t\t\t\"{}\" : gap ?\n\t\t\t\t\"{\\n\" + gap + partial.join(\",\\n\" + gap) + \"\\n\" + mind + \"}\" :\n\t\t\t\t\"{\" + partial.join(\",\") + \"}\";\n\t\t\tgap = mind;\n\t\t\treturn v;\n\t}\n}\n\n// If the JSON object does not yet have a stringify method, give it one.\nif(typeof JSON.stringify !== \"function\") {\n\tmeta = { // table of character substitutions\n\t\t\"\\b\": \"\\\\b\",\n\t\t\"\\t\": \"\\\\t\",\n\t\t\"\\n\": \"\\\\n\",\n\t\t\"\\f\": \"\\\\f\",\n\t\t\"\\r\": \"\\\\r\",\n\t\t\"\\\"\": \"\\\\\\\"\",\n\t\t\"\\\\\": \"\\\\\\\\\"\n\t};\n\tJSON.stringify = function(value, replacer, space) {\n\n\t\t// The stringify method takes a value and an optional replacer, and an optional\n\t\t// space parameter, and returns a JSON text. The replacer can be a function\n\t\t// that can replace values, or an array of strings that will select the keys.\n\t\t// A default replacer method can be provided. Use of the space parameter can\n\t\t// produce text that is more easily readable.\n\n\t\tlet i;\n\t\tgap = \"\";\n\t\tindent = \"\";\n\t\t// If the space parameter is a number, make an indent string containing that\n\t\t// many spaces.\n\t\tif(typeof space === \"number\") {\n\t\t\tfor(i = 0; i < space; i += 1) {\n\t\t\t\tindent += \" \";\n\t\t\t}\n\n\t\t\t// If the space parameter is a string, it will be used as the indent string.\n\n\t\t} else if(typeof space === \"string\") {\n\t\t\tindent = space;\n\t\t}\n\n\t\t// If there is a replacer, it must be a function or an array.\n\t\t// Otherwise, throw an error.\n\n\t\trep = replacer;\n\t\tif(replacer && typeof replacer !== \"function\" && (\n\t\t\t\ttypeof replacer !== \"object\" ||\n\t\t\t\ttypeof replacer.length !== \"number\"\n\t\t\t)) {\n\t\t\tthrow new Error(\"JSON.stringify\");\n\t\t}\n\n\t\t// Make a fake root object containing our value under the key of \"\".\n\t\t// Return the result of stringifying the value.\n\n\t\treturn str(\"\", {\n\t\t\t\"\": value\n\t\t});\n\t};\n}\n\n// If the JSON object does not yet have a parse method, give it one.\n\nif(typeof JSON.parse !== \"function\") {\n\tJSON.parse = function(text, reviver) {\n\t\t// The parse method takes a text and an optional reviver function, and returns\n\t\t// a JavaScript value if the text is a valid JSON text.\n\t\tlet j;\n\n\t\tfunction walk(holder, key) {\n\t\t\t// The walk method is used to recursively walk the resulting structure so\n\t\t\t// that modifications can be made.\n\t\t\tlet k;\n\t\t\tlet v;\n\t\t\tlet value = holder[key];\n\t\t\tif(value && typeof value === \"object\") {\n\t\t\t\tfor(k in value) {\n\t\t\t\t\tif(Object.prototype.hasOwnProperty.call(value, k)) {\n\t\t\t\t\t\tv = walk(value, k);\n\t\t\t\t\t\tif(v !== undefined) {\n\t\t\t\t\t\t\tvalue[k] = v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete value[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn reviver.call(holder, key, value);\n\t\t}\n\n\t\t// Parsing happens in four stages. In the first stage, we replace certain\n\t\t// Unicode characters with escape sequences. JavaScript handles many characters\n\t\t// incorrectly, either silently deleting them, or treating them as line endings.\n\t\ttext = String(text);\n\t\trx_dangerous.lastIndex = 0;\n\t\tif(rx_dangerous.test(text)) {\n\t\t\ttext = text.replace(rx_dangerous, function(a) {\n\t\t\t\treturn(\n\t\t\t\t\t\"\\\\u\" +\n\t\t\t\t\t(\"0000\" + a.charCodeAt(0).toString(16)).slice(-4)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\t// In the second stage, we run the text against regular expressions that look\n\t\t// for non-JSON patterns. We are especially concerned with \"()\" and \"new\"\n\t\t// because they can cause invocation, and \"=\" because it can cause mutation.\n\t\t// But just to be safe, we want to reject all unexpected forms.\n\n\t\t// We split the second stage into 4 regexp operations in order to work around\n\t\t// crippling inefficiencies in IE's and Safari's regexp engines. First we\n\t\t// replace the JSON backslash pairs with \"@\" (a non-JSON character). Second, we\n\t\t// replace all simple value tokens with \"]\" characters. Third, we delete all\n\t\t// open brackets that follow a colon or comma or that begin the text. Finally,\n\t\t// we look to see that the remaining characters are only whitespace or \"]\" or\n\t\t// \",\" or \":\" or \"{\" or \"}\". If that is so, then the text is safe for eval.\n\n\t\tif(\n\t\t\trx_one.test(\n\t\t\t\ttext\n\t\t\t\t.replace(rx_two, \"@\")\n\t\t\t\t.replace(rx_three, \"]\")\n\t\t\t\t.replace(rx_four, \"\")\n\t\t\t)\n\t\t) {\n\n\t\t\t// In the third stage we use the eval function to compile the text into a\n\t\t\t// JavaScript structure. The \"{\" operator is subject to a syntactic ambiguity\n\t\t\t// in JavaScript: it can begin a block or an object literal. We wrap the text\n\t\t\t// in parens to eliminate the ambiguity.\n\t\t\tj = eval(\"(\" + text + \")\");\n\t\t\t// In the optional fourth stage, we recursively walk the new structure, passing\n\t\t\t// each name/value pair to a reviver function for possible transformation.\n\n\t\t\treturn(typeof reviver === \"function\") ?\n\t\t\t\twalk({\n\t\t\t\t\t\"\": j\n\t\t\t\t}, \"\") : j;\n\t\t}\n\t\t// If the text is not JSON parseable, then a SyntaxError is thrown.\n\t\tthrow new SyntaxError(\"JSON.parse\");\n\t};\n}","import {\n\tJSON as xsJSON\n} from \"../polyfill/index.js\";\nimport utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader=global.xsloader;\n\nif(!String.prototype.trim) {\n\tString.prototype.trim = function() {\n\t\treturn this.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\t};\n}\n\nlet idCount = 2019;\n//生成一个随机的id，只保证在本页面是唯一的\nfunction randId(suffix) {\n\tlet id = \"r\" + parseInt(new Date().getTime() / 1000) + \"_\" + parseInt(Math.random() * 1000) + \"_\" + (idCount++);\n\tif(suffix !== undefined) {\n\t\tid += suffix;\n\t}\n\treturn id;\n}\n\nfunction xsEval(scriptString) {\n\ttry {\n\t\tlet rs = xsloader.IE_VERSION > 0 && xsloader.IE_VERSION < 9 ? eval(\"[\" + scriptString + \"][0]\") : eval(\"(\" + scriptString + \")\");\n\t\treturn rs;\n\t} catch(e) {\n\t\tthrow e;\n\t}\n}\n\n/**\n * 注意key需要用引号包裹\n * @param {Object} str\n * @param {Object} option\n */\nfunction xsParseJson(str, option) {\n\tif(str === \"\" || str === null || str === undefined || !xsloader.isString(str)) {\n\t\treturn str;\n\t}\n\n\toption = xsloader.extend({\n\t\tfnStart: \"\", //\"/*{f}*/\",\n\t\tfnEnd: \"\", //\"/*{f}*/\",\n\t\trcomment: \"\\\\/\\\\/#\\\\/\\\\/\"\n\t}, option);\n\n\tlet fnMap = {};\n\tlet fnOffset = 0;\n\tlet replacer = undefined;\n\tif(option.fnStart && option.fnEnd) {\n\t\twhile(true) {\n\t\t\tlet indexStart = str.indexOf(option.fnStart, fnOffset);\n\t\t\tlet indexEnd = str.indexOf(option.fnEnd, indexStart == -1 ? fnOffset : indexStart + option.fnStart.length);\n\t\t\tif(indexStart == -1 && indexEnd == -1) {\n\t\t\t\tbreak;\n\t\t\t} else if(indexStart == -1) {\n\t\t\t\tconsole.warn(\"found end:\" + option.fnEnd + \",may lack start:\" + option.fnStart);\n\t\t\t\tbreak;\n\t\t\t} else if(indexEnd == -1) {\n\t\t\t\tconsole.warn(\"found start:\" + option.fnStart + \",may lack end:\" + option.fnEnd);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlet fnId = \"_[_\" + randId() + \"_]_\";\n\t\t\tlet fnStr = str.substring(indexStart + option.fnStart.length, indexEnd).trim();\n\t\t\tif(!xsloader.startsWith(fnStr, \"function(\")) {\n\t\t\t\tthrow \"not a function:\" + fnStr;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tstr = str.substring(0, indexStart) + '\"' + fnId + '\"' + str.substring(indexEnd + option.fnEnd.length);\n\t\t\t\tlet fn = xsloader.xsEval(fnStr);\n\t\t\t\tfnMap[fnId] = fn;\n\t\t\t} catch(e) {\n\t\t\t\tconsole.error(fnStr);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\tfnOffset = indexStart + fnId.length;\n\t\t}\n\t\treplacer = function(key, val) {\n\t\t\tif(xsloader.isString(val) && fnMap[val]) {\n\t\t\t\treturn fnMap[val];\n\t\t\t} else {\n\t\t\t\treturn val;\n\t\t\t}\n\t\t};\n\t}\n\n\tif(option.rcomment) {\n\t\tstr = str.replace(/(\\r\\n)|\\r/g, \"\\n\"); //统一换行符号\n\t\tstr = str.replace(new RegExp(option.rcomment + \"[^\\\\n]*(\\\\n|$)\", \"g\"), \"\"); //去除行注释\n\t}\n\n\ttry {\n\t\tlet jsonObj = xsJSON;\n\t\treturn jsonObj.parse(str, replacer);\n\t} catch(e) {\n\t\ttry {\n\t\t\tlet reg = new RegExp('position[\\\\s]*([0-9]+)[\\\\s]*$');\n\t\t\tif(e.message && reg.test(e.message)) {\n\t\t\t\tlet posStr = e.message.substring(e.message.lastIndexOf(\"position\") + 8);\n\t\t\t\tlet pos = parseInt(posStr.trim());\n\t\t\t\tlet _str = str.substring(pos);\n\t\t\t\tconsole.error(e.message + \":\" + _str.substring(0, _str.length > 100 ? 100 : _str.length));\n\t\t\t}\n\t\t} catch(e2) {\n\t\t\tconsole.warn(e2);\n\t\t}\n\t\tthrow e;\n\t}\n}\n\nfunction xsJson2String(obj) {\n\tlet jsonObj = xsJSON;\n\treturn jsonObj.stringify(obj);\n}\n\nconst getPathWithRelative=utils.getPathWithRelative;\n\nfunction _toParamsMap(argsStr, decode = true) {\n\tif(xsloader.isObject(argsStr)) {\n\t\treturn argsStr;\n\t}\n\tif(!argsStr) {\n\t\targsStr = location.search;\n\t}\n\n\tlet index = argsStr.indexOf(\"?\");\n\tif(index >= 0) {\n\t\targsStr = argsStr.substring(index + 1);\n\t} else {\n\t\tif(utils.dealPathMayAbsolute(argsStr).absolute) {\n\t\t\treturn {};\n\t\t}\n\t}\n\tindex = argsStr.lastIndexOf(\"#\");\n\tif(index >= 0) {\n\t\targsStr = argsStr.substring(0, index);\n\t}\n\n\tlet ret = {},\n\t\tseg = argsStr.split('&'),\n\t\ts;\n\tfor(let i = 0; i < seg.length; i++) {\n\t\tif(!seg[i]) {\n\t\t\tcontinue;\n\t\t}\n\t\ts = seg[i].split('=');\n\t\tlet name = decode ? decodeURIComponent(s[0]) : s[0];\n\t\tret[name] = decode ? decodeURIComponent(s[1]) : s[1];\n\t}\n\treturn ret;\n}\n\nfunction appendArgs2Url(url, urlArgs) {\n\tif(url === undefined || url === null || !urlArgs) {\n\t\treturn url;\n\t}\n\n\tlet index = url.lastIndexOf(\"?\");\n\tlet hashIndex = url.lastIndexOf(\"#\");\n\tif(hashIndex < 0) {\n\t\thashIndex = url.length;\n\t}\n\tlet oldParams = index < 0 ? {} : _toParamsMap(url.substring(index + 1, hashIndex), false);\n\tlet newParams = _toParamsMap(urlArgs, false);\n\tlet has = false;\n\tfor(let k in newParams) {\n\t\tif(oldParams[k] != newParams[k]) {\n\t\t\toldParams[k] = newParams[k];\n\t\t\thas = true;\n\t\t}\n\t}\n\tif(!has) {\n\t\treturn url; //参数没有变化直接返回\n\t}\n\n\tlet paramKeys = [];\n\tfor(let k in oldParams) {\n\t\tparamKeys.push(k);\n\t}\n\tparamKeys.sort();\n\n\tlet path = index < 0 ? url.substring(0, hashIndex) : url.substring(0, index);\n\tlet params = [];\n\n\tfor(let i = 0; i < paramKeys.length; i++) { //保证参数按照顺序\n\t\tlet k = paramKeys[i];\n\t\tparams.push(k + \"=\" + oldParams[k]);\n\t}\n\tparams = params.join(\"&\");\n\tlet hash = \"\";\n\tif(hashIndex >= 0 && hashIndex < url.length) {\n\t\thash = url.substring(hashIndex);\n\t}\n\treturn path + (params ? \"?\" + params : \"\") + (hash ? hash : \"\");\n\n}\n\nfunction queryString2ParamsMap(argsStr, decode) {\n\treturn _toParamsMap(argsStr, decode);\n}\n\nexport default {\n\trandId,\n\txsEval,\n\txsParseJson,\n\txsJson2String,\n\tgetPathWithRelative,\n\tappendArgs2Url,\n\tqueryString2ParamsMap\n};","const ostring = Object.prototype.toString;\n\nfunction isArray(it) {\n\treturn it && (it instanceof Array) || ostring.call(it) === '[object Array]';\n}\n\nfunction isFunction(it) {\n\treturn it && (typeof it == \"function\") || ostring.call(it) === '[object Function]';\n}\n\nfunction isObject(it) {\n\tif(it === null || it === undefined) {\n\t\treturn false;\n\t}\n\treturn(typeof it == \"object\") || ostring.call(it) === '[object Object]';\n}\n\nfunction isString(it) {\n\treturn it && (typeof it == \"string\") || ostring.call(it) === '[object String]';\n}\n\nfunction isDate(it) {\n\treturn it && (it instanceof Date) || ostring.call(it) === '[object Date]';\n}\n\nfunction isRegExp(it) {\n\treturn it && (it instanceof RegExp) || ostring.call(it) === '[object RegExp]';\n}\n\nexport default {\n\tisArray,\n\tisFunction,\n\tisObject,\n\tisString,\n\tisDate,\n\tisRegExp,\n};","import utils from \"../util/index.js\";\n\nconst global = utils.globa;\nconst xsloader = global.xsloader;\n\nfunction queryParam(name, otherValue, optionUrl) {\n\tlet search;\n\tif(optionUrl) {\n\t\tlet index = optionUrl.indexOf('?');\n\t\tif(index < 0) {\n\t\t\tindex = 0;\n\t\t} else {\n\t\t\tindex += 1;\n\t\t}\n\t\tsearch = optionUrl.substr(index);\n\t} else {\n\t\tsearch = window.location.search.substr(1);\n\t}\n\n\tlet reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\n\tlet r = search.match(reg);\n\tif(r != null) return decodeURIComponent(r[2]);\n\treturn otherValue !== undefined ? otherValue : null;\n}\n\nfunction getUrl(relativeUrl, appendArgs, optionalAbsUrl) {\n\tif(optionalAbsUrl && !utils.dealPathMayAbsolute(optionalAbsUrl).absolute) {\n\t\tthrow new Error(\"expected absolute url:\" + optionalAbsUrl);\n\t}\n\tif(appendArgs === undefined) {\n\t\tappendArgs = true;\n\t}\n\tlet theConfig = xsloader.config();\n\tlet thePageUrl = xsloader.pageUrl();\n\tlet url;\n\tif(relativeUrl === undefined) {\n\t\turl = thePageUrl;\n\t} else if(xsloader.startsWith(relativeUrl, \".\") || utils.dealPathMayAbsolute(relativeUrl).absolute) {\n\t\turl = utils.getPathWithRelative(optionalAbsUrl || thePageUrl, relativeUrl);\n\t} else {\n\t\turl = theConfig.baseUrl + relativeUrl;\n\t}\n\tif(appendArgs) {\n\t\tif(url == thePageUrl) {\n\t\t\turl += location.search + location.hash;\n\t\t}\n\t\treturn theConfig.dealUrl({}, url);\n\t} else {\n\t\treturn url;\n\t}\n}\n\nfunction tryCall(fun, defaultReturn, thiz, exCallback) {\n\tlet rs;\n\ttry {\n\t\tthiz = thiz === undefined ? this : thiz;\n\t\trs = fun.call(thiz);\n\t} catch(e) {\n\t\tif(xsloader.isFunction(exCallback)) {\n\t\t\texCallback(e);\n\t\t} else {\n\t\t\tconsole.warn(e);\n\t\t}\n\t}\n\tif(rs === undefined || rs === null) {\n\t\trs = defaultReturn;\n\t}\n\treturn rs;\n}\n\nfunction dealProperties(obj, properties) {\n\treturn utils.propertiesDeal(obj, properties);\n}\n\nfunction extend(target) {\n\tfor(let i = 1; i < arguments.length; i++) {\n\t\tlet obj = arguments[i];\n\t\tif(!obj) {\n\t\t\tcontinue;\n\t\t}\n\t\tfor(let x in obj) {\n\t\t\tlet value = obj[x];\n\t\t\tif(value === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttarget[x] = obj[x];\n\t\t}\n\t}\n\treturn target;\n}\n\nfunction extendDeep(target) {\n\tif(!target) {\n\t\treturn target;\n\t}\n\tfor(let i = 1; i < arguments.length; i++) {\n\t\tlet obj = arguments[i];\n\t\tif(!obj) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor(let x in obj) {\n\t\t\tlet value = obj[x];\n\t\t\tif(value === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(xsloader.isObject(value) && xsloader.isObject(target[x])) {\n\t\t\t\ttarget[x] = xsloader.extendDeep(target[x], value);\n\t\t\t} else {\n\t\t\t\ttarget[x] = obj[x];\n\t\t\t}\n\t\t}\n\t}\n\treturn target;\n}\n\nfunction _AsyncCall(useTimer) {\n\tlet thiz = this;\n\tlet count = 0;\n\tlet ctrlCallbackMap = {};\n\n\tfunction initCtrlCallback(callbackObj) {\n\t\tlet mineCount = count + \"\";\n\t\tif(!ctrlCallbackMap[mineCount]) {\n\t\t\tlet ctrlCallback = function() {\n\t\t\t\tcount++;\n\t\t\t\tlet asyncCallQueue = ctrlCallbackMap[mineCount];\n\t\t\t\tdelete ctrlCallbackMap[mineCount];\n\t\t\t\twhile(asyncCallQueue.length) {\n\t\t\t\t\tlet callbackObj = asyncCallQueue.shift();\n\t\t\t\t\tlet lastReturn = undefined;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif(callbackObj.callback) {\n\t\t\t\t\t\t\tlastReturn = callbackObj.callback.call(callbackObj.handle, callbackObj.obj, mineCount);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t\tlet handle;\n\t\t\t\t\twhile(callbackObj.nextCallback.length) {\n\t\t\t\t\t\tlet nextObj = callbackObj.nextCallback.shift();\n\t\t\t\t\t\tif(!handle) {\n\t\t\t\t\t\t\thandle = thiz.pushTask(nextObj.callback, lastReturn);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thandle.next(nextObj.callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tctrlCallbackMap[mineCount] = [];\n\t\t\tif(!useTimer && global.Promise && global.Promise.resolve) {\n\t\t\t\tglobal.Promise.resolve().then(ctrlCallback);\n\t\t\t} else {\n\t\t\t\tsetTimeout(ctrlCallback, 0);\n\t\t\t}\n\t\t}\n\t\tlet queue = ctrlCallbackMap[mineCount];\n\t\tqueue.push(callbackObj);\n\t}\n\n\tthis.pushTask = function(callback, obj) {\n\t\tlet callbackObj;\n\t\tlet handle = {\n\t\t\tnext: function(nextCallback, lastReturn) {\n\t\t\t\tcallbackObj.nextCallback.push({\n\t\t\t\t\tcallback: nextCallback,\n\t\t\t\t\tlastReturn: lastReturn\n\t\t\t\t});\n\t\t\t\treturn this;\n\t\t\t}\n\t\t};\n\t\tcallbackObj = {\n\t\t\tcallback: callback,\n\t\t\tobj: obj,\n\t\t\tnextCallback: [],\n\t\t\thandle: handle\n\t\t};\n\n\t\tinitCtrlCallback(callbackObj);\n\n\t\treturn handle;\n\t};\n}\n\nconst theAsyncCall = new _AsyncCall();\nconst theAsyncCallOfTimer = new _AsyncCall(true);\n\nlet asyncCall = function(callback, useTimer) {\n\tif(useTimer) {\n\t\treturn theAsyncCallOfTimer.pushTask(callback);\n\t} else {\n\t\treturn theAsyncCall.pushTask(callback);\n\t}\n};\n\n/**\n * 得到属性\n * @param {Object} obj\n * @param {Object} attrNames \"rs\"、\"rs.total\"等\n */\nfunction getObjectAttr(obj, attrNames, defaultValue) {\n\tif(!obj || !attrNames) {\n\t\treturn undefined;\n\t}\n\tlet attrs = attrNames.split(\".\");\n\tlet rs = defaultValue;\n\tlet i = 0;\n\tfor(; i < attrs.length && obj; i++) {\n\t\tlet k = attrs[i];\n\t\tobj = obj[k];\n\t}\n\tif(i == attrs.length) {\n\t\trs = obj;\n\t}\n\n\treturn rs;\n}\n\n/**\n * 设置属性\n * @param {Object} obj\n * @param {Object} attrNames \"rs\"、\"rs.total\"等\n */\nfunction setObjectAttr(obj, attrNames, value) {\n\tlet _obj = obj;\n\tlet attrs = attrNames.split(\".\");\n\n\tfor(let i = 0; i < attrs.length; i++) {\n\t\tlet k = attrs[i];\n\n\t\tif(i == attrs.length - 1) {\n\t\t\tobj[k] = value;\n\t\t\tbreak;\n\t\t}\n\t\tlet o = obj[k];\n\t\tif(!o) {\n\t\t\to = {};\n\t\t\tobj[k] = o;\n\t\t}\n\t\tobj = o;\n\t}\n\treturn _obj;\n}\n\nfunction clone(obj, isDeep) {\n\t// Handle the 3 simple types, and null or undefined or function\n\tif(!obj || xsloader.isFunction(obj) || xsloader.isString(obj)) return obj;\n\n\tif(xsloader.isRegExp(obj)) {\n\t\treturn new RegExp(obj.source, obj.flags);\n\t}\n\n\t// Handle Date\n\tif(xsloader.isDate(obj)) {\n\t\tlet copy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\t// Handle Array or Object\n\tif(xsloader.isArray(obj) || xsloader.isObject(obj)) {\n\t\tlet copy = xsloader.isArray(obj) ? [] : {};\n\t\tfor(let attr in obj) {\n\t\t\tif(obj.hasOwnProperty(attr))\n\t\t\t\tcopy[attr] = isDeep ? clone(obj[attr]) : obj[attr];\n\t\t}\n\t\treturn copy;\n\t}\n\treturn obj;\n}\n\nexport default {\n\tqueryParam,\n\tgetUrl,\n\ttryCall,\n\tdealProperties,\n\textend,\n\textendDeep,\n\tasyncCall,\n\tgetObjectAttr,\n\tsetObjectAttr,\n\tclone\n};","import utils from \"../util/index.js\";\n\nconst global = utils.global;\nconst xsloader=global.xsloader;\n\nlet isDOM = (typeof HTMLElement === 'object') ?\n\tfunction(obj) {\n\t\treturn obj && (obj instanceof HTMLElement);\n\t} :\n\tfunction(obj) {\n\t\treturn obj && typeof obj === 'object' && obj.nodeType === 1 && typeof obj.nodeName === 'string';\n\t};\n\nlet onReadyFun = (function() {\n\tlet isGlobalReady = false;\n\tlet bindReadyQueue = [];\n\n\tfunction BindReady(callback) {\n\t\tif(isGlobalReady) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\t\tlet isReady = false;\n\n\t\tfunction ready() {\n\t\t\tif(isReady) return;\n\t\t\tisReady = true;\n\t\t\tisGlobalReady = true;\n\t\t\tcallback();\n\t\t}\n\t\t// Mozilla, Opera and webkit nightlies currently support this event\n\t\tif(document.addEventListener) {\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", function() {\n\t\t\t\tdocument.removeEventListener(\"DOMContentLoaded\", arguments.callee);\n\t\t\t\tready();\n\t\t\t});\n\n\t\t} else if(document.attachEvent) {\n\t\t\t// ensure firing before onload,\n\t\t\t// maybe late but safe also for iframes\n\t\t\tdocument.attachEvent(\"onreadystatechange\", function() {\n\t\t\t\tif(document.readyState === \"complete\") {\n\t\t\t\t\tdocument.detachEvent(\"onreadystatechange\", arguments.callee);\n\t\t\t\t\tready();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// If IE and not an iframe\n\t\t\t// continually check to see if the document is ready\n\t\t\tif(document.documentElement.doScroll && typeof global.frameElement === \"undefined\")(function() {\n\t\t\t\tif(isReady) return;\n\t\t\t\ttry {\n\t\t\t\t\t// If IE is used, use the trick by Diego Perini\n\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\tdocument.documentElement.doScroll(\"left\");\n\t\t\t\t} catch(error) {\n\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// and execute any waiting functions\n\t\t\t\tready();\n\t\t\t})();\n\t\t} else {\n\t\t\txsloader.asyncCall(null, true).next(function() {\n\t\t\t\tready();\n\t\t\t});\n\t\t}\n\t\tthis.readyCall = ready;\n\t}\n\tlet onReady = function(callback) {\n\t\tif(document.readyState === \"complete\") {\n\t\t\tisGlobalReady = true;\n\t\t}\n\t\tlet br = new BindReady(callback);\n\t\tif(!isGlobalReady) {\n\t\t\tbindReadyQueue.push(br);\n\t\t}\n\t};\n\tonReady(function() {\n\t\tisGlobalReady = true;\n\t});\n\n\tif(document.readyState === \"complete\") {\n\t\tisGlobalReady = true;\n\t} else {\n\t\tlet addEventHandle;\n\t\tif(global.addEventListener) {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\tglobal.addEventListener(type, callback, false);\n\t\t\t};\n\t\t} else if(global.attachEvent) {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\tglobal.attachEvent(\"on\" + type, callback);\n\t\t\t};\n\t\t} else {\n\t\t\taddEventHandle = function(type, callback) {\n\t\t\t\txsloader.asyncCall(null, true).next(function() {\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t\taddEventHandle(\"load\", function() {\n\t\t\tisGlobalReady = true;\n\t\t\twhile(bindReadyQueue.length) {\n\t\t\t\tbindReadyQueue.shift().readyCall();\n\t\t\t}\n\t\t});\n\t}\n\treturn onReady;\n})();\n\nexport default {\n\tisDOM,\n\tonReady: onReadyFun\n};","import utils from \"../util/index.js\";\n////////////////////\n\nimport deprecated from './global-deprecated.js';\nimport base from './global-base.js';\n//////////////////\nimport is from './is.js';\nimport funs from './funs.js';\nimport browser from './browser.js';\n\nconst global = utils.global;\nconst xsloader=global.xsloader;\n\nlet toGlobal = {\n\t...deprecated,\n\t...base\n};\nfor(let k in toGlobal) {\n\txsloader[k] = toGlobal[k];\n\tglobal[k] = toGlobal[k];\n}\n\nlet justLoader = {\n\t...is,\n\t...funs,\n\t...browser,\n\t_ignoreAspect_: {\n\n\t}\n};\nfor(let k in justLoader) {\n\txsloader[k] = justLoader[k];\n}"],"names":["g","window","undefined","self","global","Error","ABSOLUTE_PROTOCOL_REG","ABSOLUTE_PROTOCOL_REG2","defaultJsExts","xsloader","isJsFile","path","isString","pluginIndex","indexOf","substring","index","theConfig","config","jsExts","i","length","endsWith","ext","dealPathMayAbsolute","currentUrl","location","href","rs","exec","finalPath","absolute","protocol","_protocol","_host","host","getPathWithRelative","relative","isPathDir","relativeQuery","qIndex","lastIndexOf","isRelativeDir","prefix","absolute2","index2","stack","split","pop","relatives","str","push","result","join","appendArgs2Url","getNodeAbsolutePath","node","src","removeQueryHash","url","REPLACE_STRING_PROPERTIES_EXP","RegExp","ALL_TYPE_PROPERTIES_EXP","propertiesDeal","configObject","properties","replaceStringProperties","string","property","propKey","propValue","getObjectAttr","propertyKey","has","replaceProperties","obj","enableKeyAttr","isFunction","isArray","isObject","replaceKeyMap","x","_x","objx","__dealt__","fun","call","replaceModulePrefix","deps","m","pluginParam","query","startsWith","modulePrefixCount","modulePrefix","replaceStr","replace","len","pluginName","dep","getScriptBySubname","subname","ss","document","getElementsByTagName","script","GraphPath","pathEdges","vertexMap","depMap","addEdge","begin","end","hasDep","name","tryAddEdge","paths","hasLoop","visited","recursionStack","checkLoop","v","edges","edge","strValue2Arr","each","ary","func","isSync","fromEnd","handle","graphPath","urls","base","utils","defContextName","DATA_ATTR_CONTEXT","isOpera","opera","toString","readyRegExp","navigator","platform","theLoaderScript","currentScript","theLoaderUrl","thePageUrl","currentDefineModuleQueue","peek","lastAppendHeadDom","useDefineQueue","theRealDefine","safariVersion","getCurrentScript","isRemoveQueryHash","_getCurrentScriptOrSrc","IE_VERSION","nodes","readyState","a","b","c","e","sourceURL","stacktrace","String","match","slice","s","appendHeadDom","dom","isDOM","nextDom","nextSibling","head","insertBefore","doDefine","thiz","args","isRequire","defineObject","parentDefine","onError","err","before","depBefore","depDeps","orderDep","absoluteUrl","instance","getAttribute","console","error","xsJson2String","then","option","extend","asyncCall","define","predefine","arguments","prerequire","initDefine","theDefine","theDefinedMap","getModule","nameOrUrl","removeUrlParam","get","setModule","last","buildInvoker","invoker","module","id","randId","getId","getUrl","relativeUrl","appendArgs","optionalAbsUrl","getAbsoluteUrl","rurl","baseUrl","search","hash","dealUrl","require","h","apply","_Async_Object_","thenOption","absUrl","defineAsync","throwError","withAbsUrl","newObj","getName","_newModule","thatInvoker","callback","selfname","newModule","instances","moduleMap","idCount","relys","otherModule","directDefineIndex","ignoreAspect","depModules","_loadCallback","moduleObject","loopObject","instanceType","setInstanceType","_singlePluginResult","lastSinglePluginResult","pluginArgs","setSinglePluginResult","willCache","finish","_directArgs","setState","log","isDefault","__default","state","errinfo","_callback","_state","theCallback","depModule","_newDepModule","relyCallback","init","getDeps","defined_module_for_deps","shift","toOtherModule","theRelys","relyIt","whenNeed","loadCallback","callbackFun","dealInstance","moduleInstance","_module_","opId","setToAll","value","_getModuleId","k","ins","mobj","_modules_","_m_","mayAddDeps","moduleDeps","indexInArray","printOnNotDefined","root","_printOnNotDefined","leafs","findLeaf","item","genErrs","infos","parent","leaf","reverse","as","info","errModule","depMod","parentNode","indexPlguin","mod","randModuleIndex","_dealEmbedDeps","modName","isOrderDep","innerDepsMap","INNER_DEPS_PLUGIN","_getPluginParam","everyRequired","everyOkCallback","errCallback","isError","jsFilePath","moduleLoop","hasCallErr","theExports","depCount","Array","invoker_the_module","checkFinish","dep_name","syncHandle","originDep","relyItFun","genExports","willDelay","_deps","i1","i2","i3","version","groupModule","defaultVersion","_url","_resUrlBuilder","isInUrls","getUrls","module2","_depModules","mayAsyncCallLoadModule","loadModule","defineHandle","defines","eache","getThatInvokerForDef_Req","appendInnerDeps","originCallback","getConfig","rt","defineFunction","cache","onModuleLoaded","lastDefineObject","ifmodule","moduleScript","lastModule","warn","aurl","moduleName","_ignoreAspect_","moduleSelf","cacheId","needCallback","depModuleArgs","theContext","globalDefineQueue","requiresQueueBeforeConf","argsObject","_newContext","context","contextName","defQueue","pathname","urlArgs","ignoreProperties","depsPaths","waitSeconds","autoUrlArgs","dealtDeps","dealProperties","hasOrderDep","splice","urlArg","Date","getTime","forPrefixSuffix","encodeURIComponent","dealUrlArgs","isAutoUrlArgs","star","urlArgsArr","urlArgObj","starP","_urlArgs_prefix","_urlArgs_suffix","strfix","urlOrName","strfixObj","pushDeps","dealtDepArray","depsArray","keyName","arr","elem","data","isGlobal","__define","scriptSrc","putUrlArgs","argsObj","getUrlArgs","clearUrlArgs","Function","prototype","bind","method","offset","pushAll","starts","ends","_indexInArray","array","ele","compare","indexInArrayFrom","JSON","rx_one","rx_two","rx_three","rx_four","rx_escapable","rx_dangerous","f","n","this_value","valueOf","toJSON","isFinite","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","Boolean","Number","gap","indent","meta","rep","quote","lastIndex","test","charCodeAt","key","holder","mind","partial","Object","hasOwnProperty","stringify","replacer","space","parse","text","reviver","j","walk","eval","SyntaxError","trim","suffix","parseInt","Math","random","xsEval","scriptString","xsParseJson","fnStart","fnEnd","rcomment","fnMap","fnOffset","indexStart","indexEnd","fnId","fnStr","fn","val","jsonObj","xsJSON","reg","message","posStr","pos","_str","e2","_toParamsMap","argsStr","decode","ret","seg","decodeURIComponent","hashIndex","oldParams","newParams","paramKeys","sort","params","queryString2ParamsMap","ostring","it","isDate","isRegExp","globa","queryParam","otherValue","optionUrl","substr","r","pageUrl","tryCall","defaultReturn","exCallback","target","extendDeep","_AsyncCall","useTimer","count","ctrlCallbackMap","initCtrlCallback","callbackObj","mineCount","ctrlCallback","asyncCallQueue","lastReturn","nextCallback","nextObj","pushTask","next","Promise","resolve","setTimeout","queue","theAsyncCall","theAsyncCallOfTimer","attrNames","defaultValue","attrs","setObjectAttr","_obj","o","clone","isDeep","source","flags","copy","setTime","attr","HTMLElement","nodeType","nodeName","onReadyFun","isGlobalReady","bindReadyQueue","BindReady","isReady","ready","addEventListener","removeEventListener","callee","attachEvent","detachEvent","documentElement","doScroll","frameElement","readyCall","onReady","br","addEventHandle","type","toGlobal","deprecated","justLoader","is","funs","browser"],"mappings":"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"}